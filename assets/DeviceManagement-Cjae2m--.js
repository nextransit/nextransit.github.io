import{c as te,W as is,a6 as pe,z as Z,a7 as le,j as e,C as ns,a8 as $e,a9 as be,aa as Oe,ab as Fe,ac as Pe,ad as ds,ae as cs,m as f,R as We,n as K,B as q,u as ms,af as os,ag as xs,L as z,H as hs,A as ue,y as ge,b as ps,E as Ve,Y as Ue,e as re,q as bs,ah as Be,V as us,d as gs,ai as js,aj as fs,ak as Ns,o as vs,al as He,X as je,am as ys}from"./index-D5WepYs6.js";import{u as ks,N as ws,f as Cs,h as F,r as u}from"./vendor-wU5nTCpQ.js";import{u as Ds,a as Ss,o as Ge,s as E,b as As,n as Ms}from"./schemas-BY4MnzfF.js";import{u as D}from"./i18n-DUSRnG8c.js";import{C as fe,W as Ke}from"./wifi-CuqrzzDL.js";import{W as Q}from"./wrench-CGcB6pCZ.js";import{U as xe}from"./upload-DRNCZauS.js";import{B as Me,H as Ne}from"./hard-drive-a27zmOTD.js";import{R as G,P as Ie,b as Le,c as Re,T as me,f as Is,A as se,C as Ls,X as Rs,Y as Ts,a as X}from"./charts-BXxqj8Ps.js";import{D as he}from"./download-BxQ5zF7q.js";import{P as ze}from"./plus-Dramzc0j.js";import{T as _e}from"./trash-2-BItzgCWF.js";import{P as Es}from"./printer-GTXnzlqx.js";import{C as $s}from"./check-V0VUdD94.js";import"./ui--kwEMLq0.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=te("Rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=te("Terminal",[["polyline",{points:"4 17 10 11 4 5",key:"akl6gq"}],["line",{x1:"12",x2:"20",y1:"19",y2:"19",key:"q2wloq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Os=te("Volume2",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}],["path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14",key:"1kegas"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=te("WifiOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 4.17-2.65",key:"11utq1"}],["path",{d:"M10.66 5c4.01-.36 8.14.9 11.34 3.76",key:"hxefdu"}],["path",{d:"M16.85 11.25a10 10 0 0 1 2.22 1.68",key:"q734kn"}],["path",{d:"M5 13a10 10 0 0 1 5.24-2.76",key:"piq4yl"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]),Ee=["#10b981","#3b82f6","#f59e0b","#ef4444","#8b5cf6"],Fs=Ge({type:E().min(1),serialNumber:E().min(1).max(50),vehicleId:E().optional(),terminalId:E().optional()});Ge({version:E().min(1),changelog:E().min(1),downloadUrl:E().url(),fileSize:Ms().min(1),checksum:E().min(1),isMandatory:As()});const Ps=({onClose:s,onSubmit:n,isSubmitting:c,methods:i})=>{const{t:x}=D();return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs(f.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"glass-panel w-full max-w-lg p-6 bg-white dark:bg-dark-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-display font-bold text-slate-900 dark:text-slate-100",children:x("mdm.createDevice")}),e.jsx("button",{onClick:s,className:"p-2 hover:bg-slate-100 dark:hover:bg-dark-700 rounded-lg",children:e.jsx(je,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:i.handleSubmit(n),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-500 dark:text-slate-400 mb-2",children:x("mdm.deviceType")}),e.jsx("input",{...i.register("type"),className:"input-field",placeholder:"P18Q"}),i.formState.errors.type&&e.jsx("p",{className:"mt-1 text-sm text-error",children:i.formState.errors.type.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-500 dark:text-slate-400 mb-2",children:x("mdm.serialNumber")}),e.jsx("input",{...i.register("serialNumber"),className:"input-field",placeholder:"SN001"}),i.formState.errors.serialNumber&&e.jsx("p",{className:"mt-1 text-sm text-error",children:i.formState.errors.serialNumber.message})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:s,className:"flex-1 btn-secondary",children:x("common.cancel")}),e.jsxs("button",{type:"submit",disabled:c,className:"flex-1 btn-primary flex items-center justify-center gap-2 disabled:opacity-50",children:[c&&e.jsx(z,{className:"w-4 h-4 animate-spin"}),x("common.confirm")]})]})]})]})})},Ws=({deviceId:s,onClose:n})=>{const{t:c}=D(),{data:i}=ys(s),[x,t]=u.useState("info");if(!i)return null;const g=[{date:"2024-01-15",type:"ARCHIVE",desc:"Device archived into inventory"},{date:"2024-02-01",type:"BIND",desc:"Bound to Line 202, Station Green Valley"},{date:"2024-06-15",type:"MAINTENANCE",desc:"Routine battery check completed"},{date:"2025-01-10",type:"UPGRADE",desc:"Firmware upgraded to v2.1.0"}];return e.jsxs(e.Fragment,{children:[e.jsx(f.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,className:"fixed inset-0 bg-black/30 z-40"}),e.jsxs(f.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:25,stiffness:200},className:"fixed right-0 top-0 h-full w-full max-w-xl bg-white dark:bg-dark-800 z-50 shadow-2xl flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-slate-200 dark:border-dark-600 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-display font-bold text-slate-900 dark:text-slate-100",children:i.id}),e.jsx("p",{className:"text-sm text-slate-500",children:i.serialNumber})]}),e.jsx("button",{onClick:n,className:"p-2 hover:bg-slate-100 dark:hover:bg-dark-700 rounded-lg",children:e.jsx(je,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex border-b border-slate-200 dark:border-dark-600",children:[e.jsx("button",{onClick:()=>t("info"),className:`px-6 py-3 text-sm font-medium border-b-2 transition-colors ${x==="info"?"border-primary-500 text-primary-600":"border-transparent text-slate-500 hover:text-slate-700"}`,children:c("common.details")}),e.jsx("button",{onClick:()=>t("lifecycle"),className:`px-6 py-3 text-sm font-medium border-b-2 transition-colors ${x==="lifecycle"?"border-primary-500 text-primary-600":"border-transparent text-slate-500 hover:text-slate-700"}`,children:c("mdm.lifecycle")})]}),e.jsx("div",{className:"flex-1 overflow-auto p-6",children:x==="info"?e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:c("mdm.hardwareInfo")}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-500",children:c("mdm.manufacturer")}),e.jsx("span",{className:"font-medium",children:i.manufacturer})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-500",children:c("mdm.model")}),e.jsx("span",{className:"font-medium",children:i.model})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-500",children:c("mdm.purchaseDate")}),e.jsx("span",{className:"font-medium",children:i.purchaseDate})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:c("mdm.status")}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-500",children:c("mdm.battery")}),e.jsxs("span",{className:"font-medium",children:[i.battery,"%"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-500",children:c("mdm.storage")}),e.jsxs("span",{className:"font-medium",children:[i.storage,"%"]})]})]})]})]}):e.jsx("div",{className:"relative pl-8 space-y-8 before:absolute before:left-[11px] before:top-2 before:bottom-2 before:w-0.5 before:bg-slate-200 dark:before:bg-dark-600",children:g.map((d,m)=>e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:`absolute -left-8 w-6 h-6 rounded-full border-4 border-white dark:border-dark-800 flex items-center justify-center ${d.type==="ARCHIVE"?"bg-blue-500":d.type==="BIND"?"bg-green-500":d.type==="MAINTENANCE"?"bg-amber-500":"bg-purple-500"}`,children:d.type==="UPGRADE"?e.jsx(Y,{className:"w-3 h-3 text-white"}):e.jsx($s,{className:"w-3 h-3 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400 mb-1",children:d.date}),e.jsx("p",{className:"font-bold text-sm text-slate-900 dark:text-slate-100",children:c(`mdm.events.${d.type}`)}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:d.desc})]})]},m))})}),e.jsx("div",{className:"p-6 border-t border-slate-200 dark:border-dark-600 flex justify-end",children:e.jsx("button",{onClick:n,className:"btn-secondary",children:c("common.close")})})]})]})},Vs=({deviceId:s,onClose:n})=>{const{t:c}=D(),{data:i,isLoading:x,isError:t,refetch:g}=He({deviceId:s,limit:50},{enabled:!!s,retry:!1}),d=((i==null?void 0:i.data)||[]).filter(m=>m.level==="ERROR"||m.level==="FATAL").sort((m,b)=>new Date(b.timestamp).getTime()-new Date(m.timestamp).getTime()).slice(0,10);return e.jsxs(e.Fragment,{children:[e.jsx(f.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,className:"fixed inset-0 bg-black/30 z-40"}),e.jsxs(f.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:25,stiffness:200},className:"fixed right-0 top-0 h-full w-full max-w-lg bg-white dark:bg-dark-800 z-50 shadow-2xl flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-slate-200 dark:border-dark-600 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-display font-bold text-slate-900 dark:text-slate-100",children:c("devices.offlineLogsTitle",{deviceId:s})}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:c("devices.offlineLogsSubtitle")})]}),e.jsx("button",{onClick:n,className:"p-2 hover:bg-slate-100 dark:hover:bg-dark-700 rounded-lg",children:e.jsx(je,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex-1 overflow-auto p-6",children:[x&&e.jsx("div",{className:"flex items-center justify-center h-40",children:e.jsx(z,{className:"w-6 h-6 animate-spin text-primary-600"})}),t&&e.jsxs("div",{className:"text-center py-10",children:[e.jsx(K,{className:"w-10 h-10 mx-auto mb-3 text-error"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:c("common.loadError")}),e.jsx("button",{onClick:()=>g(),className:"btn-secondary mt-4",children:c("common.retry")})]}),!x&&!t&&d.length===0&&e.jsxs("div",{className:"text-center py-10 text-slate-500",children:[e.jsx(K,{className:"w-10 h-10 mx-auto mb-3 opacity-60"}),e.jsx("p",{children:c("devices.noErrorLogs")})]}),!x&&!t&&d.length>0&&e.jsx("div",{className:"space-y-3",children:d.map(m=>e.jsxs("div",{className:"p-4 rounded-xl border border-slate-200 dark:border-dark-600 bg-slate-50 dark:bg-dark-700/40",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold ${m.level==="FATAL"?"bg-red-800 text-white":"bg-red-600 text-white"}`,children:m.level}),e.jsx("span",{className:"text-xs text-slate-500",children:new Date(m.timestamp).toLocaleString()})]}),e.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300",children:m.message})]},m.id))})]}),e.jsx("div",{className:"p-6 border-t border-slate-200 dark:border-dark-600 flex justify-end",children:e.jsx("button",{onClick:n,className:"btn-secondary",children:c("common.close")})})]})]})},Us=()=>{var S,W,V,_,U,J,B;const{t:s}=D(),[n,c]=u.useState("24h"),[i,x]=u.useState(new Date),{data:t,refetch:g}=$e(),{data:d}=be(!0),{data:m}=Oe(),{data:b}=Fe(),{data:o}=Pe(),{data:r}=ds(),{data:j}=cs();o!=null&&o.data;const k=r||{totalDevices:0,onlineDevices:0,offlineDevices:0,maintenanceDevices:0,alertsToday:0,upgradesInProgress:0};u.useEffect(()=>{const l=setInterval(()=>{x(new Date)},1e3);return()=>clearInterval(l)},[]);const T=t!=null&&t.healthDistribution?Object.entries(t.healthDistribution).map(([l,y])=>({name:s(`health.${l.toLowerCase()}`),value:y,status:l})):[],h=[{name:s("mdm.online"),value:k.onlineDevices,color:"#10b981"},{name:s("mdm.offline"),value:k.offlineDevices,color:"#ef4444"},{name:s("mdm.maintenance"),value:k.maintenanceDevices,color:"#f59e0b"}],A=[{time:"00:00",cpu:35,memory:42,battery:85},{time:"04:00",cpu:28,memory:38,battery:82},{time:"08:00",cpu:55,memory:62,battery:75},{time:"12:00",cpu:72,memory:78,battery:65},{time:"16:00",cpu:68,memory:71,battery:58},{time:"20:00",cpu:45,memory:52,battery:52},{time:"23:59",cpu:38,memory:45,battery:48}],M=l=>l>=90?"#10b981":l>=75?"#3b82f6":l>=60?"#f59e0b":l>=40?"#f97316":"#ef4444",P=l=>l>=90?s("health.excellent"):l>=75?s("health.good"):l>=60?s("health.fair"):l>=40?s("health.poor"):s("health.critical");return e.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl lg:text-2xl font-display font-bold text-slate-900 dark:text-slate-100",children:s("devices.dashboard")}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1 text-sm lg:text-base",children:s("devices.dashboardSubtitle")})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 lg:gap-3",children:[e.jsxs("select",{value:n,onChange:l=>c(l.target.value),className:"input-field text-sm",children:[e.jsx("option",{value:"1h",children:s("time.last1h")}),e.jsx("option",{value:"24h",children:s("time.last24h")}),e.jsx("option",{value:"7d",children:s("time.last7d")}),e.jsx("option",{value:"30d",children:s("time.last30d")})]}),e.jsxs("button",{onClick:()=>g(),className:"btn-secondary flex items-center gap-2 text-sm",children:[e.jsx(We,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:s("common.refresh")})]}),e.jsxs("span",{className:"text-xs text-slate-500",children:[s("common.lastUpdated"),": ",i.toLocaleTimeString()]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("button",{onClick:()=>{},className:"flex items-center gap-2 px-4 py-2 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg hover:bg-red-100 dark:hover:bg-red-900/40 transition-colors",children:[e.jsx(Te,{className:"w-4 h-4 text-red-500"}),e.jsxs("span",{className:"text-sm font-semibold text-red-700 dark:text-red-300",children:[s("mdm.offline"),": ",k.offlineDevices]})]}),e.jsxs("button",{onClick:()=>{},className:"flex items-center gap-2 px-4 py-2 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg hover:bg-amber-100 dark:hover:bg-amber-900/40 transition-colors",children:[e.jsx(K,{className:"w-4 h-4 text-amber-500"}),e.jsxs("span",{className:"text-sm font-semibold text-amber-700 dark:text-amber-300",children:[s("mdm.stats.critical"),": ",k.alertsToday||0]})]}),e.jsxs("button",{onClick:()=>{},className:"flex items-center gap-2 px-4 py-2 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg hover:bg-blue-100 dark:hover:bg-blue-900/40 transition-colors",children:[e.jsx(xe,{className:"w-4 h-4 text-blue-500"}),e.jsxs("span",{className:"text-sm font-semibold text-blue-700 dark:text-blue-300",children:[s("mdm.upgradesInProgress"),": ",k.upgradesInProgress||0]})]})]}),j&&j.length>0&&e.jsxs(f.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-xl p-4 flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-amber-500/10 rounded-lg",children:e.jsx(q,{className:"w-5 h-5 text-amber-500"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-semibold text-amber-800 dark:text-amber-200",children:s("mdm.inventory.lowStockTitle",{count:j.length})}),e.jsx("div",{className:"flex flex-wrap gap-4 mt-1",children:j.map(l=>e.jsxs("span",{className:"text-xs text-amber-600 dark:text-amber-400",children:["• ",s(`common.types.${l.type}`),": ",l.stock," (",s("mdm.inventory.threshold",{value:l.threshold}),")"]},l.type))})]}),e.jsx("button",{className:"text-sm font-medium text-amber-700 dark:text-amber-300 hover:underline",children:s("common.viewDetails")})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-9 gap-4",children:[{label:s("mdm.stats.totalDevices"),value:k.totalDevices,icon:pe,color:"blue",trend:"+2%"},{label:s("mdm.stats.online"),value:k.onlineDevices,icon:Ke,color:"green",trend:"+5%"},{label:s("mdm.stats.offline"),value:k.offlineDevices,icon:Te,color:"red",trend:"-1%"},{label:s("mdm.stats.healthScore"),value:(t==null?void 0:t.averageScore)||0,icon:Z,color:"purple",suffix:"/100"},{label:s("mdm.stats.critical"),value:((S=d==null?void 0:d.summary)==null?void 0:S.criticalCount)||0,icon:q,color:"red"},{label:s("mdm.stats.maintenance"),value:((W=d==null?void 0:d.upcomingMaintenance)==null?void 0:W.length)||0,icon:Q,color:"orange"},{label:s("mdm.stats.deployments"),value:(m==null?void 0:m.length)||0,icon:Y,color:"cyan"},{label:s("mdm.stats.anomalies"),value:(b==null?void 0:b.length)||0,icon:Me,color:"pink"},{label:s("mdm.stats.inventoryAlert"),value:(j==null?void 0:j.length)||0,icon:Ne,color:"amber"}].map((l,y)=>e.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:y*.05},className:"stat-card cursor-pointer hover:shadow-lg transition-shadow",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:l.label}),e.jsxs("p",{className:"text-xl font-bold text-slate-900 dark:text-slate-100 mt-1",children:[l.value,l.suffix||""]}),l.trend&&e.jsx("p",{className:`text-xs mt-1 ${l.trend.startsWith("+")?"text-success":"text-error"}`,children:l.trend})]}),e.jsx("div",{className:`p-2 rounded-lg bg-${l.color}-500/10`,children:e.jsx(l.icon,{className:`w-4 h-4 text-${l.color}-500`})})]})},l.label))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"glass-panel p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:s("mdm.dashboard.fleetHealth")}),e.jsx("p",{className:"text-sm text-slate-500",children:s("mdm.dashboard.fleetHealthDesc")})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-3xl font-bold",style:{color:M((t==null?void 0:t.averageScore)||0)},children:(t==null?void 0:t.averageScore)||0}),e.jsx("p",{className:"text-sm text-slate-500",children:P((t==null?void 0:t.averageScore)||0)})]})]}),e.jsx("div",{className:"h-48",children:e.jsx(G,{width:"100%",height:"100%",children:e.jsxs(Ie,{children:[e.jsx(Le,{data:T,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:5,dataKey:"value",children:T.map((l,y)=>e.jsx(Re,{fill:Ee[y%Ee.length]},`cell-${y}`))}),e.jsx(me,{}),e.jsx(Is,{verticalAlign:"bottom",height:36})]})})})]}),e.jsxs("div",{className:"glass-panel p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100 mb-4",children:s("mdm.dashboard.deviceStatus")}),e.jsx("div",{className:"h-48",children:e.jsx(G,{width:"100%",height:"100%",children:e.jsxs(Ie,{children:[e.jsx(Le,{data:h,cx:"50%",cy:"50%",outerRadius:80,dataKey:"value",label:({name:l,value:y})=>`${l}: ${y}`,children:h.map((l,y)=>e.jsx(Re,{fill:l.color},`cell-${y}`))}),e.jsx(me,{})]})})}),e.jsx("div",{className:"mt-4 grid grid-cols-3 gap-2 text-center",children:h.map(l=>e.jsxs("div",{className:"p-2 rounded-lg bg-slate-50 dark:bg-dark-700",children:[e.jsx("p",{className:"text-lg font-bold",style:{color:l.color},children:l.value}),e.jsx("p",{className:"text-xs text-slate-500",children:l.name})]},l.name))})]}),e.jsxs("div",{className:"glass-panel p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100 mb-4",children:s("mdm.dashboard.performanceTrends")}),e.jsx("div",{className:"h-48",children:e.jsx(G,{width:"100%",height:"100%",children:e.jsxs(se,{data:A,children:[e.jsx(Ls,{strokeDasharray:"3 3",className:"stroke-slate-200 dark:stroke-dark-600"}),e.jsx(Rs,{dataKey:"time",stroke:"#64748b",fontSize:12}),e.jsx(Ts,{stroke:"#64748b",fontSize:12}),e.jsx(me,{}),e.jsx(X,{type:"monotone",dataKey:"cpu",stackId:"1",stroke:"#3b82f6",fill:"#3b82f6",fillOpacity:.3,name:s("mdm.cpu")}),e.jsx(X,{type:"monotone",dataKey:"memory",stackId:"1",stroke:"#8b5cf6",fill:"#8b5cf6",fillOpacity:.3,name:s("mdm.memory")})]})})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"glass-panel p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-500/10 rounded-lg",children:e.jsx(Me,{className:"w-5 h-5 text-purple-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:s("mdm.dashboard.aiPredictions")}),e.jsx("p",{className:"text-sm text-slate-500",children:s("mdm.dashboard.aiPredictionsDesc")})]})]}),e.jsxs("span",{className:"text-sm text-slate-500",children:[s("mdm.dashboard.confidence"),": ",((V=d==null?void 0:d.summary)==null?void 0:V.averageConfidence)||0,"%"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 rounded-lg border border-red-200 dark:border-red-800",children:[e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:s("predictions.critical")}),e.jsx("p",{className:"text-2xl font-bold text-red-700 dark:text-red-300",children:((_=d==null?void 0:d.summary)==null?void 0:_.criticalCount)||0})]}),e.jsxs("div",{className:"p-4 bg-orange-50 dark:bg-orange-900/20 rounded-lg border border-orange-200 dark:border-orange-800",children:[e.jsx("p",{className:"text-sm text-orange-600 dark:text-orange-400",children:s("predictions.high")}),e.jsx("p",{className:"text-2xl font-bold text-orange-700 dark:text-orange-300",children:((U=d==null?void 0:d.summary)==null?void 0:U.highCount)||0})]})]}),e.jsx("div",{className:"space-y-3",children:((J=d==null?void 0:d.atRiskDevices)==null?void 0:J.slice(0,5).map(l=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 dark:bg-dark-700/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${l.priority==="CRITICAL"?"bg-red-500":l.priority==="HIGH"?"bg-orange-500":"bg-yellow-500"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:l.deviceId}),e.jsx("p",{className:"text-xs text-slate-500",children:l.description})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm font-medium",children:[l.confidence,"%"]}),e.jsxs("p",{className:"text-xs text-slate-500",children:[l.estimatedTimeToFailure,"d"]})]})]},l.predictionId)))||e.jsx("p",{className:"text-center text-slate-500 py-8",children:s("mdm.dashboard.noPredictions")})})]}),e.jsxs("div",{className:"glass-panel p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-amber-500/10 rounded-lg",children:e.jsx(Q,{className:"w-5 h-5 text-amber-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:s("mdm.dashboard.maintenance")}),e.jsx("p",{className:"text-sm text-slate-500",children:s("mdm.dashboard.maintenanceDesc")})]})]}),e.jsx("button",{className:"text-sm text-primary-600 hover:underline",children:s("common.viewAll")})]}),e.jsx("div",{className:"space-y-3",children:((B=d==null?void 0:d.upcomingMaintenance)==null?void 0:B.slice(0,5).map(l=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 dark:bg-dark-700/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${l.priority==="CRITICAL"?"bg-red-100 text-red-600":l.priority==="HIGH"?"bg-orange-100 text-orange-600":"bg-blue-100 text-blue-600"}`,children:e.jsx(Q,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:l.deviceId}),e.jsx("p",{className:"text-xs text-slate-500",children:s(`mdm.maintenanceTypes.${l.maintenanceType}`)||l.maintenanceType})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-medium",children:new Date(l.scheduledDate).toLocaleDateString()}),e.jsxs("p",{className:"text-xs text-slate-500",children:["$",l.estimatedCost]})]})]},l.scheduleId)))||e.jsx("p",{className:"text-center text-slate-500 py-8",children:s("mdm.dashboard.noMaintenance")})})]})]}),b&&Array.isArray(b)&&b.length>0&&e.jsxs("div",{className:"glass-panel p-6 border-l-4 border-red-500",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(q,{className:"w-5 h-5 text-red-500"}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:s("mdm.dashboard.anomalies")})]}),e.jsxs("span",{className:"px-3 py-1 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 rounded-full text-sm font-medium",children:[b.length," ",s("mdm.dashboard.devices")]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:(Array.isArray(b)?b:[]).slice(0,6).map(l=>{var y;return e.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/10 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-mono text-sm",children:l.deviceId}),e.jsxs("span",{className:"text-xs text-red-600",children:[Array.isArray(l.anomalies)?l.anomalies.length:0," ",s("mdm.issues")]})]}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:Array.isArray(l.anomalies)&&((y=l.anomalies[0])==null?void 0:y.description)})]},l.deviceId)})})]})]})},Bs=()=>{const{t:s}=D(),[n,c]=u.useState("devices"),[i,x]=u.useState(!1),[t,g]=u.useState([]),[d,m]=u.useState(null),[b,o]=u.useState(null),{confirm:r,dialogProps:j}=ms(),[k,T]=u.useState(null),[h,A]=u.useState(null),[M,P]=u.useState(""),[S,W]=u.useState("all"),[V,_]=u.useState("all"),[U,J]=u.useState("all"),[B,l]=u.useState(!1),y=u.useRef(null),[H,qe]=u.useState("all"),{data:ie,isLoading:Qe,isError:ve,error:ye,refetch:Xe}=Pe(),ke=os(),we=xs(),Ce=Ds({resolver:Ss(Fs)}),ne=a=>{if(!a)return"-";const p=a.match(/\d+/);return p?s("devices.routeLabel",{id:Number(p[0])}):a},Ye=a=>{const p=new Date(a),N=new Date,w=N.getTime()-p.getTime(),R=60*1e3,$=60*R,O=24*$;if(w<R)return s("devices.justNow");const v=Math.floor(w/R);if(v<60)return s("devices.minutesAgo",{count:v});const ce=Math.floor(w/$),Se=p.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});if(N.toDateString()===p.toDateString())return s("devices.todayAt",{time:Se});const Ae=new Date(N);return Ae.setDate(N.getDate()-1),Ae.toDateString()===p.toDateString()?s("devices.yesterdayAt",{time:Se}):ce<24?s("devices.hoursAgo",{count:ce}):s("devices.daysAgo",{count:Math.floor(w/O)})},De=a=>a==="OFFLINE"?"bg-red-700 dark:bg-red-600 text-white":a==="MAINTENANCE"?"bg-amber-600 dark:bg-amber-500 text-white":a==="ACTIVE"?"bg-emerald-600 dark:bg-emerald-500 text-white":"bg-slate-600 text-white",de=(ie==null?void 0:ie.data)||[],Ze=Array.from(new Set(de.map(a=>a.type))),Je=Array.from(new Set(de.filter(a=>!!a.vehicleId).map(a=>ne(a.vehicleId)))),C=de.filter(a=>{const p=["ONBOARD","VALIDATOR","TOPUP"].includes(a.type)&&(!!a.terminalId||!!a.vehicleId),N=S==="all"||p,w=S!=="terminal_business"||V==="all"||ne(a.vehicleId)===V,R=!M||a.id.toLowerCase().includes(M.toLowerCase())||a.serialNumber.toLowerCase().includes(M.toLowerCase())||a.type.toLowerCase().includes(M.toLowerCase()),$=U==="all"||a.type===U,O=H==="all"||H==="online"&&a.status==="ACTIVE"||H==="offline"&&a.status==="OFFLINE"||H==="maintenance"&&a.status==="MAINTENANCE";return N&&w&&R&&$&&O}),es=()=>{var a;(a=y.current)==null||a.click()},ss=a=>{var N;const p=(N=a.target.files)==null?void 0:N[0];p&&(m(null),o(s("devices.bulkImportSuccess",{file:p.name})),a.target.value="")},as=()=>{if(C.length===0){m(s("devices.bulkExportEmpty"));return}const a=["id","type","serialNumber","terminalId","vehicleId","status","firmwareVersion","lastActivityAt"],p=v=>`"${(v==null?"":String(v)).replace(/"/g,'""')}"`,N=C.map(v=>[p(v.id),p(v.type),p(v.serialNumber),p(v.terminalId),p(v.vehicleId),p(v.status),p(v.firmwareVersion),p(v.lastActivityAt)]),w=[a.join(","),...N.map(v=>v.join(","))].join(`
`),R=new Blob([w],{type:"text/csv;charset=utf-8;"}),$=URL.createObjectURL(R),O=document.createElement("a");O.href=$,O.download=`devices_${new Date().toISOString().slice(0,10)}.csv`,O.click(),URL.revokeObjectURL($),o(s("devices.bulkExportSuccess",{count:C.length}))},ee=a=>{m(null),o(s("devices.bulkActionQueued",{action:s(`devices.bulkActions.${a}`),count:t.length}))},ts=a=>{m(null),o(s("devices.remoteControlHint",{deviceId:a}))},I=B?"table-header-compact":"table-header",L=B?"table-cell-compact":"table-cell",ls=async a=>{var p,N;m(null);try{await ke.mutateAsync(a),x(!1),Ce.reset()}catch(w){m(((N=(p=w.response)==null?void 0:p.data)==null?void 0:N.message)||s("mdm.createDeviceError"))}},rs=async a=>{var N,w;if(await r({type:"danger",title:s("mdm.deleteDevice"),message:s("mdm.confirmDeleteDevice"),riskWarning:s("mdm.deleteDeviceWarning"),countdown:3})){m(null);try{await we.mutateAsync(a)}catch(R){m(((w=(N=R.response)==null?void 0:N.data)==null?void 0:w.message)||s("mdm.deleteDeviceError"))}}};return Qe?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(z,{className:"w-8 h-8 animate-spin text-primary-600"})}):e.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"space-y-6",children:[d&&e.jsxs("div",{className:"p-4 bg-error/10 border border-error/20 rounded-lg flex items-center gap-3 text-error",children:[e.jsx(K,{className:"w-5 h-5"}),e.jsx("span",{children:d}),e.jsx("button",{onClick:()=>m(null),className:"ml-auto text-sm hover:underline",children:s("common.dismiss")})]}),b&&e.jsxs("div",{className:"p-4 bg-success/10 border border-success/20 rounded-lg flex items-center gap-3 text-success",children:[e.jsx(hs,{className:"w-5 h-5"}),e.jsx("span",{children:b}),e.jsx("button",{onClick:()=>o(null),className:"ml-auto text-sm hover:underline",children:s("common.dismiss")})]}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("div",{children:e.jsx("h1",{className:"text-lg font-display font-semibold text-slate-900 dark:text-slate-100",children:s("devices.deviceList")})})}),e.jsxs("div",{className:"glass-panel",children:[e.jsx("div",{className:"flex gap-1 p-4 border-b border-slate-200 dark:border-dark-600 overflow-x-auto bg-slate-50 dark:bg-dark-800/50",children:[{key:"all",label:s("mdm.filterAll"),count:C.length},{key:"online",label:s("mdm.filterOnline"),count:C.filter(a=>a.status==="ACTIVE").length},{key:"offline",label:s("mdm.filterOffline"),count:C.filter(a=>a.status==="OFFLINE").length},{key:"maintenance",label:s("mdm.filterMaintenance"),count:C.filter(a=>a.status==="MAINTENANCE").length}].map(a=>e.jsxs("button",{onClick:()=>qe(a.key),className:`px-4 py-2 rounded-lg font-medium transition-all whitespace-nowrap flex items-center gap-2 ${H===a.key?"bg-primary-500 text-white shadow-md":"text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-200 hover:bg-slate-200 dark:hover:bg-dark-700"}`,children:[e.jsx("span",{children:a.label}),e.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-xs ${H===a.key?"bg-white/20":"bg-slate-200 dark:bg-dark-600"}`,children:a.count})]},a.key))}),e.jsx("div",{className:"p-6",children:e.jsxs(ue,{mode:"wait",children:[n==="devices"&&e.jsxs(f.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"space-y-4",children:[ve&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 gap-4",children:[e.jsx(K,{className:"w-12 h-12 text-error"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:ye instanceof Error?ye.message:s("common.loadError")}),e.jsxs("button",{onClick:()=>Xe(),className:"btn-secondary flex items-center gap-2",children:[e.jsx(ge,{className:"w-4 h-4"}),s("common.retry")]})]}),!ve&&C.length===0&&e.jsxs("div",{className:"text-center py-12 text-slate-500",children:[e.jsx(pe,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:s("mdm.noDevices")})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mb-4",children:[e.jsxs("select",{value:S,onChange:a=>{const p=a.target.value;W(p),p!=="terminal_business"&&_("all")},className:"px-4 py-2 bg-slate-100 dark:bg-dark-700 border border-slate-200 dark:border-dark-600 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"all",children:s("devices.viewAllDevices")}),e.jsx("option",{value:"terminal_business",children:s("devices.viewTerminalBusiness")})]}),e.jsxs("div",{className:"relative flex-1 min-w-[280px]",children:[e.jsx(ps,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx("input",{type:"text",placeholder:s("mdm.searchDevices"),value:M,onChange:a=>P(a.target.value),className:"input-field pl-10"})]}),S==="terminal_business"&&e.jsxs("select",{value:V,onChange:a=>_(a.target.value),className:"px-4 py-2 bg-slate-100 dark:bg-dark-700 border border-slate-200 dark:border-dark-600 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"all",children:s("devices.allRoutes")}),Je.map(a=>e.jsx("option",{value:a,children:a},a))]}),e.jsxs("select",{value:U,onChange:a=>J(a.target.value),className:"px-4 py-2 bg-slate-100 dark:bg-dark-700 border border-slate-200 dark:border-dark-600 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"all",children:s("common.allTypes")}),Ze.map(a=>e.jsx("option",{value:a,children:s(`common.types.${a}`,{defaultValue:a})},a))]}),e.jsx("button",{onClick:()=>l(a=>!a),className:`px-3 py-2 rounded-lg text-sm font-medium border transition-colors ${B?"bg-primary-50 dark:bg-primary-500/10 text-primary-600 border-primary-200 dark:border-primary-500/30":"bg-transparent text-slate-600 dark:text-slate-400 border-slate-200 dark:border-dark-600 hover:bg-slate-50 dark:hover:bg-dark-700"}`,children:s("devices.compactMode")}),e.jsx("input",{ref:y,type:"file",accept:".csv,.xlsx",onChange:ss,className:"hidden"}),e.jsxs("button",{type:"button",onClick:es,className:"px-3 py-2 rounded-lg text-sm font-medium border border-primary-200 dark:border-primary-500/30 text-primary-600 hover:bg-primary-50 dark:hover:bg-primary-500/10 flex items-center gap-2",title:s("devices.bulkImportHint"),children:[e.jsx(xe,{className:"w-4 h-4"}),s("devices.bulkImport")]}),e.jsxs("button",{type:"button",onClick:as,className:"px-3 py-2 rounded-lg text-sm font-medium border border-slate-200 dark:border-dark-600 text-slate-700 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-dark-700 flex items-center gap-2",title:s("devices.bulkExportHint"),children:[e.jsx(he,{className:"w-4 h-4"}),s("devices.bulkExport")]}),e.jsxs("button",{onClick:()=>x(!0),className:"btn-primary flex items-center gap-2 shadow-lg shadow-primary-500/30 hover:shadow-primary-500/50 hover:scale-[1.02] transition-transform",children:[e.jsx(ze,{className:"w-4 h-4"}),s("devices.addDevice")]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-slate-200 dark:border-dark-600",children:[e.jsx("th",{className:I,children:e.jsx("input",{type:"checkbox",checked:t.length===C.length&&C.length>0,onChange:a=>{a.target.checked?g(C.map(p=>p.id)):g([])},className:"rounded border-slate-300"})}),e.jsx("th",{className:I,children:s("mdm.deviceId")}),e.jsx("th",{className:I,children:s("mdm.deviceType")}),e.jsx("th",{className:I,children:s("mdm.serialNumber")}),e.jsx("th",{className:I,children:s("devices.linkedTerminalRoute")}),e.jsx("th",{className:I,children:s("mdm.firmwareVersion")}),e.jsx("th",{className:I,children:s("mdm.status")}),e.jsx("th",{className:I,children:s("mdm.lastActivity")}),e.jsx("th",{className:I,children:s("common.actions")})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 dark:divide-dark-600",children:C.map(a=>e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-dark-700/30",children:[e.jsx("td",{className:L,children:e.jsx("input",{type:"checkbox",checked:t.includes(a.id),onChange:p=>{p.target.checked?g([...t,a.id]):g(t.filter(N=>N!==a.id))},className:"rounded border-slate-300"})}),e.jsx("td",{className:`${L} font-mono text-primary-600`,children:a.id}),e.jsx("td",{className:L,children:a.type}),e.jsx("td",{className:`${L} font-mono`,children:a.serialNumber}),e.jsx("td",{className:L,children:e.jsxs("div",{className:"leading-tight",children:[e.jsx("div",{className:"font-mono",children:a.terminalId||"-"}),e.jsx("div",{className:"text-slate-500",children:ne(a.vehicleId)})]})}),e.jsx("td",{className:L,children:a.firmwareVersion}),e.jsx("td",{className:L,children:a.status==="OFFLINE"?e.jsx("button",{type:"button",onClick:()=>A(a.id),title:s("devices.openOfflineLogs"),className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold hover:opacity-90 transition-opacity ${De(a.status)}`,children:a.status}):e.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold ${De(a.status)}`,children:a.status})}),e.jsx("td",{className:`${L} text-slate-500`,title:new Date(a.lastActivityAt).toLocaleString(),children:Ye(a.lastActivityAt)}),e.jsx("td",{className:L,children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>T(a.id),className:"p-1 hover:bg-slate-100 dark:hover:bg-dark-600 rounded",children:e.jsx(Ve,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>ts(a.id),className:"p-1 hover:bg-slate-100 dark:hover:bg-dark-600 rounded",title:s("devices.remoteControl"),children:e.jsx(le,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>A(a.id),className:"p-1 hover:bg-slate-100 dark:hover:bg-dark-600 rounded",title:s("devices.viewLogs"),children:e.jsx(ae,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>rs(a.id),disabled:we.isPending,className:"p-1 hover:bg-error/10 text-error rounded disabled:opacity-50",children:e.jsx(_e,{className:"w-4 h-4"})})]})})]},a.id))})]})}),t.length>0&&e.jsxs("div",{className:"flex flex-wrap items-center gap-4 p-4 bg-slate-50 dark:bg-dark-700 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:s("devices.bulkActionsLabel")}),e.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:s("mdm.selectedDevices",{count:t.length})}),e.jsxs("div",{className:"flex gap-2 ml-auto flex-wrap",children:[e.jsxs("button",{className:"btn-secondary text-sm",onClick:()=>ee("command"),children:[e.jsx(ae,{className:"w-4 h-4 mr-2"}),s("devices.bulkActions.command")]}),e.jsxs("button",{className:"btn-secondary text-sm",onClick:()=>ee("upgrade"),children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),s("devices.bulkActions.upgrade")]}),e.jsxs("button",{className:"btn-secondary text-sm",onClick:()=>ee("reboot"),children:[e.jsx(We,{className:"w-4 h-4 mr-2"}),s("devices.bulkActions.reboot")]}),e.jsxs("button",{className:"btn-secondary text-sm",onClick:()=>ee("status"),children:[e.jsx(Ue,{className:"w-4 h-4 mr-2"}),s("devices.bulkActions.status")]})]})]})]},"devices"),n!=="devices"&&e.jsxs(f.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"text-center py-12 text-slate-500",children:[e.jsx(re,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:s("common.comingSoon")}),e.jsx("p",{className:"text-sm mt-2",children:s("devices.tabInDevelopment",{tab:n})})]},n)]})})]}),i&&e.jsx(Ps,{onClose:()=>x(!1),onSubmit:ls,isSubmitting:ke.isPending,methods:Ce}),k&&e.jsx(Ws,{deviceId:k,onClose:()=>T(null)}),h&&e.jsx(Vs,{deviceId:h,onClose:()=>A(null)}),e.jsx(bs,{...j})]})},Hs=()=>{var b,o;const{t:s}=D(),{data:n}=$e(),{data:c}=be(!0),{data:i}=Fe(),{data:x}=Be(),[t,g]=u.useState({communication:{signal4G:-65+Math.floor(Math.random()*20),wifiLatency:15+Math.floor(Math.random()*30),simTraffic:2.5+Math.random()*2},hardware:{flashWrites:85+Math.floor(Math.random()*10),voltage:11.8+Math.random()*.5,temperature:35+Math.floor(Math.random()*15)},peripherals:{cardReader:Math.random()>.1,display:Math.random()>.05,speaker:Math.random()>.1,printer:Math.random()>.2}});u.useEffect(()=>{const r=setInterval(()=>{g({communication:{signal4G:-65+Math.floor(Math.random()*20),wifiLatency:15+Math.floor(Math.random()*30),simTraffic:2.5+Math.random()*2},hardware:{flashWrites:85+Math.floor(Math.random()*10),voltage:11.8+Math.random()*.5,temperature:35+Math.floor(Math.random()*15)},peripherals:{cardReader:Math.random()>.1,display:Math.random()>.05,speaker:Math.random()>.1,printer:Math.random()>.2}})},5e3);return()=>clearInterval(r)},[]);const d=r=>r>-60?"text-green-500":r>-75?"text-yellow-500":"text-red-500",m=r=>r>12?"text-green-500":r>11.5?"text-yellow-500":"text-red-500";return e.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-display font-bold text-slate-900 dark:text-slate-100",children:s("devices.health")}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:s("devices.healthSubtitle")})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[{label:s("maintenance.critical"),value:((b=c==null?void 0:c.summary)==null?void 0:b.criticalCount)||0,icon:q,color:"red"},{label:s("maintenance.highPriority"),value:((o=c==null?void 0:c.summary)==null?void 0:o.highCount)||0,icon:us,color:"orange"},{label:s("maintenance.scheduled"),value:(x==null?void 0:x.length)||0,icon:re,color:"blue"},{label:s("maintenance.anomalies"),value:(i==null?void 0:i.length)||0,icon:Z,color:"amber"}].map((r,j)=>e.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:j*.1},className:"stat-card",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:r.label}),e.jsx("p",{className:"text-2xl font-display font-bold text-slate-900 dark:text-slate-100 mt-2",children:r.value})]}),e.jsx("div",{className:`p-3 rounded-lg bg-${r.color}-500/10`,children:e.jsx(r.icon,{className:`w-6 h-6 text-${r.color}-600 dark:text-${r.color}-400`})})]})},r.label))}),e.jsxs("div",{className:"glass-panel p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Ke,{className:"w-5 h-5 text-blue-500"}),s("mdm.health.communication")]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-dark-700 rounded-xl",children:[e.jsx("p",{className:"text-sm text-slate-500 mb-2",children:s("mdm.health.signal4G")}),e.jsxs("p",{className:`text-2xl font-bold ${d(t.communication.signal4G)}`,children:[t.communication.signal4G," dBm"]}),e.jsx("div",{className:"flex gap-1 mt-2",children:[1,2,3,4,5].map(r=>e.jsx("div",{className:`h-${r+1} w-2 rounded ${t.communication.signal4G>-50-r*10?"bg-green-500":"bg-slate-300 dark:bg-dark-600"}`},r))})]}),e.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-dark-700 rounded-xl",children:[e.jsx("p",{className:"text-sm text-slate-500 mb-2",children:s("mdm.health.wifiLatency")}),e.jsxs("p",{className:`text-2xl font-bold ${t.communication.wifiLatency<30?"text-green-500":"text-yellow-500"}`,children:[t.communication.wifiLatency," ms"]})]}),e.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-dark-700 rounded-xl",children:[e.jsx("p",{className:"text-sm text-slate-500 mb-2",children:s("mdm.health.simTraffic")}),e.jsxs("p",{className:"text-2xl font-bold text-blue-500",children:[t.communication.simTraffic.toFixed(1)," GB"]})]})]})]}),e.jsxs("div",{className:"glass-panel p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Ne,{className:"w-5 h-5 text-purple-500"}),s("mdm.health.hardwareLifecycle")]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-dark-700 rounded-xl",children:[e.jsx("p",{className:"text-sm text-slate-500 mb-2",children:s("mdm.health.flashWrites")}),e.jsxs("p",{className:`text-2xl font-bold ${t.hardware.flashWrites>90?"text-red-500":"text-green-500"}`,children:[t.hardware.flashWrites,"%"]}),e.jsx("div",{className:"h-2 bg-slate-200 dark:bg-dark-600 rounded-full mt-2 overflow-hidden",children:e.jsx("div",{className:`h-full ${t.hardware.flashWrites>90?"bg-red-500":"bg-green-500"}`,style:{width:`${t.hardware.flashWrites}%`}})})]}),e.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-dark-700 rounded-xl",children:[e.jsx("p",{className:"text-sm text-slate-500 mb-2",children:s("mdm.health.voltage")}),e.jsxs("p",{className:`text-2xl font-bold ${m(t.hardware.voltage)}`,children:[t.hardware.voltage.toFixed(1)," V"]})]}),e.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-dark-700 rounded-xl",children:[e.jsx("p",{className:"text-sm text-slate-500 mb-2",children:s("mdm.health.temperature")}),e.jsxs("p",{className:`text-2xl font-bold ${t.hardware.temperature>50?"text-red-500":"text-green-500"}`,children:[t.hardware.temperature,"°C"]})]})]})]}),e.jsxs("div",{className:"glass-panel p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(fe,{className:"w-5 h-5 text-cyan-500"}),s("mdm.health.peripherals")]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[{name:s("mdm.health.cardReader"),status:t.peripherals.cardReader,icon:gs},{name:s("mdm.health.display"),status:t.peripherals.display,icon:js},{name:s("mdm.health.speaker"),status:t.peripherals.speaker,icon:Os},{name:s("mdm.health.printer"),status:t.peripherals.printer,icon:Es}].map(r=>e.jsx("div",{className:`p-4 rounded-xl border-2 ${r.status?"border-green-500 bg-green-50 dark:bg-green-950/20":"border-red-500 bg-red-50 dark:bg-red-950/20"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(r.icon,{className:`w-6 h-6 ${r.status?"text-green-500":"text-red-500"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:r.name}),e.jsx("p",{className:`text-sm ${r.status?"text-green-600":"text-red-600"}`,children:r.status?s("common.online"):s("common.offline")})]})]})},r.name))})]}),e.jsxs("div",{className:"glass-panel p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:s("maintenance.fleetHealth")}),n&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:s("maintenance.averageScore")}),e.jsxs("span",{className:"text-2xl font-bold",children:[n.averageScore,"/100"]})]}),e.jsx("div",{className:"h-4 bg-slate-200 dark:bg-dark-600 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary-500",style:{width:`${n.averageScore}%`}})})]})]}),e.jsxs("div",{className:"glass-panel p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Z,{className:"w-5 h-5 text-indigo-500"}),s("mdm.resourceMonitoring.resourceUsage")]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-slate-50 dark:bg-dark-700/50 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-sm font-medium",children:s("mdm.resourceMonitoring.cpu")}),e.jsxs("span",{className:"text-lg font-bold text-indigo-600",children:[t.hardware.temperature,"%"]})]}),e.jsx(G,{width:"100%",height:100,children:e.jsx(se,{data:Array.from({length:20},(r,j)=>({time:j,value:30+Math.random()*40})),children:e.jsx(X,{type:"monotone",dataKey:"value",stroke:"#6366f1",fill:"#6366f1",fillOpacity:.2})})})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-dark-700/50 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-sm font-medium",children:s("mdm.resourceMonitoring.memory")}),e.jsx("span",{className:"text-lg font-bold text-emerald-600",children:"62%"})]}),e.jsx(G,{width:"100%",height:100,children:e.jsx(se,{data:Array.from({length:20},(r,j)=>({time:j,value:50+Math.random()*30})),children:e.jsx(X,{type:"monotone",dataKey:"value",stroke:"#10b981",fill:"#10b981",fillOpacity:.2})})})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-dark-700/50 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-sm font-medium",children:s("mdm.resourceMonitoring.storage")}),e.jsxs("span",{className:"text-lg font-bold text-amber-600",children:[t.hardware.flashWrites,"%"]})]}),e.jsx(G,{width:"100%",height:100,children:e.jsx(se,{data:Array.from({length:20},(r,j)=>({time:j,value:40+Math.random()*20})),children:e.jsx(X,{type:"monotone",dataKey:"value",stroke:"#f59e0b",fill:"#f59e0b",fillOpacity:.2})})})]})]})]}),e.jsxs("div",{className:"glass-panel p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(le,{className:"w-5 h-5 text-yellow-500"}),s("mdm.resourceMonitoring.environment")]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-dark-700/50 rounded-xl text-center",children:[e.jsx("p",{className:"text-sm text-slate-500 mb-1",children:s("mdm.health.temperature")}),e.jsxs("p",{className:`text-2xl font-bold ${t.hardware.temperature>70?"text-red-500":"text-green-500"}`,children:[t.hardware.temperature,"°C"]})]}),e.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-dark-700/50 rounded-xl text-center",children:[e.jsx("p",{className:"text-sm text-slate-500 mb-1",children:s("mdm.health.voltage")}),e.jsxs("p",{className:`text-2xl font-bold ${t.hardware.voltage<4.5?"text-amber-500":"text-green-500"}`,children:[t.hardware.voltage,"V"]})]}),e.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-dark-700/50 rounded-xl text-center",children:[e.jsx("p",{className:"text-sm text-slate-500 mb-1",children:s("mdm.resourceMonitoring.humidity")}),e.jsx("p",{className:"text-2xl font-bold text-blue-500",children:"45%"})]}),e.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-dark-700/50 rounded-xl text-center",children:[e.jsx("p",{className:"text-sm text-slate-500 mb-1",children:s("mdm.resourceMonitoring.uptime")}),e.jsx("p",{className:"text-2xl font-bold text-purple-500",children:"72h"})]})]})]})]})},Gs=()=>{const{t:s}=D(),{data:n,isLoading:c}=fs(),{data:i}=Oe(),[x,t]=u.useState(!1),[g,d]=u.useState(null),[m,b]=u.useState({targetPercentage:5,routeFilter:"",deviceIds:"",silentUpgrade:!0,upgradeWindow:"02:00-04:00",autoRollback:!0});if(c)return e.jsx("div",{className:"flex justify-center p-12",children:e.jsx(z,{className:"animate-spin"})});const o=()=>{t(!1)};return e.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-display font-bold text-slate-900 dark:text-slate-100",children:s("devices.firmware")}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:s("devices.firmwareSubtitle")})]}),e.jsxs("button",{className:"btn-primary flex items-center gap-2",children:[e.jsx(ze,{className:"w-4 h-4"}),s("mdm.addVersion")]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"glass-panel p-4",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 bg-blue-500/10 rounded-lg",children:e.jsx(Y,{className:"w-5 h-5 text-blue-500"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:s("mdm.firmware.canaryRelease")}),e.jsx("p",{className:"text-xs text-slate-500",children:s("mdm.firmware.canaryDesc")})]})]})}),e.jsx("div",{className:"glass-panel p-4",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 bg-purple-500/10 rounded-lg",children:e.jsx(re,{className:"w-5 h-5 text-purple-500"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:s("mdm.firmware.silentUpgrade")}),e.jsx("p",{className:"text-xs text-slate-500",children:s("mdm.firmware.silentDesc")})]})]})}),e.jsx("div",{className:"glass-panel p-4",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 bg-green-500/10 rounded-lg",children:e.jsx(ge,{className:"w-5 h-5 text-green-500"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:s("mdm.firmware.autoRollback")}),e.jsx("p",{className:"text-xs text-slate-500",children:s("mdm.firmware.rollbackDesc")})]})]})})]}),i&&i.length>0&&e.jsxs("div",{className:"glass-panel p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Z,{className:"w-5 h-5 text-blue-500"}),s("mdm.firmware.activeCanary")]}),e.jsx("div",{className:"space-y-3",children:i.map(r=>e.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-dark-700 rounded-xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium",children:r.firmwareVersion}),e.jsx("span",{className:`badge ${r.status==="IN_PROGRESS"?"badge-success":"badge-warning"}`,children:r.status})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-slate-500",children:[e.jsxs("span",{children:[r.currentPercentage,"% ",s("mdm.firmware.deployed")]}),e.jsxs("span",{children:[s("mdm.firmware.healthScore"),": ",r.healthCriteria.minHealthScore,"/100"]})]}),e.jsx("div",{className:"h-2 bg-slate-200 dark:bg-dark-600 rounded-full mt-2 overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500",style:{width:`${r.currentPercentage}%`}})})]},r.deploymentId))})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n==null?void 0:n.map(r=>{var j;return e.jsxs("div",{className:"glass-panel p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-500/10 rounded-lg text-blue-500",children:e.jsx(fe,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-slate-900 dark:text-slate-100",children:r.version}),e.jsx("p",{className:"text-xs text-slate-500",children:r.releaseDate})]})]}),e.jsx("span",{className:`badge ${r.type==="STABLE"?"badge-success":"badge-warning"}`,children:r.type})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-500",children:s("mdm.fileSize")}),e.jsx("span",{className:"font-medium",children:r.size})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-500",children:s("mdm.checksum")}),e.jsxs("span",{className:"font-mono text-xs",children:[(j=r.checksum)==null?void 0:j.slice(0,12),"..."]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"flex-1 btn-secondary text-sm py-1.5",children:s("common.details")}),e.jsxs("button",{className:"flex-1 btn-primary text-sm py-1.5 flex items-center justify-center gap-2",onClick:()=>{d(r),t(!0)},children:[e.jsx(Y,{className:"w-3.5 h-3.5"}),s("mdm.firmware.startCanary")]})]})]},r.version)})}),e.jsx(ue,{children:x&&e.jsxs(e.Fragment,{children:[e.jsx(f.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 z-40",onClick:()=>t(!1)}),e.jsx(f.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"fixed inset-0 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-dark-800 rounded-2xl p-6 max-w-lg w-full shadow-2xl",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[e.jsx(Y,{className:"w-5 h-5 text-blue-500"}),s("mdm.firmware.canaryConfig")]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:s("mdm.firmware.targetVersion")}),e.jsx("input",{type:"text",value:(g==null?void 0:g.version)||"",disabled:!0,className:"input-field mt-1 bg-slate-100 dark:bg-dark-700"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:s("mdm.firmware.canaryPercentage")}),e.jsx("input",{type:"range",min:"1",max:"100",value:m.targetPercentage,onChange:r=>b({...m,targetPercentage:+r.target.value}),className:"w-full mt-1"}),e.jsxs("p",{className:"text-sm text-slate-500",children:[m.targetPercentage,"% ",s("mdm.firmware.ofDevices")]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:s("mdm.firmware.upgradeWindow")}),e.jsx("input",{type:"text",value:m.upgradeWindow,onChange:r=>b({...m,upgradeWindow:r.target.value}),className:"input-field mt-1",placeholder:"02:00-04:00"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:m.silentUpgrade,onChange:r=>b({...m,silentUpgrade:r.target.checked})}),e.jsx("span",{className:"text-sm",children:s("mdm.firmware.silentUpgrade")})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:m.autoRollback,onChange:r=>b({...m,autoRollback:r.target.checked})}),e.jsx("span",{className:"text-sm",children:s("mdm.firmware.autoRollback")})]})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{className:"flex-1 btn-secondary",onClick:()=>t(!1),children:s("common.cancel")}),e.jsx("button",{className:"flex-1 btn-primary",onClick:o,children:s("mdm.firmware.startDeployment")})]})]})})]})})]})},Ks=()=>{const{t:s}=D(),n=Ns(),[c,i]=u.useState(""),[x,t]=u.useState(!1),[g,d]=u.useState({heartbeatInterval:30,logLevel:"INFO",blacklistSyncInterval:60}),m=async o=>{if(c)try{await n.mutateAsync({id:c,command:o})}catch(r){console.error(r)}},b=()=>{t(!1)};return e.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-display font-bold text-slate-900 dark:text-slate-100",children:s("devices.remote")}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:s("devices.remoteSubtitle")})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 glass-panel p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-6 flex items-center gap-2",children:[e.jsx(ae,{className:"w-5 h-5 text-primary-500"}),s("mdm.sendCommand")]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:s("mdm.deviceId")}),e.jsx("input",{type:"text",value:c,onChange:o=>i(o.target.value),placeholder:"e.g. TERM-1001",className:"input-field max-w-md"})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[{cmd:"REBOOT",label:s("mdm.cmdRestart"),icon:ge,color:"red"},{cmd:"LOG_TRANSFER",label:s("mdm.cmdCheckHealth"),icon:Ne,color:"blue"},{cmd:"WAKE_UP",label:s("mdm.cmdSyncTime"),icon:le,color:"amber"},{cmd:"CLEAR_CACHE",label:s("mdm.cmdClearCache"),icon:_e,color:"purple"},{cmd:"SCREENSHOT",label:s("mdm.cmdScreenshot"),icon:Ve,color:"cyan"},{cmd:"LOCK_DEVICE",label:s("mdm.cmdLockDevice"),icon:vs,color:"slate"}].map(o=>e.jsxs("button",{disabled:!c||n.isPending,onClick:()=>m(o.cmd),className:"p-4 rounded-xl border border-slate-200 dark:border-dark-600 hover:border-primary-500 dark:hover:border-primary-500 transition-all text-center group disabled:opacity-50",children:[e.jsx("div",{className:`w-10 h-10 mx-auto rounded-lg bg-${o.color}-500/10 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform`,children:e.jsx(o.icon,{className:`w-5 h-5 text-${o.color}-500`})}),e.jsx("span",{className:"font-medium text-sm text-slate-900 dark:text-slate-100",children:o.label})]},o.cmd))}),n.isSuccess&&e.jsx("div",{className:"p-3 bg-green-500/10 border border-green-500/20 rounded-lg text-green-600 text-sm",children:s("common.saveSuccess")})]})]}),e.jsxs("div",{className:"glass-panel p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Ue,{className:"w-5 h-5 text-purple-500"}),s("mdm.remote.hotConfig")]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:s("mdm.remote.heartbeatInterval")}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("input",{type:"number",value:g.heartbeatInterval,onChange:o=>d({...g,heartbeatInterval:+o.target.value}),className:"input-field w-20"}),e.jsx("span",{className:"text-sm text-slate-500",children:s("time.second")})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:s("mdm.remote.logLevel")}),e.jsxs("select",{value:g.logLevel,onChange:o=>d({...g,logLevel:o.target.value}),className:"input-field mt-1",children:[e.jsx("option",{value:"DEBUG",children:"DEBUG"}),e.jsx("option",{value:"INFO",children:"INFO"}),e.jsx("option",{value:"WARN",children:"WARN"}),e.jsx("option",{value:"ERROR",children:"ERROR"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:s("mdm.remote.blacklistSync")}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("input",{type:"number",value:g.blacklistSyncInterval,onChange:o=>d({...g,blacklistSyncInterval:+o.target.value}),className:"input-field w-20"}),e.jsx("span",{className:"text-sm text-slate-500",children:s("time.second")})]})]}),e.jsx("button",{className:"w-full btn-primary mt-4",disabled:!c,onClick:b,children:s("mdm.remote.applyConfig")})]})]})]}),e.jsxs("div",{className:"glass-panel p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(re,{className:"w-5 h-5 text-slate-500"}),s("mdm.commandHistory")]}),e.jsx("div",{className:"text-center py-8 text-slate-500",children:e.jsx("p",{className:"text-sm",children:s("common.comingSoon")})})]})]})},zs=()=>{var x;const{t:s}=D(),{data:n,isLoading:c}=be(!0),{data:i}=Be();return c?e.jsx("div",{className:"flex justify-center p-12",children:e.jsx(z,{className:"animate-spin"})}):e.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-display font-bold text-slate-900 dark:text-slate-100",children:s("devices.maintenance")}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:s("devices.maintenanceSubtitle")})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"glass-panel p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-red-500/10 rounded-lg",children:e.jsx(q,{className:"w-5 h-5 text-red-500"})}),e.jsx("h3",{className:"text-lg font-semibold",children:s("mdm.dashboard.aiPredictions")})]}),e.jsx("div",{className:"space-y-4",children:(x=n==null?void 0:n.atRiskDevices)==null?void 0:x.map(t=>e.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-dark-700/50 rounded-xl border border-slate-200 dark:border-dark-600",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("span",{className:"font-mono text-sm font-bold text-primary-600",children:t.deviceId}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-bold ${t.priority==="CRITICAL"?"bg-red-500 text-white":"bg-orange-500 text-white"}`,children:t.priority})]}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-3",children:t.description}),e.jsxs("div",{className:"flex justify-between items-center text-xs",children:[e.jsxs("span",{className:"text-slate-500",children:[s("mdm.dashboard.confidence"),": ",t.confidence,"%"]}),e.jsxs("span",{className:"font-medium text-red-500",children:[s("mdm.stats.anomalies"),": ",t.estimatedTimeToFailure,"d ",s("time.day")]})]})]},t.predictionId))})]}),e.jsxs("div",{className:"glass-panel p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-amber-500/10 rounded-lg",children:e.jsx(Q,{className:"w-5 h-5 text-amber-500"})}),e.jsx("h3",{className:"text-lg font-semibold",children:s("mdm.dashboard.maintenance")})]}),e.jsx("div",{className:"space-y-4",children:i==null?void 0:i.map(t=>e.jsxs("div",{className:"flex gap-4 p-4 hover:bg-slate-50 dark:hover:bg-dark-700/30 transition-colors rounded-xl",children:[e.jsxs("div",{className:"flex-shrink-0 w-12 text-center",children:[e.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase",children:new Date(t.scheduledDate).toLocaleString("default",{month:"short"})}),e.jsx("p",{className:"text-xl font-bold",children:new Date(t.scheduledDate).getDate()})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold text-sm",children:t.deviceId}),e.jsx("p",{className:"text-xs text-slate-500",children:s(`mdm.maintenanceTypes.${t.maintenanceType}`)}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs",children:[e.jsxs("span",{className:"bg-blue-100 text-blue-700 px-2 py-0.5 rounded",children:["$",t.estimatedCost]}),e.jsx("span",{className:"text-slate-400",children:t.assignedTo||"-"})]})]})]},t.scheduleId))})]})]})]})},_s=()=>{var T;const{t:s}=D(),{data:n,isLoading:c}=He({}),[i,x]=u.useState("ALL"),[t,g]=u.useState(""),[d,m]=u.useState(!1),[b,o]=u.useState({startTime:"",endTime:"",levels:["ERROR","WARN","INFO"],maxLines:1e3}),r=["ALL","ERROR","WARN","INFO","DEBUG"],j=((T=n==null?void 0:n.data)==null?void 0:T.filter(h=>i==="ALL"||h.level===i))||[],k=()=>{m(!1)};return c?e.jsx("div",{className:"flex justify-center p-12",children:e.jsx(z,{className:"animate-spin"})}):e.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-display font-bold text-slate-900 dark:text-slate-100",children:s("devices.logs")}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:s("devices.logsSubtitle")})]}),e.jsxs("button",{className:"btn-primary flex items-center gap-2",onClick:()=>m(!0),children:[e.jsx(he,{className:"w-4 h-4"}),s("mdm.logManagement.onDemandFetch")]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:r.map(h=>{var P,S;const A=h==="ALL"?((P=n==null?void 0:n.data)==null?void 0:P.length)||0:((S=n==null?void 0:n.data)==null?void 0:S.filter(W=>W.level===h).length)||0,M={ALL:"bg-blue-500/10 text-blue-600",ERROR:"bg-red-500/10 text-red-600",WARN:"bg-amber-500/10 text-amber-600",INFO:"bg-green-500/10 text-green-600",DEBUG:"bg-slate-500/10 text-slate-600"};return e.jsxs("button",{onClick:()=>x(h),className:`p-4 rounded-xl border-2 transition-all ${i===h?"border-primary-500 bg-primary-50 dark:bg-primary-950/20":"border-transparent bg-white dark:bg-dark-800"}`,children:[e.jsx("div",{className:`text-2xl font-bold ${M[h]}`,children:A}),e.jsx("div",{className:"text-sm text-slate-500",children:h})]},h)})}),e.jsx("div",{className:"glass-panel overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-dark-700/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase",children:s("common.time")}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase",children:s("mdm.deviceId")}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase",children:s("mdm.logManagement.level")}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase",children:s("mdm.logManagement.message")})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-dark-700",children:j.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-4 py-12 text-center",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-16 h-16 bg-slate-100 dark:bg-dark-700 rounded-full flex items-center justify-center mb-4",children:e.jsx(K,{className:"w-8 h-8 text-slate-400"})}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:s("mdm.noLogs")||"暂无日志记录"}),e.jsx("p",{className:"text-sm text-slate-400 dark:text-slate-500 mt-1",children:"请尝试调整筛选条件或时间范围"})]})})}):j.slice(0,50).map((h,A)=>e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-dark-700/30",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-mono text-slate-500",children:new Date(h.timestamp).toLocaleString()}),e.jsx("td",{className:"px-4 py-3 text-sm font-mono text-primary-600",children:h.deviceId}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold ${h.level==="ERROR"?"bg-red-500 text-white":h.level==="WARN"?"bg-amber-500 text-white":h.level==="INFO"?"bg-green-500 text-white":"bg-slate-500 text-white"}`,children:h.level})}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 dark:text-slate-400 max-w-md truncate",children:h.message})]},A))})]})})}),e.jsx(ue,{children:d&&e.jsxs(e.Fragment,{children:[e.jsx(f.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 z-40",onClick:()=>m(!1)}),e.jsx(f.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"fixed inset-0 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-dark-800 rounded-2xl p-6 max-w-lg w-full shadow-2xl",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[e.jsx(he,{className:"w-5 h-5 text-blue-500"}),s("mdm.logManagement.onDemandFetch")]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:s("mdm.deviceId")}),e.jsx("input",{type:"text",value:t,onChange:h=>g(h.target.value),className:"input-field mt-1",placeholder:"TERM-1001"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:s("mdm.logManagement.startTime")}),e.jsx("input",{type:"datetime-local",value:b.startTime,onChange:h=>o({...b,startTime:h.target.value}),className:"input-field mt-1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:s("mdm.logManagement.endTime")}),e.jsx("input",{type:"datetime-local",value:b.endTime,onChange:h=>o({...b,endTime:h.target.value}),className:"input-field mt-1"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:s("mdm.logManagement.maxLines")}),e.jsx("input",{type:"number",value:b.maxLines,onChange:h=>o({...b,maxLines:+h.target.value}),className:"input-field mt-1"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{className:"flex-1 btn-secondary",onClick:()=>m(!1),children:s("common.cancel")}),e.jsx("button",{className:"flex-1 btn-primary",onClick:k,children:s("mdm.logManagement.fetch")})]})]})})]})})]})},oe=[{path:".",labelKey:"devices.dashboard",icon:is},{path:"list",labelKey:"devices.deviceList",icon:pe},{path:"health",labelKey:"devices.health",icon:Z},{path:"firmware",labelKey:"devices.firmware",icon:fe},{path:"remote",labelKey:"devices.remote",icon:le},{path:"logs",labelKey:"devices.logs",icon:ae},{path:"maintenance",labelKey:"devices.maintenance",icon:Q}];function ma(){const{t:s}=D(),n=ks(),c=oe.find(i=>i.path==="."?n.pathname.endsWith("/devices")||n.pathname.endsWith("/devices/"):n.pathname.includes(`/devices/${i.path}`))||oe[0];return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"flex-shrink-0 mx-6 mt-6",children:[e.jsxs("div",{className:"mb-3 flex items-center gap-2 text-sm text-slate-500 dark:text-slate-400",children:[e.jsx("span",{children:s("common.deviceManagement")}),e.jsx(ns,{className:"w-4 h-4"}),e.jsx("span",{className:"text-slate-900 dark:text-slate-100 font-medium",children:s(c.labelKey)})]}),e.jsx("div",{className:"flex items-center gap-1 overflow-x-auto border-b border-slate-200 dark:border-dark-600",children:oe.map(i=>e.jsxs(ws,{to:i.path,end:i.path===".",className:({isActive:x})=>`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors text-sm font-medium whitespace-nowrap ${x?"border-primary-500 text-primary-600 dark:text-primary-400":"border-transparent text-slate-500 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-200"}`,children:[e.jsx(i.icon,{className:"w-4 h-4"}),e.jsx("span",{children:s(i.labelKey)})]},i.path))})]}),e.jsx("main",{className:"flex-1 overflow-auto px-6 pb-6 pt-4",children:e.jsxs(Cs,{children:[e.jsx(F,{index:!0,element:e.jsx(Us,{})}),e.jsx(F,{path:"list",element:e.jsx(Bs,{})}),e.jsx(F,{path:"health",element:e.jsx(Hs,{})}),e.jsx(F,{path:"firmware",element:e.jsx(Gs,{})}),e.jsx(F,{path:"remote",element:e.jsx(Ks,{})}),e.jsx(F,{path:"logs",element:e.jsx(_s,{})}),e.jsx(F,{path:"maintenance",element:e.jsx(zs,{})})]})})]})}export{ma as default};
//# sourceMappingURL=DeviceManagement-Cjae2m--.js.map
