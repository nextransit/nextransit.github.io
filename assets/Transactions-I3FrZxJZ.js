import{c as Se,j as e,f as Ye,s as _e,t as Ke,v as Xe,w as Ze,x as et,y as tt,L as at,n as Q,z as G,m as h,B as st,D as se,R as rt,F as re,e as le,G as lt,q as nt,b as it,H as ve,I as ne,p as ie,J as oe,E as ot,K as dt,C as ct,A as de,X as ce,M as mt,d as xt}from"./index-B-k8u74z.js";import{r as n,a as pt}from"./vendor-xASHc04L.js";import{u as ht}from"./i18n-Skc9GWxP.js";import{f as c,s as Y}from"./index-wC2mo2mS.js";import{C as U}from"./check--9UW1o3s.js";import{S as bt}from"./settings-2-D5Hr6ys2.js";import{C as _}from"./calendar-Cne9qgcG.js";import{W as me}from"./wallet-DlZSz3Dr.js";import{C as Ce,S as Ee}from"./square-DVybm4go.js";import{C as Ae}from"./copy-CIwZdsqq.js";import{M as ut}from"./more-horizontal-C7F76PgB.js";import{P as gt}from"./printer-C_euVxlb.js";import{M as ft}from"./map-pin-TtIsBFl9.js";import{F as yt}from"./file-text-BxNSkgGc.js";import{D as jt}from"./download-DglajPwi.js";import{F as Nt}from"./filter-CQKU46wy.js";import"./ui-BMjqw1mu.js";import"./charts-X6rqVOAO.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=Se("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=Se("FileDown",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);function kt({items:a,renderItem:j,itemHeight:d,className:b="",onEndReached:m,endReachedThreshold:x=5,emptyComponent:u,loadingComponent:N,isLoading:p=!1}){const C=n.useRef(null),[i,g]=n.useState({start:0,end:20}),[O,R]=n.useState(!1);if(n.useEffect(()=>{const o=()=>R(window.innerWidth<640);return o(),window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)},[]),n.useEffect(()=>{const o=C.current;if(!o)return;const f=()=>{const v=o.scrollTop,I=o.clientHeight,z=Math.floor(v/d),E=Math.min(Math.ceil((v+I)/d)+5,a.length);g({start:Math.max(0,z-3),end:E})};return f(),o.addEventListener("scroll",f),()=>o.removeEventListener("scroll",f)},[d,a.length]),n.useEffect(()=>{m&&!p&&i.end>=a.length-x&&m()},[i.end,a.length,m,p,x]),a.length===0&&!p)return e.jsx("div",{className:"flex items-center justify-center min-h-[200px]",children:u||e.jsx("p",{className:"text-slate-400 text-sm",children:"暂无数据"})});if(!O||a.length<20)return e.jsxs("div",{className:`space-y-2 pb-24 ${b}`,children:[a.map((o,f)=>j(o,f)),p&&N]});const s=a.slice(i.start,i.end),$=a.length*d,X=i.start*d;return e.jsxs("div",{ref:C,className:`h-[calc(100vh-300px)] min-h-[400px] overflow-auto ${b}`,children:[e.jsx("div",{style:{height:$,position:"relative"},children:e.jsx("div",{style:{transform:`translateY(${X}px)`},children:s.map((o,f)=>e.jsx("div",{style:{height:d},children:j(o,i.start+f)},i.start+f))})}),p&&e.jsx("div",{className:"py-4 flex justify-center",children:N||e.jsx("div",{className:"w-6 h-6 border-2 border-primary-500 border-t-transparent rounded-full animate-spin"})})]})}const D=()=>window.innerWidth<768,wt=["All Types","PURCHASE","RECHARGE","REFUND","TRANSFER","ADJUSTMENT"],vt=["All Status","COMPLETED","PENDING","PROCESSING","FAILED","CANCELLED"];function Bt(){var we;const{t:a}=ht(),{trackAction:j}=Ye(),[d,b]=n.useState("All Types");n.useEffect(()=>{j({type:"view_page",page:"/transactions",timestamp:Date.now()})},[j]);const[m,x]=n.useState("All Status"),[u,N]=n.useState(""),[p,C]=n.useState(1),[i,g]=n.useState({startDate:c(Y(new Date,7),"yyyy-MM-dd"),endDate:c(new Date,"yyyy-MM-dd")}),[O,R]=n.useState(null),[s,$]=n.useState(null),[X,o]=n.useState(!1),[f,v]=n.useState(!1),[I,z]=n.useState("CSV"),[E,Z]=n.useState(["id","cardId","type","amount","status","timestamp"]),[pe,Re]=n.useState(10),[M,V]=n.useState([]),[Ie,he]=n.useState(null),[be,Me]=n.useState(null),[Pe,B]=n.useState(!1),[L,W]=n.useState(!1),[ee,te]=n.useState(null),$e=()=>{b("All Types"),x("All Status"),g({startDate:c(Y(new Date,7),"yyyy-MM-dd"),endDate:c(new Date,"yyyy-MM-dd")}),N(""),te(null)},[F]=n.useState([{id:"1",terminalId:"TERM-102",message:"失败率异常升高 (15%)",severity:"warning"}]),q={type:d==="All Types"?void 0:d,status:m==="All Status"?void 0:m,search:u||void 0,page:p,limit:pe,startDate:i.startDate,endDate:i.endDate},{data:y,isLoading:ue,isError:Le,error:ge,refetch:fe}=_e(q),{data:Fe}=Ke(i.startDate,i.endDate),{data:ye}=Xe("OPEN",{retry:!1,enabled:!1}),Te=Ze(),He=et(),Ge=tt(),je=async()=>{var t,r;try{const l=await Te.mutateAsync(q),k=window.URL.createObjectURL(l),w=document.createElement("a");w.href=k,w.download=`transactions_${c(new Date,"yyyy-MM-dd")}.csv`,document.body.appendChild(w),w.click(),window.URL.revokeObjectURL(k),document.body.removeChild(w)}catch(l){R(((r=(t=l.response)==null?void 0:t.data)==null?void 0:r.message)||a("transactions.exportError"))}},Ue=async t=>{var r,l;try{await He.mutateAsync(t)}catch(k){R(((l=(r=k.response)==null?void 0:r.data)==null?void 0:l.message)||a("transactions.acknowledgeError"))}},Oe=async t=>{var l,k;const r=window.prompt(a("transactions.enterResolution"));if(r)try{await Ge.mutateAsync({anomalyId:t,resolution:r})}catch(w){R(((k=(l=w.response)==null?void 0:l.data)==null?void 0:k.message)||a("transactions.resolveError"))}},Ne=async t=>{try{await navigator.clipboard.writeText(t),he(t),setTimeout(()=>he(null),2e3)}catch(r){console.error("Failed to copy:",r)}},ze=t=>t.length<=14?t:`${t.slice(0,8)}...${t.slice(-6)}`,Ve=()=>{M.length===A.length?V([]):V(A.map(t=>t.id))},Be=t=>{V(r=>r.includes(t)?r.filter(l=>l!==t):[...r,t])},ke=t=>Math.abs(t)>100,ae=t=>t?t.startsWith("8800")?{icon:e.jsx(ne,{className:"w-3.5 h-3.5"}),label:"Transit",color:"text-primary-500"}:t.startsWith("4")||t.startsWith("5")?{icon:e.jsx(xt,{className:"w-3.5 h-3.5"}),label:"Bank",color:"text-blue-500"}:{icon:e.jsx(ie,{className:"w-3.5 h-3.5"}),label:"Secure",color:"text-accent-500"}:{icon:e.jsx(me,{className:"w-3.5 h-3.5"}),label:"Standard",color:"text-slate-400"},We=t=>{const r=new Date;switch(t){case"peak":g({startDate:c(r,"yyyy-MM-dd"),endDate:c(r,"yyyy-MM-dd")}),N("Peak Hour");break;case"failed24h":x("FAILED"),g({startDate:c(Y(r,1),"yyyy-MM-dd"),endDate:c(r,"yyyy-MM-dd")});break;case"large":N("> 100");break}},A=(y==null?void 0:y.data)||[],T={...{totalTransactions:0,totalAmount:0,successfulTransactions:0,failedTransactions:0,pendingTransactions:0,averageAmount:0,totalRechargeAmount:0,totalPurchaseAmount:0,totalRefundAmount:0},...Fe||{}},H=t=>{const r=Number(t);return isNaN(r)?0:r},P=Array.isArray(ye)?ye:[],J=y!=null&&y.total&&q.limit?Math.ceil(y.total/q.limit):1;return ue?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(at,{className:"w-8 h-8 animate-spin text-primary-600"})}):Le?e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 gap-4",children:[e.jsx(Q,{className:"w-12 h-12 text-error"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:ge instanceof Error?ge.message:a("common.loadError")}),e.jsxs("button",{onClick:()=>fe(),className:"btn-secondary flex items-center gap-2",children:[e.jsx(G,{className:"w-4 h-4"}),a("common.retry")]})]}):e.jsxs(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"space-y-6","data-help":"transaction-table",children:[O&&e.jsxs("div",{className:"p-4 bg-error/10 border border-error/20 rounded-lg flex items-center gap-3 text-error",children:[e.jsx(Q,{className:"w-5 h-5"}),e.jsx("span",{children:O}),e.jsx("button",{onClick:()=>R(null),className:"ml-auto text-sm hover:underline",children:a("common.dismiss")})]}),F.length>0&&e.jsxs(h.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mx-4 sm:mx-0 p-2 sm:p-4 bg-amber-500/10 border border-amber-500/20 rounded-xl flex items-center gap-2 sm:gap-4 overflow-hidden",children:[e.jsx("div",{className:"bg-amber-500/20 p-1.5 rounded-lg flex-shrink-0",children:e.jsx(st,{className:"w-4 h-4 text-amber-500 animate-pulse"})}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsxs("div",{className:"whitespace-nowrap animate-marquee md:animate-none flex items-center gap-4",children:[e.jsxs("p",{className:"text-xs md:text-sm font-semibold text-amber-600 dark:text-amber-400",children:[a("transactions.alerts.terminalHealth"),": ",F[0].terminalId," - ",F[0].message]}),e.jsxs("p",{className:"md:hidden text-xs font-semibold text-amber-600 dark:text-amber-400",children:[a("transactions.alerts.terminalHealth"),": ",F[0].terminalId," - ",F[0].message]})]})}),e.jsx("button",{className:"flex-shrink-0 text-[10px] md:text-xs font-bold text-amber-600 underline hover:no-underline whitespace-nowrap",children:a("transactions.alerts.viewDetail")})]}),P.length>0&&e.jsxs("div",{className:"p-4 bg-warning/10 border border-warning/20 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(se,{className:"w-5 h-5 text-warning"}),e.jsx("span",{className:"font-semibold",children:a("transactions.anomaliesDetected",{count:P.length})})]}),e.jsx("div",{className:"space-y-2",children:P.slice(0,3).map(t=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-white dark:bg-dark-800 rounded",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:t.title}),e.jsx("span",{className:"text-sm text-slate-500 ml-2",children:t.description})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>Ue(t.id),className:"px-2 py-1 text-xs rounded bg-slate-100 hover:bg-slate-200",children:a("transactions.acknowledge")}),e.jsx("button",{onClick:()=>Oe(t.id),className:"px-2 py-1 text-xs rounded bg-success/10 text-success hover:bg-success/20",children:a("transactions.resolve")})]})]},t.id))})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4 px-4 md:px-0",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl lg:text-2xl font-display font-bold text-slate-900 dark:text-slate-100",children:a("transactions.title")}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-0.5 text-xs lg:text-base",children:a("transactions.subtitle")})]}),e.jsxs("div",{className:"flex items-center gap-1.5 md:gap-3","data-help":"export-function",children:[e.jsxs("button",{onClick:()=>fe(),className:"p-2 md:btn-secondary flex items-center gap-2 text-slate-600 dark:text-slate-400 md:text-sm hover:bg-slate-100 dark:hover:bg-dark-700 rounded-lg transition-colors border border-slate-200 dark:border-dark-600 md:border-none",title:a("transactions.sync"),children:[e.jsx(rt,{className:"w-5 h-5 md:w-4 md:h-4 text-primary-500 md:text-inherit"}),e.jsx("span",{className:"hidden md:inline",children:a("transactions.sync")})]}),e.jsxs("button",{onClick:()=>v(!0),className:"p-2 md:btn-primary flex items-center gap-2 bg-primary-500/10 md:bg-primary-500 text-primary-600 md:text-white rounded-lg transition-all md:text-sm border border-primary-500/20 md:border-none",title:a("transactions.exportAction"),children:[e.jsx(xe,{className:"w-5 h-5 md:w-4 md:h-4"}),e.jsx("span",{className:"hidden md:inline",children:a("transactions.exportAction")})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 lg:gap-4 px-4 md:px-0",children:[e.jsx(K,{title:a("transactions.stats.todayTurnover"),value:`¥${H(T.totalAmount).toLocaleString()}`,trend:"+12.5%",icon:e.jsx(re,{className:"w-5 h-5"}),color:"blue",className:"w-full min-w-0"}),e.jsx(K,{title:a("transactions.stats.failedAlert"),value:P.length.toString(),trend:P.length>0?a("common.urgent"):a("common.normal"),icon:e.jsx(se,{className:"w-5 h-5"}),color:"amber",isAnomaly:P.length>0,className:"w-full min-w-0"}),e.jsx(K,{title:a("transactions.stats.settlementRate"),value:`${T.totalTransactions>0?Math.round(T.successfulTransactions/T.totalTransactions*100):100}%`,icon:e.jsx(De,{className:"w-5 h-5"}),color:"emerald",className:"w-full min-w-0 hidden lg:flex"}),e.jsx(K,{title:a("transactions.stats.unprocessed"),value:T.pendingTransactions.toString(),icon:e.jsx(le,{className:"w-5 h-5"}),color:"indigo",className:"w-full min-w-0 hidden lg:flex"})]}),e.jsxs("div",{className:"flex items-center gap-3 mb-3 overflow-x-auto hide-scrollbar py-1 px-4 md:px-0 snap-x snap-mandatory",children:[e.jsxs("span",{className:"text-[10px] md:text-xs text-slate-400 flex items-center gap-1.5 flex-shrink-0 uppercase font-bold tracking-tight",children:[e.jsx(lt,{className:"w-3 h-3 text-primary-500"}),a("transactions.presets.title"),":"]}),[{id:"peakHour",label:a("transactions.presets.peakHour"),icon:e.jsx(le,{className:"w-3 h-3"})},{id:"failed24h",label:a("transactions.presets.failed24h"),icon:e.jsx(se,{className:"w-3 h-3"})},{id:"largeAmount",label:a("transactions.presets.largeAmount"),icon:e.jsx(nt,{className:"w-3 h-3"})}].map(t=>e.jsxs(h.button,{whileTap:{scale:.95},onClick:()=>{ee===t.id?(te(null),b("All Types"),x("All Status")):(te(t.id),We(t.id==="peakHour"?"peak":t.id==="largeAmount"?"large":t.id))},className:`flex-shrink-0 flex items-center gap-2 px-4 py-2 text-xs font-semibold rounded-full border transition-all shadow-sm whitespace-nowrap snap-start ${ee===t.id?"bg-primary-600 border-primary-600 text-white ring-2 ring-primary-500/20":"bg-white dark:bg-dark-800 text-slate-600 dark:text-slate-300 border-slate-200 dark:border-dark-600 hover:border-primary-500/50 hover:text-primary-500"}`,children:[ee===t.id?e.jsx(U,{className:"w-3 h-3 animate-in fade-in zoom-in duration-300"}):t.icon,t.label]},t.id))]}),e.jsxs("div",{className:"glass-panel p-2 md:p-5 sticky top-16 z-30 shadow-md mx-4 md:mx-0","data-help":"transaction-filters",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:`transition-all duration-300 ease-in-out flex-1 relative ${D()&&!L&&u===""?"max-w-[44px]":"max-w-full"}`,children:[e.jsx(it,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 cursor-pointer z-10",onClick:()=>D()&&W(!L)}),e.jsx("input",{placeholder:D()&&!L?"":a("transactions.searchPlaceholder"),value:u,onFocus:()=>D()&&W(!0),onBlur:()=>!u&&D()&&W(!1),onChange:t=>N(t.target.value),className:`w-full pl-9 pr-4 py-2.5 bg-slate-50 dark:bg-dark-900 border border-slate-200 dark:border-dark-600 rounded-xl text-sm text-slate-900 dark:text-slate-200 placeholder-slate-400 focus:outline-none focus:border-primary-500/50 focus:ring-2 focus:ring-primary-500/10 transition-all ${D()&&!L&&u===""?"opacity-0":"opacity-100"}`}),D()&&!L&&u===""&&e.jsx("button",{onClick:()=>W(!0),className:"absolute inset-0 z-0 bg-transparent"})]}),e.jsxs("button",{onClick:()=>B(!0),className:"flex-shrink-0 w-11 h-11 flex items-center justify-center bg-white dark:bg-dark-900 border border-slate-200 dark:border-dark-600 rounded-xl text-slate-600 dark:text-slate-400 hover:text-primary-500 hover:border-primary-500/50 hover:bg-primary-50 dark:hover:bg-primary-900/20 transition-all relative shadow-sm",title:a("common.filter"),children:[e.jsx(bt,{className:"w-5 h-5"}),(d!=="All Types"||m!=="All Status")&&e.jsx("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-primary-500 text-white text-[10px] flex items-center justify-center rounded-full border-2 border-white dark:border-slate-800 font-bold",children:"·"})]})]}),e.jsxs("div",{className:"hidden md:flex items-center gap-3 mt-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("select",{value:d,onChange:t=>b(t.target.value),className:"appearance-none bg-white dark:bg-dark-800 border border-slate-200 dark:border-dark-600 rounded-lg pl-4 pr-10 py-2 text-sm",children:["All Types","PURCHASE","RECHARGE","REFUND"].map(t=>e.jsx("option",{value:t,children:a(`transactions.types.${t}`)},t))}),e.jsx(ve,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 pointer-events-none"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("select",{value:m,onChange:t=>x(t.target.value),className:"appearance-none bg-white dark:bg-dark-800 border border-slate-200 dark:border-dark-600 rounded-lg pl-4 pr-10 py-2 text-sm",children:["All Status","COMPLETED","PENDING","FAILED","CANCELLED"].map(t=>e.jsx("option",{value:t,children:a(`transactions.status.${t}`)},t))}),e.jsx(ve,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 pointer-events-none"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(_,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx("input",{type:"date",value:i.startDate,onChange:t=>g({...i,startDate:t.target.value}),className:"pl-10 pr-4 py-2 bg-white dark:bg-dark-800 border border-slate-200 dark:border-dark-600 rounded-lg text-sm"})]}),e.jsx("span",{className:"text-slate-400",children:"-"}),e.jsxs("div",{className:"relative",children:[e.jsx(_,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx("input",{type:"date",value:i.endDate,onChange:t=>g({...i,endDate:t.target.value}),className:"pl-10 pr-4 py-2 bg-white dark:bg-dark-800 border border-slate-200 dark:border-dark-600 rounded-lg text-sm"})]})]}),(d!=="All Types"||m!=="All Status")&&e.jsx("button",{onClick:$e,className:"btn-ghost text-sm text-slate-500 hover:text-primary-500",children:a("common.clearFilters")})]})]}),e.jsxs("div",{className:"mx-2 md:mx-0",children:[e.jsx("div",{className:"md:hidden",children:e.jsx(kt,{items:A,itemHeight:68,isLoading:ue,onEndReached:()=>{p<J&&C(t=>t+1)},emptyComponent:e.jsxs("div",{className:"text-center py-12 bg-slate-50 dark:bg-dark-800/50 rounded-2xl border-2 border-dashed border-slate-200 dark:border-dark-700",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-slate-100 dark:bg-dark-700 flex items-center justify-center",children:e.jsx(re,{className:"w-8 h-8 text-slate-400"})}),e.jsx("p",{className:"text-slate-500 text-sm",children:a("transactions.noData")})]}),renderItem:t=>{const r=`${a(`transactions.types.${t.type}`)}，${a("transactions.table.cardId")}: ${(t.cardNumber||t.cardId||"****").replace(/.(?=.{4})/g,"*")}，${a("transactions.table.amount")}: ${t.type==="RECHARGE"||t.type==="REFUND"?"+":"-"}${t.amount}，${a(`transactions.status.${t.status}`)}`,l=t.type==="RECHARGE"||t.type==="REFUND",k=(t.cardNumber||t.cardId||"****").slice(-4),w={COMPLETED:"text-emerald-600 dark:text-emerald-400",FAILED:"text-rose-600 dark:text-rose-400",CANCELLED:"text-slate-500",PENDING:"text-amber-600 dark:text-amber-400",PROCESSING:"text-amber-600 dark:text-amber-400"},qe={COMPLETED:"bg-emerald-500",FAILED:"bg-rose-500",CANCELLED:"bg-slate-400",PENDING:"bg-amber-500 animate-pulse",PROCESSING:"bg-amber-500 animate-pulse"},Je=t.type==="PURCHASE"?e.jsx(ne,{className:"w-4 h-4"}):t.type==="RECHARGE"?e.jsx(me,{className:"w-4 h-4"}):t.type==="REFUND"?e.jsx(G,{className:"w-4 h-4"}):e.jsx(re,{className:"w-4 h-4"}),Qe=t.type==="PURCHASE"?"bg-slate-100 dark:bg-slate-800 text-slate-500":t.type==="RECHARGE"?"bg-emerald-50 dark:bg-emerald-900/20 text-emerald-500":"bg-amber-50 dark:bg-amber-900/20 text-amber-500";return e.jsxs(h.div,{role:"button",tabIndex:0,"aria-label":r,whileTap:{scale:.98},onClick:()=>{$(t),o(!0)},className:"w-full flex items-center gap-3 px-3 py-2.5 rounded-lg border border-slate-100 dark:border-dark-700 bg-white dark:bg-dark-800 mb-1.5 cursor-pointer active:bg-slate-50 dark:active:bg-dark-700 transition-colors",children:[e.jsxs("div",{className:"relative shrink-0",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${Qe}`,children:Je}),e.jsx("span",{className:`absolute -bottom-0.5 -right-0.5 w-3 h-3 rounded-full border-2 border-white dark:border-dark-800 ${qe[t.status]||"bg-slate-400"}`})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:"text-sm font-semibold text-slate-900 dark:text-slate-100 truncate",children:["*",k]}),e.jsx("p",{className:"text-[10px] text-slate-400 font-mono tabular-nums mt-0.5",children:c(new Date(t.createdAt),"HH:mm")})]}),e.jsxs("div",{className:"text-right shrink-0",children:[e.jsxs("p",{className:`text-sm font-bold font-mono tabular-nums ${l?"text-emerald-600":"text-slate-900 dark:text-white"}`,children:[l?"+":"-","¥",H(t.amount).toFixed(2)]}),e.jsx("p",{className:`text-[10px] font-medium mt-0.5 ${w[t.status]||"text-slate-500"}`,children:a(`transactions.status.${t.status}`)})]})]})}})}),e.jsxs("div",{className:"glass-panel overflow-hidden hidden md:block",children:[M.length>0&&e.jsxs("div",{className:"px-4 py-3 bg-primary-50 dark:bg-primary-900/20 border-b border-primary-200 dark:border-primary-800 flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-primary-700 dark:text-primary-300",children:a("transactions.batchSelected",{count:M.length})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>je(),className:"px-3 py-1.5 text-xs font-medium bg-primary-100 dark:bg-primary-800 text-primary-700 dark:text-primary-200 rounded-lg hover:bg-primary-200 dark:hover:bg-primary-700 transition-colors flex items-center gap-1",children:[e.jsx(xe,{className:"w-3.5 h-3.5"}),a("transactions.batchExport")]}),e.jsxs("button",{onClick:()=>oe(a("common.comingSoon"),a("transactions.markSuspiciousComingSoon")),className:"px-3 py-1.5 text-xs font-medium bg-warning/10 text-warning rounded-lg hover:bg-warning/20 transition-colors flex items-center gap-1",children:[e.jsx(ie,{className:"w-3.5 h-3.5"}),a("transactions.markSuspicious")]}),e.jsx("button",{onClick:()=>V([]),className:"px-3 py-1.5 text-xs font-medium text-slate-500 hover:text-slate-700 transition-colors",children:a("common.cancel")})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-slate-200 dark:border-dark-600",children:[e.jsx("th",{className:"table-header w-10 text-center",children:e.jsx("button",{onClick:Ve,className:"min-h-[44px] min-w-[44px] flex items-center justify-center hover:bg-slate-100 dark:hover:bg-dark-700 rounded transition-colors touch-manipulation","aria-label":a("common.selectAll"),children:M.length===A.length&&A.length>0?e.jsx(Ce,{className:"w-4 h-4 text-primary-500"}):e.jsx(Ee,{className:"w-4 h-4 text-slate-400"})})}),e.jsx("th",{className:"table-header",children:a("transactions.table.transactionId")}),e.jsx("th",{className:"table-header",children:a("transactions.table.cardId")}),e.jsx("th",{className:"table-header",children:a("transactions.table.type")}),e.jsx("th",{className:"table-header",children:a("transactions.table.amount")}),e.jsx("th",{className:"table-header",children:a("transactions.table.terminal")}),e.jsx("th",{className:"table-header",children:a("transactions.table.status")}),e.jsx("th",{className:"table-header",children:a("transactions.table.reconciliation")}),e.jsx("th",{className:"table-header",children:a("transactions.table.timestamp")}),e.jsx("th",{className:"table-header",children:a("transactions.table.actions")})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 dark:divide-dark-600",children:A.map((t,r)=>e.jsxs(h.tr,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:r*.05},className:`group transition-all duration-200 cursor-pointer border-l-4 ${M.includes(t.id)?"bg-primary-50/50 dark:bg-primary-900/10 border-primary-500":t.status==="FAILED"?"bg-rose-50/30 dark:bg-rose-900/10 border-rose-400 hover:bg-rose-50/50":r%2===0?"bg-slate-50/50 dark:bg-dark-700/20 border-transparent hover:bg-slate-100/50":"bg-white dark:bg-dark-800 border-transparent hover:bg-slate-100/50"}`,onClick:()=>{$(t),o(!0)},children:[e.jsx("td",{className:"px-6 py-6 whitespace-nowrap text-sm text-center",children:e.jsx("button",{onClick:l=>{l.stopPropagation(),Be(t.id)},className:"min-h-[44px] min-w-[44px] flex items-center justify-center hover:bg-slate-100 dark:hover:bg-dark-700 rounded transition-colors touch-manipulation","aria-label":a("common.select"),children:M.includes(t.id)?e.jsx(Ce,{className:"w-4 h-4 text-primary-500"}):e.jsx(Ee,{className:"w-4 h-4 text-slate-400"})})}),e.jsx("td",{className:"table-cell",children:e.jsxs("div",{className:"flex items-center gap-1.5 group",children:[e.jsx("span",{className:"font-mono text-sm text-primary-600 dark:text-primary-400",title:t.id,children:ze(t.id)}),e.jsxs("button",{onClick:l=>{l.stopPropagation(),Ne(t.id)},className:"opacity-0 group-hover:opacity-100 min-h-[44px] min-w-[44px] flex items-center justify-center hover:bg-slate-100 dark:hover:bg-dark-700 rounded transition-all touch-manipulation",title:a("transactions.copyId"),"aria-label":a("transactions.copyId"),children:["                        ",Ie===t.id?e.jsx(U,{className:"w-3.5 h-3.5 text-success"}):e.jsx(Ae,{className:"w-3.5 h-3.5 text-slate-400"})]})]})}),e.jsx("td",{className:"px-6 py-6 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("div",{className:`p-1.5 rounded-lg bg-slate-100 dark:bg-dark-900 ${ae(t.cardNumber).color}`,children:ae(t.cardNumber).icon}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-mono text-sm font-semibold tracking-wider text-slate-700 dark:text-slate-200",children:t.cardNumber||t.cardId}),e.jsxs("span",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-tighter",children:[ae(t.cardNumber).label," Card"]})]})]})}),e.jsx("td",{className:"table-cell",children:e.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2 py-0.5 rounded-md text-sm font-medium ${t.type==="PURCHASE"?"bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300":t.type==="RECHARGE"?"bg-success/10 text-success":"bg-warning/10 text-warning"}`,children:[t.type==="PURCHASE"&&e.jsx(ne,{className:"w-4 h-4"}),t.type==="RECHARGE"&&e.jsx(me,{className:"w-4 h-4"}),t.type==="REFUND"&&e.jsx(G,{className:"w-4 h-4"}),a(`transactions.types.${t.type}`)]})}),e.jsx("td",{className:"table-cell",children:e.jsxs("span",{className:`inline-flex items-center gap-1 font-mono text-base font-bold px-2 py-0.5 rounded ${t.type==="RECHARGE"||t.type==="REFUND"?ke(t.amount)?"bg-success/15 text-success":"text-success":ke(t.amount)?"bg-error/15 text-error":"text-error"}`,children:[t.type==="RECHARGE"||t.type==="REFUND"?"+":"-",e.jsx("span",{className:"text-xs opacity-60",children:"¥"}),H(t.amount).toFixed(2)]})}),e.jsx("td",{className:"table-cell",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm text-slate-700 dark:text-slate-300",children:t.terminalLocation||t.terminalName||a("transactions.unknownStation")}),e.jsx("span",{className:"text-xs font-mono text-slate-400 dark:text-slate-500",children:t.terminalId})]})}),e.jsx("td",{className:"table-cell",children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsxs("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold border ${t.status==="COMPLETED"?"bg-success/15 text-success border-success/30":t.status==="PENDING"||t.status==="PROCESSING"?"bg-warning/15 text-warning border-warning/30 animate-pulse":t.status==="CANCELLED"?"bg-slate-200 dark:bg-slate-700 text-slate-500 border-slate-300":"bg-error/15 text-error border-error/30"}`,children:[e.jsx("span",{className:`w-1.5 h-1.5 rounded-full mr-1.5 ${t.status==="COMPLETED"?"bg-success animate-pulse":t.status==="PENDING"||t.status==="PROCESSING"?"bg-warning animate-bounce":t.status==="CANCELLED"?"bg-slate-400":"bg-error animate-ping"}`}),a(`transactions.status.${t.status}`)]}),t.status==="FAILED"&&e.jsxs("div",{className:"relative group",children:[e.jsx(ie,{className:"w-4 h-4 text-error animate-pulse cursor-help"}),e.jsx("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-3 py-1.5 bg-slate-900 text-white text-xs rounded-lg opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-10",children:t.failureReason||a("transactions.errors.unknown")})]})]})}),e.jsx("td",{className:"table-cell",children:t.status==="COMPLETED"?e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs text-slate-500",children:[e.jsx(De,{className:"w-3.5 h-3.5 text-success"}),a("transactions.reconciliation.settled")]}):t.status==="PENDING"?e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs text-warning",children:[e.jsx(le,{className:"w-3.5 h-3.5"}),a("transactions.reconciliationStatus.pending")]}):e.jsx("span",{className:"text-xs text-slate-400",children:"-"})}),e.jsx("td",{className:"table-cell text-slate-500 dark:text-slate-400 text-sm",children:new Date(t.createdAt).toLocaleString()}),e.jsx("td",{className:"table-cell",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{className:"p-1.5 text-slate-400 hover:text-primary-500 hover:bg-primary-500/10 rounded-lg transition-colors",title:a("common.details"),onClick:l=>{l.stopPropagation(),$(t),o(!0)},children:e.jsx(ot,{className:"w-4 h-4"})}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:l=>{l.stopPropagation(),Me(be===t.id?null:t.id)},className:"min-h-[44px] min-w-[44px] flex items-center justify-center text-slate-400 hover:text-slate-600 hover:bg-slate-100 dark:hover:bg-dark-700 rounded-lg transition-colors touch-manipulation","aria-label":a("common.moreActions"),children:e.jsx(ut,{className:"w-4 h-4"})}),"                        ",be===t.id&&e.jsxs("div",{className:"absolute right-0 top-full mt-1 w-36 bg-white dark:bg-dark-800 rounded-lg shadow-xl border border-slate-200 dark:border-dark-600 py-1 z-20",onClick:l=>l.stopPropagation(),children:[t.type==="RECHARGE"&&t.status==="COMPLETED"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"w-full px-3 py-2 text-left text-sm text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-dark-700 flex items-center gap-2",children:[e.jsx(gt,{className:"w-4 h-4"}),a("transactions.printReceipt")]}),e.jsxs("button",{className:"w-full px-3 py-2 text-left text-sm text-warning hover:bg-warning/10 flex items-center gap-2",children:[e.jsx(G,{className:"w-4 h-4"}),a("transactions.actions.reverse")]})]}),t.type==="PURCHASE"&&e.jsxs("button",{className:"w-full px-3 py-2 text-left text-sm text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-dark-700 flex items-center gap-2",children:[e.jsx(ft,{className:"w-4 h-4"}),a("transactions.viewTrail")]}),t.status==="FAILED"&&e.jsxs("button",{className:"w-full px-3 py-2 text-left text-sm text-error hover:bg-error/10 flex items-center gap-2",children:[e.jsx(Q,{className:"w-4 h-4"}),a("transactions.viewError")]}),e.jsxs("button",{className:"w-full px-3 py-2 text-left text-sm text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-dark-700 flex items-center gap-2",onClick:()=>Ne(t.id),children:[e.jsx(Ae,{className:"w-4 h-4"}),a("transactions.copyId")]})]})]})]})})]},t.id))})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3 px-4 sm:px-6 py-4 border-t border-slate-200 dark:border-dark-600",children:[e.jsx("p",{className:"text-sm text-slate-400",children:a("transactions.showing",{count:A.length,total:(y==null?void 0:y.total)||0})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("select",{value:pe,onChange:t=>{Re(Number(t.target.value)),C(1)},className:"px-3 py-2 text-sm bg-slate-100 dark:bg-dark-700 border border-slate-200 dark:border-dark-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",children:[10,30,100].map(t=>e.jsx("option",{value:t,children:a("common.showEntries",{count:t})},t))}),e.jsx("button",{onClick:()=>C(t=>Math.max(1,t-1)),disabled:p===1,className:"p-2 hover:bg-slate-100 dark:hover:bg-dark-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(dt,{className:"w-5 h-5 text-slate-400"})}),e.jsxs("span",{className:"px-4 py-2 bg-primary-500/20 text-primary-400 rounded-lg text-sm font-medium",children:[p," / ",J]}),e.jsx("button",{onClick:()=>C(t=>Math.min(J,t+1)),disabled:p===J,className:"p-2 hover:bg-slate-100 dark:hover:bg-dark-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(ct,{className:"w-5 h-5 text-slate-400"})})]})]})]})]}),e.jsx(de,{children:X&&s&&e.jsxs(e.Fragment,{children:[e.jsx(h.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>o(!1),className:"fixed inset-0 bg-black/40 backdrop-blur-sm z-40"}),e.jsx(h.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:25,stiffness:200},className:"fixed right-0 top-0 bottom-0 w-full max-w-md bg-white dark:bg-dark-800 shadow-2xl z-50 overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsx("h2",{className:"text-xl font-display font-bold text-slate-900 dark:text-slate-100",children:a("transactions.details.title")}),e.jsx("button",{onClick:()=>o(!1),className:"p-2 hover:bg-slate-100 dark:hover:bg-dark-700 rounded-full transition-colors",children:e.jsx(ce,{className:"w-5 h-5 text-slate-400"})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"p-6 bg-slate-50 dark:bg-dark-900 rounded-2xl border border-slate-100 dark:border-dark-600 text-center",children:[e.jsx("p",{className:"text-sm text-slate-500 mb-1",children:a(`transactions.types.${s.type}`)}),e.jsxs("p",{className:`text-3xl font-display font-bold ${s.type==="RECHARGE"||s.type==="REFUND"?"text-success":"text-error"}`,children:[s.type==="RECHARGE"||s.type==="REFUND"?"+":"-"," ¥",H(s.amount).toFixed(2)]}),e.jsx("p",{className:"mt-2 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-white dark:bg-dark-800 border border-slate-200 dark:border-dark-600",children:a(`transactions.status.${s.status}`)})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:a("transactions.details.basicInfo")}),e.jsx(S,{label:a("transactions.table.transactionId"),value:s.id,mono:!0}),e.jsx(S,{label:a("transactions.table.cardId"),value:s.cardNumber||s.cardId,mono:!0}),e.jsx(S,{label:a("transactions.table.timestamp"),value:new Date(s.createdAt).toLocaleString()}),e.jsx(S,{label:a("transactions.table.balance"),value:`¥${H(s.balance).toLocaleString()}`,mono:!0})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:a("transactions.details.operationInfo")}),e.jsx(S,{label:a("transactions.table.terminal"),value:(s==null?void 0:s.terminalName)||(s==null?void 0:s.terminalId)}),e.jsx(S,{label:a("transactions.details.tacCode"),value:"AABB-CCDD-EEFF-1122",mono:!0}),e.jsx(S,{label:a("transactions.details.settlementCycle"),value:s!=null&&s.createdAt?c(new Date(s.createdAt),"yyyyMMdd"):""})]}),(s==null?void 0:s.status)==="FAILED"&&e.jsx("div",{className:"p-4 bg-rose-500/10 border border-rose-500/20 rounded-xl",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Q,{className:"w-5 h-5 text-rose-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-rose-500 mb-1",children:a("transactions.details.failureReason")}),e.jsx("p",{className:"text-sm text-rose-500/80",children:((we=s==null?void 0:s.metadata)==null?void 0:we.errorMessage)||a("transactions.errors.timeout")}),e.jsx("button",{className:"mt-2 text-xs font-bold text-rose-500 underline hover:no-underline",children:a("transactions.details.retryGuide")})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 pt-6",children:[e.jsxs("button",{className:"btn-secondary py-3 flex items-center justify-center gap-2 text-error hover:bg-error/10 border-error/20",onClick:()=>oe(a("transactions.refundInitiated"),a("transactions.refundInProgress")),children:[e.jsx(G,{className:"w-4 h-4"}),a("transactions.actions.refund")]}),e.jsxs("button",{className:"btn-primary py-3 flex items-center justify-center gap-2",onClick:()=>oe(a("transactions.auditPassed"),a("transactions.auditCompleted")),children:[e.jsx(mt,{className:"w-4 h-4"}),a("transactions.actions.audit")]})]})]})]})})]})}),e.jsx(de,{children:f&&e.jsxs(e.Fragment,{children:[e.jsx(h.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>v(!1),className:"fixed inset-0 bg-black/60 backdrop-blur-md z-[60]"}),e.jsx(h.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"fixed left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-lg bg-white dark:bg-dark-800 rounded-3xl shadow-2xl z-[70] overflow-hidden",children:e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-display font-bold text-slate-900 dark:text-slate-100",children:a("transactions.export.title")}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:a("transactions.export.subtitle")})]}),e.jsx("button",{onClick:()=>v(!1),className:"min-h-[44px] min-w-[44px] flex items-center justify-center hover:bg-slate-100 dark:hover:bg-dark-700 rounded-full touch-manipulation","aria-label":a("common.close"),children:e.jsx(ce,{className:"w-5 h-5 text-slate-400"})})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-bold text-slate-400 uppercase tracking-wider",children:a("transactions.export.format")}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:()=>z("CSV"),className:`p-4 rounded-2xl border-2 transition-all flex items-center justify-center gap-3 ${I==="CSV"?"border-primary-500 bg-primary-500/5 text-primary-600":"border-slate-100 dark:border-dark-700"}`,children:[e.jsx(yt,{className:"w-5 h-5"}),e.jsx("span",{className:"font-bold",children:"Excel (CSV)"}),I==="CSV"&&e.jsx(U,{className:"w-4 h-4 ml-auto"})]}),e.jsxs("button",{onClick:()=>z("PDF"),className:`p-4 rounded-2xl border-2 transition-all flex items-center justify-center gap-3 ${I==="PDF"?"border-primary-500 bg-primary-500/5 text-primary-600":"border-slate-100 dark:border-dark-700"}`,children:[e.jsx(xe,{className:"w-5 h-5"}),e.jsx("span",{className:"font-bold",children:"PDF 账单"}),I==="PDF"&&e.jsx(U,{className:"w-4 h-4 ml-auto"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("label",{className:"text-sm font-bold text-slate-400 uppercase tracking-wider",children:a("transactions.export.columns")}),e.jsx("button",{onClick:()=>Z(["id","cardId","type","amount","status","timestamp","terminal","balance"]),className:"text-xs text-primary-600 font-bold hover:underline",children:a("common.selectAll")})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2 p-4 bg-slate-50 dark:bg-dark-900 rounded-2xl border border-slate-100 dark:border-dark-700 font-medium",children:[{id:"id",label:a("transactions.table.transactionId")},{id:"cardId",label:a("transactions.table.cardId")},{id:"type",label:a("transactions.table.type")},{id:"amount",label:a("transactions.table.amount")},{id:"status",label:a("transactions.table.status")},{id:"timestamp",label:a("transactions.table.timestamp")},{id:"terminal",label:a("transactions.table.terminal")},{id:"balance",label:a("transactions.table.balance")}].map(t=>e.jsxs("label",{className:"flex items-center gap-3 p-2 hover:bg-white dark:hover:bg-dark-800 rounded-lg cursor-pointer transition-colors group",children:[e.jsx("div",{className:`w-5 h-5 rounded-md border-2 flex items-center justify-center transition-colors ${E.includes(t.id)?"bg-primary-500 border-primary-500 text-white":"border-slate-300 dark:border-dark-600 bg-transparent"}`,children:E.includes(t.id)&&e.jsx(U,{className:"w-3.5 h-3.5 stroke-[3]"})}),e.jsx("input",{type:"checkbox",className:"hidden",checked:E.includes(t.id),onChange:r=>{r.target.checked?Z([...E,t.id]):Z(E.filter(l=>l!==t.id))}}),e.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-300 group-hover:text-slate-900 dark:group-hover:text-white",children:t.label})]},t.id))})]}),e.jsxs("div",{className:"pt-4 flex gap-4",children:[e.jsx("button",{onClick:()=>v(!1),className:"flex-1 py-4 bg-slate-100 dark:bg-dark-700 text-slate-700 dark:text-slate-300 font-bold rounded-2x hover:bg-slate-200",children:a("common.cancel")}),e.jsxs("button",{className:"flex-1 py-4 bg-primary-600 text-white font-bold rounded-2xl shadow-xl shadow-primary-500/20 hover:bg-primary-700 transition-all flex items-center justify-center gap-2",onClick:()=>{je(),v(!1)},children:[e.jsx(jt,{className:"w-5 h-5"}),a("transactions.confirmExport")]})]})]})]})})]})}),Pe&&typeof document<"u"&&pt.createPortal(e.jsxs(de,{children:[e.jsx(h.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>B(!1),className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[100] sm:hidden"}),e.jsxs(h.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:25,stiffness:200},className:"fixed right-0 top-0 bottom-0 w-[85vw] max-w-sm bg-white dark:bg-dark-800 shadow-2xl z-[110] flex flex-col sm:hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-5 border-b border-slate-100 dark:border-dark-700",children:[e.jsxs("h2",{className:"text-lg font-display font-bold text-slate-900 dark:text-slate-100 flex items-center gap-2",children:[e.jsx(Nt,{className:"w-5 h-5"}),a("transactions.advancedFilter")]}),e.jsx("button",{onClick:()=>B(!1),className:"min-h-[44px] min-w-[44px] flex items-center justify-center hover:bg-slate-100 dark:hover:bg-dark-700 rounded-full touch-manipulation","aria-label":a("common.close"),children:e.jsx(ce,{className:"w-5 h-5 text-slate-400"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-5 space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-bold text-slate-700 dark:text-slate-300",children:a("transactions.table.type")}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:wt.map(t=>e.jsx("button",{onClick:()=>b(t),className:`px-3 py-2 rounded-lg text-sm font-medium border transition-colors ${d===t?"bg-primary-500/10 border-primary-500 text-primary-600":"bg-slate-50 dark:bg-dark-900 border-slate-200 dark:border-dark-700 text-slate-600 dark:text-slate-400"}`,children:a(t==="All Types"?"transactions.allTypes":`transactions.types.${t}`)},t))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-bold text-slate-700 dark:text-slate-300",children:a("transactions.table.status")}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:vt.map(t=>e.jsx("button",{onClick:()=>x(t),className:`px-3 py-2 rounded-lg text-sm font-medium border transition-colors ${m===t?"bg-primary-500/10 border-primary-500 text-primary-600":"bg-slate-50 dark:bg-dark-900 border-slate-200 dark:border-dark-700 text-slate-600 dark:text-slate-400"}`,children:a(t==="All Status"?"transactions.allStatus":`transactions.status.${t}`)},t))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-bold text-slate-700 dark:text-slate-300",children:a("transactions.table.timestamp")}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(_,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx("input",{type:"date",value:i.startDate,onChange:t=>g({...i,startDate:t.target.value}),className:"w-full pl-9 pr-3 py-2.5 bg-slate-50 dark:bg-dark-900 border border-slate-200 dark:border-dark-700 rounded-lg text-sm"})]}),e.jsx("div",{className:"text-center text-slate-400 text-sm",children:"至"}),e.jsxs("div",{className:"relative",children:[e.jsx(_,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx("input",{type:"date",value:i.endDate,onChange:t=>g({...i,endDate:t.target.value}),className:"w-full pl-9 pr-3 py-2.5 bg-slate-50 dark:bg-dark-900 border border-slate-200 dark:border-dark-700 rounded-lg text-sm"})]})]})]})]}),e.jsxs("div",{className:"p-5 border-t border-slate-100 dark:border-dark-700 flex gap-3 bg-white dark:bg-dark-800",children:[e.jsx("button",{onClick:()=>{x("All Status"),b("All Types"),g({startDate:c(Y(new Date,7),"yyyy-MM-dd"),endDate:c(new Date,"yyyy-MM-dd")})},className:"flex-1 py-3 text-sm font-bold text-slate-600 dark:text-slate-300 bg-slate-100 dark:bg-dark-700 rounded-xl",children:a("common.reset")}),e.jsx("button",{onClick:()=>B(!1),className:"flex-1 py-3 text-sm font-bold text-white bg-primary-600 rounded-xl shadow-lg shadow-primary-500/30",children:a("common.confirm")})]})]})]}),document.body)]})}function S({label:a,value:j,mono:d=!1}){return e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-slate-500",children:a}),e.jsx("span",{className:`font-medium text-slate-900 dark:text-slate-100 ${d?"font-mono":""}`,children:j})]})}function K({title:a,value:j,trend:d,icon:b,color:m,isAnomaly:x=!1,className:u=""}){const N={blue:"border-blue-500/30 text-blue-600 dark:text-blue-400 bg-blue-50/50 dark:bg-blue-900/10",amber:"border-amber-500/30 text-amber-600 dark:text-amber-400 bg-amber-50/50 dark:bg-amber-900/10",emerald:"border-emerald-500/30 text-emerald-600 dark:text-emerald-400 bg-emerald-50/50 dark:bg-emerald-900/10",indigo:"border-indigo-500/30 text-indigo-600 dark:text-indigo-400 bg-indigo-50/50 dark:bg-indigo-900/10"};return e.jsxs("div",{className:`p-4 rounded-2xl border transition-all hover:shadow-md ${N[m]} ${x?"animate-pulse":""} ${u}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"opacity-80",children:b}),d&&e.jsx("span",{className:`text-[10px] font-bold px-1.5 py-0.5 rounded-full ${x?"bg-error/10 text-error":"bg-success/10 text-success"}`,children:d})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-[10px] font-bold uppercase tracking-wider opacity-60 truncate",children:a}),e.jsx("p",{className:"text-lg font-display font-bold mt-0.5",children:j})]})]})}export{Bt as default};
