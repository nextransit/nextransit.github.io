import{c as ie,j as e,A as Q,m as j,z as oe,R as ye,B as Z,Z as ke,X as me,a7 as us,a8 as Ge,Y as gs,a9 as we,aa as Ce,C as js,ab as fs,ac as qe,ad as De,ae as Xe,af as Ye,ag as Qe,ah as vs,ai as Ns,n as H,D as te,u as ys,aj as ks,ak as ws,L as J,I as Cs,b as Ze,al as Ds,E as Je,e as xe,r as Ss,am as es,W as As,d as Is,an as Ms,ao as Ls,ap as Ts,p as Rs,aq as ss,ar as Es}from"./index-D2lxm7TE.js";import{r as b,b as $s,f as Os,h as U,d as Fs}from"./vendor-xASHc04L.js";import{u as Ps,a as Ws,o as ts,s as W,b as Vs,n as zs}from"./schemas-oLtz9YBc.js";import{u as S}from"./i18n-Skc9GWxP.js";import{P as Se}from"./plus-BwHWfSI_.js";import{C as Ae,W as as}from"./wifi-BeNY1wsk.js";import{W as ae}from"./wrench-gR9hwGxf.js";import{U as ve}from"./upload-BLVtVLKu.js";import{B as ze,H as Ie}from"./hard-drive-CBZVzeff.js";import{R as Y,P as Ue,b as He,c as _e,T as je,f as Us,A as ce,C as Hs,X as _s,Y as Bs,a as le}from"./charts-X6rqVOAO.js";import{D as Ne}from"./download-DlFlLBXU.js";import{M as Ks}from"./more-horizontal-CC-Dbzk1.js";import{F as Gs}from"./file-text-cYS94zge.js";import{T as ls}from"./trash-2-BiYJoZNu.js";import{P as qs}from"./printer-XPFTSzoU.js";import{C as Xs}from"./check-Bdt2AJYq.js";import"./ui-BMjqw1mu.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ys=ie("Radar",[["path",{d:"M19.07 4.93A10 10 0 0 0 6.99 3.34",key:"z3du51"}],["path",{d:"M4 6h.01",key:"oypzma"}],["path",{d:"M2.29 9.62A10 10 0 1 0 21.31 8.35",key:"qzzz0"}],["path",{d:"M16.24 7.76A6 6 0 1 0 8.23 16.67",key:"1yjesh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M17.99 11.66A6 6 0 0 1 15.77 16.67",key:"1u2y91"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"m13.41 10.59 5.66-5.66",key:"mhq4k0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=ie("Rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=ie("Terminal",[["polyline",{points:"4 17 10 11 4 5",key:"akl6gq"}],["line",{x1:"12",x2:"20",y1:"19",y2:"19",key:"q2wloq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qs=ie("Volume2",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}],["path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14",key:"1kegas"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=ie("WifiOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 4.17-2.65",key:"11utq1"}],["path",{d:"M10.66 5c4.01-.36 8.14.9 11.34 3.76",key:"hxefdu"}],["path",{d:"M16.85 11.25a10 10 0 0 1 2.22 1.68",key:"q734kn"}],["path",{d:"M5 13a10 10 0 0 1 5.24-2.76",key:"piq4yl"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]),Zs=[{key:"add",icon:Se,label:"mdm.addDevice",color:"primary"},{key:"reboot_all",icon:oe,label:"mdm.bulkActions.reboot",color:"red"},{key:"sync",icon:ye,label:"mdm.cmdSyncTime",color:"blue"},{key:"activity",icon:Z,label:"devices.health",color:"green"},{key:"radar",icon:Ys,label:"devices.healthOverview",color:"purple"},{key:"settings",icon:ke,label:"mdm.remote.hotConfig",color:"slate"}],Js={primary:"text-primary-500 bg-primary-500/10 hover:bg-primary-500/20 border-primary-500/20",red:"text-red-500 bg-red-500/10 hover:bg-red-500/20 border-red-500/20",blue:"text-blue-500 bg-blue-500/10 hover:bg-blue-500/20 border-blue-500/20",green:"text-green-500 bg-green-500/10 hover:bg-green-500/20 border-green-500/20",purple:"text-purple-500 bg-purple-500/10 hover:bg-purple-500/20 border-purple-500/20",slate:"text-slate-500 bg-slate-500/10 hover:bg-slate-500/20 border-slate-500/20"},et=({onAction:s})=>{const{t:d}=S(),[n,c]=b.useState(!1),m={hidden:{opacity:0,scale:.8},visible:{opacity:1,scale:1,transition:{staggerChildren:.05,delayChildren:.1}},exit:{opacity:0,scale:.8,transition:{staggerChildren:.05,staggerDirection:-1}}},a={hidden:{opacity:0,y:20},visible:{opacity:1,y:0},exit:{opacity:0,y:10}};return e.jsxs("div",{className:"fixed bottom-8 right-8 z-[100] flex flex-col items-end","data-cursor":"gear",children:[e.jsx(Q,{children:n&&e.jsx(j.div,{variants:m,initial:"hidden",animate:"visible",exit:"exit",className:"flex flex-col gap-3 mb-4 items-end",children:Zs.map(g=>e.jsxs(j.button,{variants:a,whileHover:{scale:1.05,x:-5},whileTap:{scale:.95},onClick:()=>{c(!1),s(g.key)},className:`flex items-center gap-3 px-4 py-2.5 rounded-2xl glass-panel shadow-lg backdrop-blur-xl border border-white/20 dark:border-white/10 group ${Js[g.color]}`,children:[e.jsx("span",{className:"text-sm font-medium whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity absolute right-14 pr-2",children:d(g.label)}),e.jsx(g.icon,{className:"w-5 h-5 flex-shrink-0"})]},g.key))})}),e.jsxs(j.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>c(!n),className:"w-14 h-14 rounded-full bg-slate-900 dark:bg-slate-100 text-white dark:text-slate-900 shadow-xl shadow-cyan-500/30 flex items-center justify-center hover:shadow-cyan-500/50 transition-shadow relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-cyan-500/20 to-transparent pointer-events-none"}),e.jsx(Q,{mode:"wait",children:n?e.jsx(j.div,{initial:{rotate:-90,opacity:0},animate:{rotate:0,opacity:1},exit:{rotate:90,opacity:0},transition:{duration:.2},children:e.jsx(me,{className:"w-6 h-6"})},"close"):e.jsx(j.div,{initial:{rotate:90,opacity:0},animate:{rotate:0,opacity:1},exit:{rotate:-90,opacity:0},transition:{duration:.2},children:e.jsx(us,{className:"w-6 h-6"})},"menu")})]})]})},Ke=["#10b981","#3b82f6","#f59e0b","#ef4444","#8b5cf6"],st=ts({type:W().min(1),serialNumber:W().min(1).max(50),vehicleId:W().optional(),terminalId:W().optional()});ts({version:W().min(1),changelog:W().min(1),downloadUrl:W().url(),fileSize:zs().min(1),checksum:W().min(1),isMandatory:Vs()});const tt=({onClose:s,onSubmit:d,isSubmitting:n,methods:c})=>{const{t:m}=S();return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs(j.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"glass-panel w-full max-w-lg p-6 bg-white dark:bg-dark-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-display font-bold text-slate-900 dark:text-slate-100",children:m("mdm.createDevice")}),e.jsx("button",{onClick:s,className:"p-2 hover:bg-slate-100 dark:hover:bg-dark-700 rounded-lg",children:e.jsx(me,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:c.handleSubmit(d),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-500 dark:text-slate-400 mb-2",children:m("mdm.deviceType")}),e.jsx("input",{...c.register("type"),className:"input-field",placeholder:"P18Q"}),c.formState.errors.type&&e.jsx("p",{className:"mt-1 text-sm text-error",children:c.formState.errors.type.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-500 dark:text-slate-400 mb-2",children:m("mdm.serialNumber")}),e.jsx("input",{...c.register("serialNumber"),className:"input-field",placeholder:"SN001"}),c.formState.errors.serialNumber&&e.jsx("p",{className:"mt-1 text-sm text-error",children:c.formState.errors.serialNumber.message})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:s,className:"flex-1 btn-secondary",children:m("common.cancel")}),e.jsxs("button",{type:"submit",disabled:n,className:"flex-1 btn-primary flex items-center justify-center gap-2 disabled:opacity-50",children:[n&&e.jsx(J,{className:"w-4 h-4 animate-spin"}),m("common.confirm")]})]})]})]})})},at=({deviceId:s,onClose:d})=>{const{t:n}=S(),{data:c}=Es(s),[m,a]=b.useState("info");if(!c)return null;const g=[{date:"2024-01-15",type:"ARCHIVE",desc:"Device archived into inventory"},{date:"2024-02-01",type:"BIND",desc:"Bound to Line 202, Station Green Valley"},{date:"2024-06-15",type:"MAINTENANCE",desc:"Routine battery check completed"},{date:"2025-01-10",type:"UPGRADE",desc:"Firmware upgraded to v2.1.0"}];return e.jsxs(e.Fragment,{children:[e.jsx(j.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:d,className:"fixed inset-0 bg-black/30 z-40"}),e.jsxs(j.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:25,stiffness:200},className:"fixed right-0 top-0 h-full w-full max-w-xl bg-white dark:bg-dark-800 z-50 shadow-2xl flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-slate-200 dark:border-dark-600 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-display font-bold text-slate-900 dark:text-slate-100",children:c.id}),e.jsx("p",{className:"text-sm text-slate-500",children:c.serialNumber})]}),e.jsx("button",{onClick:d,className:"p-2 hover:bg-slate-100 dark:hover:bg-dark-700 rounded-lg",children:e.jsx(me,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex border-b border-slate-200 dark:border-dark-600",children:[e.jsx("button",{onClick:()=>a("info"),className:`px-6 py-3 text-sm font-medium border-b-2 transition-colors ${m==="info"?"border-primary-500 text-primary-600":"border-transparent text-slate-500 hover:text-slate-700"}`,children:n("common.details")}),e.jsx("button",{onClick:()=>a("lifecycle"),className:`px-6 py-3 text-sm font-medium border-b-2 transition-colors ${m==="lifecycle"?"border-primary-500 text-primary-600":"border-transparent text-slate-500 hover:text-slate-700"}`,children:n("mdm.lifecycle")})]}),e.jsx("div",{className:"flex-1 overflow-auto p-6",children:m==="info"?e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:n("mdm.hardwareInfo")}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-500",children:n("mdm.manufacturer")}),e.jsx("span",{className:"font-medium",children:c.manufacturer})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-500",children:n("mdm.model")}),e.jsx("span",{className:"font-medium",children:c.model})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-500",children:n("mdm.purchaseDate")}),e.jsx("span",{className:"font-medium",children:c.purchaseDate})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:n("mdm.status")}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-500",children:n("mdm.battery")}),e.jsxs("span",{className:"font-medium",children:[c.battery,"%"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-500",children:n("mdm.storage")}),e.jsxs("span",{className:"font-medium",children:[c.storage,"%"]})]})]})]})]}):e.jsx("div",{className:"relative pl-8 space-y-8 before:absolute before:left-[11px] before:top-2 before:bottom-2 before:w-0.5 before:bg-slate-200 dark:before:bg-dark-600",children:g.map((o,x)=>e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:`absolute -left-8 w-6 h-6 rounded-full border-4 border-white dark:border-dark-800 flex items-center justify-center ${o.type==="ARCHIVE"?"bg-blue-500":o.type==="BIND"?"bg-green-500":o.type==="MAINTENANCE"?"bg-amber-500":"bg-purple-500"}`,children:o.type==="UPGRADE"?e.jsx(re,{className:"w-3 h-3 text-white"}):e.jsx(Xs,{className:"w-3 h-3 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400 mb-1",children:o.date}),e.jsx("p",{className:"font-bold text-sm text-slate-900 dark:text-slate-100",children:n(`mdm.events.${o.type}`)}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:o.desc})]})]},x))})}),e.jsx("div",{className:"p-6 border-t border-slate-200 dark:border-dark-600 flex justify-end",children:e.jsx("button",{onClick:d,className:"btn-secondary",children:n("common.close")})})]})]})},lt=({deviceId:s,onClose:d})=>{const{t:n}=S(),{data:c,isLoading:m,isError:a,refetch:g}=ss({deviceId:s,limit:50},{enabled:!!s,retry:!1}),o=((c==null?void 0:c.data)||[]).filter(x=>x.level==="ERROR"||x.level==="FATAL").sort((x,p)=>new Date(p.timestamp).getTime()-new Date(x.timestamp).getTime()).slice(0,10);return e.jsxs(e.Fragment,{children:[e.jsx(j.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:d,className:"fixed inset-0 bg-black/30 z-40"}),e.jsxs(j.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:25,stiffness:200},className:"fixed right-0 top-0 h-full w-full max-w-lg bg-white dark:bg-dark-800 z-50 shadow-2xl flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-slate-200 dark:border-dark-600 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-display font-bold text-slate-900 dark:text-slate-100",children:n("devices.offlineLogsTitle",{deviceId:s})}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:n("devices.offlineLogsSubtitle")})]}),e.jsx("button",{onClick:d,className:"p-2 hover:bg-slate-100 dark:hover:bg-dark-700 rounded-lg",children:e.jsx(me,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex-1 overflow-auto p-6",children:[m&&e.jsx("div",{className:"flex items-center justify-center h-40",children:e.jsx(J,{className:"w-6 h-6 animate-spin text-primary-600"})}),a&&e.jsxs("div",{className:"text-center py-10",children:[e.jsx(H,{className:"w-10 h-10 mx-auto mb-3 text-error"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:n("common.loadError")}),e.jsx("button",{onClick:()=>g(),className:"btn-secondary mt-4",children:n("common.retry")})]}),!m&&!a&&o.length===0&&e.jsxs("div",{className:"text-center py-10 text-slate-500",children:[e.jsx(H,{className:"w-10 h-10 mx-auto mb-3 opacity-60"}),e.jsx("p",{children:n("devices.noErrorLogs")})]}),!m&&!a&&o.length>0&&e.jsx("div",{className:"space-y-3",children:o.map(x=>e.jsxs("div",{className:"p-4 rounded-xl border border-slate-200 dark:border-dark-600 bg-slate-50 dark:bg-dark-700/40",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold ${x.level==="FATAL"?"bg-red-800 text-white":"bg-red-600 text-white"}`,children:x.level}),e.jsx("span",{className:"text-xs text-slate-500",children:new Date(x.timestamp).toLocaleString()})]}),e.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300",children:x.message})]},x.id))})]}),e.jsx("div",{className:"p-6 border-t border-slate-200 dark:border-dark-600 flex justify-end",children:e.jsx("button",{onClick:d,className:"btn-secondary",children:n("common.close")})})]})]})},rt=()=>{var R,B,K,ee,G,ne,q;const{t:s}=S(),[d,n]=b.useState("24h"),[c,m]=b.useState(new Date),{data:a,refetch:g}=qe(),{data:o}=De(!0),{data:x}=Xe(),{data:p}=Ye(),{data:v}=Qe(),{data:h}=vs(),{data:r}=Ns();v!=null&&v.data;const N=h||{totalDevices:0,onlineDevices:0,offlineDevices:0,maintenanceDevices:0,alertsToday:0,upgradesInProgress:0};b.useEffect(()=>{const l=setInterval(()=>{m(new Date)},1e3);return()=>clearInterval(l)},[]);const L=a!=null&&a.healthDistribution?Object.entries(a.healthDistribution).map(([l,w])=>({name:s(`health.${l.toLowerCase()}`),value:w,status:l})):[],u=[{name:s("mdm.online"),value:N.onlineDevices,color:"#10b981"},{name:s("mdm.offline"),value:N.offlineDevices,color:"#ef4444"},{name:s("mdm.maintenance"),value:N.maintenanceDevices,color:"#f59e0b"}],T=[{time:"00:00",cpu:35,memory:42,battery:85},{time:"04:00",cpu:28,memory:38,battery:82},{time:"08:00",cpu:55,memory:62,battery:75},{time:"12:00",cpu:72,memory:78,battery:65},{time:"16:00",cpu:68,memory:71,battery:58},{time:"20:00",cpu:45,memory:52,battery:52},{time:"23:59",cpu:38,memory:45,battery:48}],$=l=>l>=90?"#10b981":l>=75?"#3b82f6":l>=60?"#f59e0b":l>=40?"#f97316":"#ef4444",_=l=>l>=90?s("health.excellent"):l>=75?s("health.good"):l>=60?s("health.fair"):l>=40?s("health.poor"):s("health.critical");return e.jsxs(j.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl lg:text-2xl font-display font-bold text-slate-900 dark:text-slate-100",children:s("devices.dashboard")}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1 text-sm lg:text-base",children:s("devices.dashboardSubtitle")})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 lg:gap-3",children:[e.jsxs("select",{value:d,onChange:l=>n(l.target.value),className:"input-field text-sm",children:[e.jsx("option",{value:"1h",children:s("time.last1h")}),e.jsx("option",{value:"24h",children:s("time.last24h")}),e.jsx("option",{value:"7d",children:s("time.last7d")}),e.jsx("option",{value:"30d",children:s("time.last30d")})]}),e.jsxs("button",{onClick:()=>g(),className:"btn-secondary flex items-center gap-2 text-sm",children:[e.jsx(ye,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:s("common.refresh")})]}),e.jsxs("span",{className:"text-xs text-slate-500",children:[s("common.lastUpdated"),": ",c.toLocaleTimeString()]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("button",{onClick:()=>{},className:"flex items-center gap-2 px-4 py-2 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg hover:bg-red-100 dark:hover:bg-red-900/40 transition-colors",children:[e.jsx(Be,{className:"w-4 h-4 text-red-500"}),e.jsxs("span",{className:"text-sm font-semibold text-red-700 dark:text-red-300",children:[s("mdm.offline"),": ",N.offlineDevices]})]}),e.jsxs("button",{onClick:()=>{},className:"flex items-center gap-2 px-4 py-2 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg hover:bg-amber-100 dark:hover:bg-amber-900/40 transition-colors",children:[e.jsx(H,{className:"w-4 h-4 text-amber-500"}),e.jsxs("span",{className:"text-sm font-semibold text-amber-700 dark:text-amber-300",children:[s("mdm.stats.critical"),": ",N.alertsToday||0]})]}),e.jsxs("button",{onClick:()=>{},className:"flex items-center gap-2 px-4 py-2 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg hover:bg-blue-100 dark:hover:bg-blue-900/40 transition-colors",children:[e.jsx(ve,{className:"w-4 h-4 text-blue-500"}),e.jsxs("span",{className:"text-sm font-semibold text-blue-700 dark:text-blue-300",children:[s("mdm.upgradesInProgress"),": ",N.upgradesInProgress||0]})]})]}),r&&r.length>0&&e.jsxs(j.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-xl p-4 flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-amber-500/10 rounded-lg",children:e.jsx(te,{className:"w-5 h-5 text-amber-500"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-semibold text-amber-800 dark:text-amber-200",children:s("mdm.inventory.lowStockTitle",{count:r.length})}),e.jsx("div",{className:"flex flex-wrap gap-4 mt-1",children:r.map(l=>e.jsxs("span",{className:"text-xs text-amber-600 dark:text-amber-400",children:["• ",s(`common.types.${l.type}`),": ",l.stock," (",s("mdm.inventory.threshold",{value:l.threshold}),")"]},l.type))})]}),e.jsx("button",{className:"text-sm font-medium text-amber-700 dark:text-amber-300 hover:underline",children:s("common.viewDetails")})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-9 gap-4",children:[{label:s("mdm.stats.totalDevices"),value:N.totalDevices,icon:we,color:"blue",trend:"+2%"},{label:s("mdm.stats.online"),value:N.onlineDevices,icon:as,color:"green",trend:"+5%"},{label:s("mdm.stats.offline"),value:N.offlineDevices,icon:Be,color:"red",trend:"-1%"},{label:s("mdm.stats.healthScore"),value:(a==null?void 0:a.averageScore)||0,icon:Z,color:"purple",suffix:"/100"},{label:s("mdm.stats.critical"),value:((R=o==null?void 0:o.summary)==null?void 0:R.criticalCount)||0,icon:te,color:"red"},{label:s("mdm.stats.maintenance"),value:((B=o==null?void 0:o.upcomingMaintenance)==null?void 0:B.length)||0,icon:ae,color:"orange"},{label:s("mdm.stats.deployments"),value:(x==null?void 0:x.length)||0,icon:re,color:"cyan"},{label:s("mdm.stats.anomalies"),value:(p==null?void 0:p.length)||0,icon:ze,color:"pink"},{label:s("mdm.stats.inventoryAlert"),value:(r==null?void 0:r.length)||0,icon:Ie,color:"amber"}].map((l,w)=>e.jsx(j.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:w*.05},className:"stat-card cursor-pointer hover:shadow-lg transition-shadow",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:l.label}),e.jsxs("p",{className:"text-xl font-bold text-slate-900 dark:text-slate-100 mt-1",children:[l.value,l.suffix||""]}),l.trend&&e.jsx("p",{className:`text-xs mt-1 ${l.trend.startsWith("+")?"text-success":"text-error"}`,children:l.trend})]}),e.jsx("div",{className:`p-2 rounded-lg bg-${l.color}-500/10`,children:e.jsx(l.icon,{className:`w-4 h-4 text-${l.color}-500`})})]})},l.label))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"glass-panel p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:s("mdm.dashboard.fleetHealth")}),e.jsx("p",{className:"text-sm text-slate-500",children:s("mdm.dashboard.fleetHealthDesc")})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-3xl font-bold",style:{color:$((a==null?void 0:a.averageScore)||0)},children:(a==null?void 0:a.averageScore)||0}),e.jsx("p",{className:"text-sm text-slate-500",children:_((a==null?void 0:a.averageScore)||0)})]})]}),e.jsx("div",{className:"h-48",children:e.jsx(Y,{width:"100%",height:"100%",children:e.jsxs(Ue,{children:[e.jsx(He,{data:L,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:5,dataKey:"value",children:L.map((l,w)=>e.jsx(_e,{fill:Ke[w%Ke.length]},`cell-${w}`))}),e.jsx(je,{}),e.jsx(Us,{verticalAlign:"bottom",height:36})]})})})]}),e.jsxs("div",{className:"glass-panel p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100 mb-4",children:s("mdm.dashboard.deviceStatus")}),e.jsx("div",{className:"h-48",children:e.jsx(Y,{width:"100%",height:"100%",children:e.jsxs(Ue,{children:[e.jsx(He,{data:u,cx:"50%",cy:"50%",outerRadius:80,dataKey:"value",label:({name:l,value:w})=>`${l}: ${w}`,children:u.map((l,w)=>e.jsx(_e,{fill:l.color},`cell-${w}`))}),e.jsx(je,{})]})})}),e.jsx("div",{className:"mt-4 grid grid-cols-3 gap-2 text-center",children:u.map(l=>e.jsxs("div",{className:"p-2 rounded-lg bg-slate-50 dark:bg-dark-700",children:[e.jsx("p",{className:"text-lg font-bold",style:{color:l.color},children:l.value}),e.jsx("p",{className:"text-xs text-slate-500",children:l.name})]},l.name))})]}),e.jsxs("div",{className:"glass-panel p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100 mb-4",children:s("mdm.dashboard.performanceTrends")}),e.jsx("div",{className:"h-48",children:e.jsx(Y,{width:"100%",height:"100%",children:e.jsxs(ce,{data:T,children:[e.jsx(Hs,{strokeDasharray:"3 3",className:"stroke-slate-200 dark:stroke-dark-600"}),e.jsx(_s,{dataKey:"time",stroke:"#64748b",fontSize:12}),e.jsx(Bs,{stroke:"#64748b",fontSize:12}),e.jsx(je,{}),e.jsx(le,{type:"monotone",dataKey:"cpu",stackId:"1",stroke:"#3b82f6",fill:"#3b82f6",fillOpacity:.3,name:s("mdm.cpu")}),e.jsx(le,{type:"monotone",dataKey:"memory",stackId:"1",stroke:"#8b5cf6",fill:"#8b5cf6",fillOpacity:.3,name:s("mdm.memory")})]})})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"glass-panel p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-500/10 rounded-lg",children:e.jsx(ze,{className:"w-5 h-5 text-purple-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:s("mdm.dashboard.aiPredictions")}),e.jsx("p",{className:"text-sm text-slate-500",children:s("mdm.dashboard.aiPredictionsDesc")})]})]}),e.jsxs("span",{className:"text-sm text-slate-500",children:[s("mdm.dashboard.confidence"),": ",((K=o==null?void 0:o.summary)==null?void 0:K.averageConfidence)||0,"%"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 rounded-lg border border-red-200 dark:border-red-800",children:[e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:s("predictions.critical")}),e.jsx("p",{className:"text-2xl font-bold text-red-700 dark:text-red-300",children:((ee=o==null?void 0:o.summary)==null?void 0:ee.criticalCount)||0})]}),e.jsxs("div",{className:"p-4 bg-orange-50 dark:bg-orange-900/20 rounded-lg border border-orange-200 dark:border-orange-800",children:[e.jsx("p",{className:"text-sm text-orange-600 dark:text-orange-400",children:s("predictions.high")}),e.jsx("p",{className:"text-2xl font-bold text-orange-700 dark:text-orange-300",children:((G=o==null?void 0:o.summary)==null?void 0:G.highCount)||0})]})]}),e.jsx("div",{className:"space-y-3",children:((ne=o==null?void 0:o.atRiskDevices)==null?void 0:ne.slice(0,5).map(l=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 dark:bg-dark-700/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${l.priority==="CRITICAL"?"bg-red-500":l.priority==="HIGH"?"bg-orange-500":"bg-yellow-500"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:l.deviceId}),e.jsx("p",{className:"text-xs text-slate-500",children:l.description})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm font-medium",children:[l.confidence,"%"]}),e.jsxs("p",{className:"text-xs text-slate-500",children:[l.estimatedTimeToFailure,"d"]})]})]},l.predictionId)))||e.jsx("p",{className:"text-center text-slate-500 py-8",children:s("mdm.dashboard.noPredictions")})})]}),e.jsxs("div",{className:"glass-panel p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-amber-500/10 rounded-lg",children:e.jsx(ae,{className:"w-5 h-5 text-amber-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:s("mdm.dashboard.maintenance")}),e.jsx("p",{className:"text-sm text-slate-500",children:s("mdm.dashboard.maintenanceDesc")})]})]}),e.jsx("button",{className:"text-sm text-primary-600 hover:underline",children:s("common.viewAll")})]}),e.jsx("div",{className:"space-y-3",children:((q=o==null?void 0:o.upcomingMaintenance)==null?void 0:q.slice(0,5).map(l=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 dark:bg-dark-700/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${l.priority==="CRITICAL"?"bg-red-100 text-red-600":l.priority==="HIGH"?"bg-orange-100 text-orange-600":"bg-blue-100 text-blue-600"}`,children:e.jsx(ae,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:l.deviceId}),e.jsx("p",{className:"text-xs text-slate-500",children:s(`mdm.maintenanceTypes.${l.maintenanceType}`)||l.maintenanceType})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-medium",children:new Date(l.scheduledDate).toLocaleDateString()}),e.jsxs("p",{className:"text-xs text-slate-500",children:["$",l.estimatedCost]})]})]},l.scheduleId)))||e.jsx("p",{className:"text-center text-slate-500 py-8",children:s("mdm.dashboard.noMaintenance")})})]})]}),p&&Array.isArray(p)&&p.length>0&&e.jsxs("div",{className:"glass-panel p-6 border-l-4 border-red-500",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(te,{className:"w-5 h-5 text-red-500"}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:s("mdm.dashboard.anomalies")})]}),e.jsxs("span",{className:"px-3 py-1 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 rounded-full text-sm font-medium",children:[p.length," ",s("mdm.dashboard.devices")]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:(Array.isArray(p)?p:[]).slice(0,6).map(l=>{var w;return e.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/10 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-mono text-sm",children:l.deviceId}),e.jsxs("span",{className:"text-xs text-red-600",children:[Array.isArray(l.anomalies)?l.anomalies.length:0," ",s("mdm.issues")]})]}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:Array.isArray(l.anomalies)&&((w=l.anomalies[0])==null?void 0:w.description)})]},l.deviceId)})})]})]})},it=()=>{const{t:s}=S(),[d,n]=b.useState("devices"),[c,m]=b.useState(!1),[a,g]=b.useState([]),[o,x]=b.useState(null),[p,v]=b.useState(null),{confirm:h,dialogProps:r}=ys(),[N,L]=b.useState(null),[u,T]=b.useState(null),[$,_]=b.useState(""),[R,B]=b.useState("all"),[K,ee]=b.useState("all"),[G,ne]=b.useState("all"),[q,l]=b.useState(!1),w=b.useRef(null),[X,rs]=b.useState("all"),[A,E]=b.useState({visible:!1,x:0,y:0,deviceId:null}),[V,Me]=b.useState(null),[P,Le]=b.useState(null),I=b.useRef(null),{data:he,isLoading:is,isError:Te,error:Re,refetch:ns}=Qe(),Ee=ks(),$e=ws(),Oe=Ps({resolver:Ws(st)}),pe=t=>{if(!t)return"-";const i=t.match(/\d+/);return i?s("devices.routeLabel",{id:Number(i[0])}):t},cs=t=>{const i=new Date(t),f=new Date,C=f.getTime()-i.getTime(),y=60*1e3,M=60*y,z=24*M;if(C<y)return s("devices.justNow");const k=Math.floor(C/y);if(k<60)return s("devices.minutesAgo",{count:k});const ge=Math.floor(C/M),We=i.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});if(f.toDateString()===i.toDateString())return s("devices.todayAt",{time:We});const Ve=new Date(f);return Ve.setDate(f.getDate()-1),Ve.toDateString()===i.toDateString()?s("devices.yesterdayAt",{time:We}):ge<24?s("devices.hoursAgo",{count:ge}):s("devices.daysAgo",{count:Math.floor(C/z)})},be=t=>t==="OFFLINE"?"bg-red-700 dark:bg-red-600 text-white":t==="MAINTENANCE"?"bg-amber-600 dark:bg-amber-500 text-white":t==="ACTIVE"?"bg-emerald-600 dark:bg-emerald-500 text-white":"bg-slate-600 text-white",ue=(he==null?void 0:he.data)||[],ds=Array.from(new Set(ue.map(t=>t.type))),os=Array.from(new Set(ue.filter(t=>!!t.vehicleId).map(t=>pe(t.vehicleId)))),D=ue.filter(t=>{const i=["ONBOARD","VALIDATOR","TOPUP"].includes(t.type)&&(!!t.terminalId||!!t.vehicleId),f=R==="all"||i,C=R!=="terminal_business"||K==="all"||pe(t.vehicleId)===K,y=!$||t.id.toLowerCase().includes($.toLowerCase())||t.serialNumber.toLowerCase().includes($.toLowerCase())||t.type.toLowerCase().includes($.toLowerCase()),M=G==="all"||t.type===G,z=X==="all"||X==="online"&&t.status==="ACTIVE"||X==="offline"&&t.status==="OFFLINE"||X==="maintenance"&&t.status==="MAINTENANCE";return f&&C&&y&&M&&z}),ms=()=>{var t;(t=w.current)==null||t.click()},xs=t=>{var f;const i=(f=t.target.files)==null?void 0:f[0];i&&(x(null),v(s("devices.bulkImportSuccess",{file:i.name})),t.target.value="")},hs=()=>{if(D.length===0){x(s("devices.bulkExportEmpty"));return}const t=["id","type","serialNumber","terminalId","vehicleId","status","firmwareVersion","lastActivityAt"],i=k=>`"${(k==null?"":String(k)).replace(/"/g,'""')}"`,f=D.map(k=>[i(k.id),i(k.type),i(k.serialNumber),i(k.terminalId),i(k.vehicleId),i(k.status),i(k.firmwareVersion),i(k.lastActivityAt)]),C=[t.join(","),...f.map(k=>k.join(","))].join(`
`),y=new Blob([C],{type:"text/csv;charset=utf-8;"}),M=URL.createObjectURL(y),z=document.createElement("a");z.href=M,z.download=`devices_${new Date().toISOString().slice(0,10)}.csv`,z.click(),URL.revokeObjectURL(M),v(s("devices.bulkExportSuccess",{count:D.length}))},se=t=>{x(null),v(s("devices.bulkActionQueued",{action:s(`devices.bulkActions.${t}`),count:a.length}))},ps=Ge(),Fe=t=>{ps(`/devices/remote?id=${t}`)};b.useEffect(()=>{const t=f=>{const C=f.target;if(["INPUT","TEXTAREA"].includes(C.tagName))return;if(A.visible&&f.key==="Escape"){E(M=>({...M,visible:!1}));return}if(!V)return;const y=f.key.toLowerCase();["d","r","l","backspace","delete"].includes(y)&&(f.preventDefault(),Le(y),setTimeout(()=>{Le(null),y==="d"?L(V):y==="r"?Fe(V):y==="l"?T(V):(y==="backspace"||y==="delete")&&Pe(V),E(M=>({...M,visible:!1}))},150))},i=()=>E(f=>({...f,visible:!1}));return window.addEventListener("keydown",t),window.addEventListener("click",i),()=>{window.removeEventListener("keydown",t),window.removeEventListener("click",i)}},[V,A.visible]);const O=q?"table-header-compact":"table-header",F=q?"table-cell-compact":"table-cell",bs=async t=>{var i,f;x(null);try{await Ee.mutateAsync(t),m(!1),Oe.reset()}catch(C){x(((f=(i=C.response)==null?void 0:i.data)==null?void 0:f.message)||s("mdm.createDeviceError"))}},Pe=async t=>{var f,C;if(await h({type:"danger",title:s("mdm.deleteDevice"),message:s("mdm.confirmDeleteDevice"),riskWarning:s("mdm.deleteDeviceWarning"),countdown:3})){x(null);try{await $e.mutateAsync(t)}catch(y){x(((C=(f=y.response)==null?void 0:f.data)==null?void 0:C.message)||s("mdm.deleteDeviceError"))}}};return is?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(J,{className:"w-8 h-8 animate-spin text-primary-600"})}):e.jsxs(j.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"space-y-6",children:[o&&e.jsxs("div",{className:"p-4 bg-error/10 border border-error/20 rounded-lg flex items-center gap-3 text-error",children:[e.jsx(H,{className:"w-5 h-5"}),e.jsx("span",{children:o}),e.jsx("button",{onClick:()=>x(null),className:"ml-auto text-sm hover:underline",children:s("common.dismiss")})]}),p&&e.jsxs("div",{className:"p-4 bg-success/10 border border-success/20 rounded-lg flex items-center gap-3 text-success",children:[e.jsx(Cs,{className:"w-5 h-5"}),e.jsx("span",{children:p}),e.jsx("button",{onClick:()=>v(null),className:"ml-auto text-sm hover:underline",children:s("common.dismiss")})]}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("div",{children:e.jsx("h1",{className:"text-lg font-display font-semibold text-slate-900 dark:text-slate-100",children:s("devices.deviceList")})})}),e.jsxs("div",{className:"glass-panel",children:[e.jsx("div",{className:"flex gap-1 p-4 border-b border-slate-200 dark:border-dark-600 overflow-x-auto bg-slate-50 dark:bg-dark-800/50",children:[{key:"all",label:s("mdm.filterAll"),count:D.length},{key:"online",label:s("mdm.filterOnline"),count:D.filter(t=>t.status==="ACTIVE").length},{key:"offline",label:s("mdm.filterOffline"),count:D.filter(t=>t.status==="OFFLINE").length},{key:"maintenance",label:s("mdm.filterMaintenance"),count:D.filter(t=>t.status==="MAINTENANCE").length}].map(t=>e.jsxs("button",{onClick:()=>rs(t.key),className:`px-4 py-2 rounded-lg font-medium transition-all whitespace-nowrap flex items-center gap-2 ${X===t.key?"bg-primary-500 text-white shadow-md":"text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-200 hover:bg-slate-200 dark:hover:bg-dark-700"}`,children:[e.jsx("span",{children:t.label}),e.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-xs ${X===t.key?"bg-white/20":"bg-slate-200 dark:bg-dark-600"}`,children:t.count})]},t.key))}),e.jsx("div",{className:"p-6",children:e.jsxs(Q,{mode:"wait",children:[d==="devices"&&e.jsxs(j.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"space-y-4",children:[Te&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 gap-4",children:[e.jsx(H,{className:"w-12 h-12 text-error"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:Re instanceof Error?Re.message:s("common.loadError")}),e.jsxs("button",{onClick:()=>ns(),className:"btn-secondary flex items-center gap-2",children:[e.jsx(oe,{className:"w-4 h-4"}),s("common.retry")]})]}),!Te&&D.length===0&&e.jsxs("div",{className:"text-center py-12 text-slate-500",children:[e.jsx(we,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:s("mdm.noDevices")})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mb-4",children:[e.jsxs("select",{value:R,onChange:t=>{const i=t.target.value;B(i),i!=="terminal_business"&&ee("all")},className:"px-4 py-2 bg-slate-100 dark:bg-dark-700 border border-slate-200 dark:border-dark-600 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"all",children:s("devices.viewAllDevices")}),e.jsx("option",{value:"terminal_business",children:s("devices.viewTerminalBusiness")})]}),e.jsxs("div",{className:"relative flex-1 min-w-[280px]",children:[e.jsx(Ze,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx("input",{type:"text",placeholder:s("mdm.searchDevices"),value:$,onChange:t=>_(t.target.value),className:"input-field pl-10"})]}),R==="terminal_business"&&e.jsxs("select",{value:K,onChange:t=>ee(t.target.value),className:"px-4 py-2 bg-slate-100 dark:bg-dark-700 border border-slate-200 dark:border-dark-600 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"all",children:s("devices.allRoutes")}),os.map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsxs("select",{value:G,onChange:t=>ne(t.target.value),className:"px-4 py-2 bg-slate-100 dark:bg-dark-700 border border-slate-200 dark:border-dark-600 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"all",children:s("common.allTypes")}),ds.map(t=>e.jsx("option",{value:t,children:s(`common.types.${t}`,{defaultValue:t})},t))]}),e.jsx("button",{onClick:()=>l(t=>!t),className:`px-3 py-2 rounded-lg text-sm font-medium border transition-colors ${q?"bg-primary-50 dark:bg-primary-500/10 text-primary-600 border-primary-200 dark:border-primary-500/30":"bg-transparent text-slate-600 dark:text-slate-400 border-slate-200 dark:border-dark-600 hover:bg-slate-50 dark:hover:bg-dark-700"}`,children:s("devices.compactMode")}),e.jsx("input",{ref:w,type:"file",accept:".csv,.xlsx",onChange:xs,className:"hidden"}),e.jsxs("button",{type:"button",onClick:ms,className:"px-3 py-2 rounded-lg text-sm font-medium border border-primary-200 dark:border-primary-500/30 text-primary-600 hover:bg-primary-50 dark:hover:bg-primary-500/10 flex items-center gap-2",title:s("devices.bulkImportHint"),children:[e.jsx(ve,{className:"w-4 h-4"}),s("devices.bulkImport")]}),e.jsxs("button",{type:"button",onClick:hs,className:"px-3 py-2 rounded-lg text-sm font-medium border border-slate-200 dark:border-dark-600 text-slate-700 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-dark-700 flex items-center gap-2",title:s("devices.bulkExportHint"),children:[e.jsx(Ne,{className:"w-4 h-4"}),s("devices.bulkExport")]}),e.jsxs("button",{onClick:()=>m(!0),className:`btn-primary flex items-center gap-2 shadow-lg shadow-primary-500/30 hover:shadow-primary-500/50 hover:scale-[1.02] transition-transform relative ${D.length===0?"animate-pulse ring-4 ring-primary-500/20":""}`,children:[e.jsx(Se,{className:"w-4 h-4"}),s("devices.addDevice"),D.length===0&&e.jsx("span",{className:"absolute inset-0 rounded-lg bg-primary-400 opacity-20 animate-ping pointer-events-none"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-slate-200 dark:border-dark-600",children:[e.jsx("th",{className:O,children:e.jsx("input",{type:"checkbox",checked:a.length===D.length&&D.length>0,onChange:t=>{t.target.checked?g(D.map(i=>i.id)):g([])},className:"rounded border-slate-300"})}),e.jsx("th",{className:O,children:s("mdm.deviceId")}),e.jsx("th",{className:O,children:s("mdm.deviceType")}),e.jsx("th",{className:O,children:s("mdm.serialNumber")}),e.jsx("th",{className:O,children:s("devices.linkedTerminalRoute")}),e.jsx("th",{className:O,children:s("mdm.firmwareVersion")}),e.jsx("th",{className:O,children:s("mdm.status")}),e.jsx("th",{className:O,children:s("mdm.lastActivity")}),e.jsx("th",{className:`${O} sticky right-0 bg-slate-50 dark:bg-dark-800 z-10 shadow-[-1px_0_0_0_rgba(0,0,0,0.1)]`,children:s("common.actions")})]})}),e.jsx("tbody",{"data-cursor":"list",className:"divide-y divide-slate-200 dark:divide-dark-600",children:D.map(t=>e.jsxs("tr",{onDoubleClick:()=>L(t.id),onMouseEnter:i=>{Me(t.id),I.current&&clearTimeout(I.current)},onMouseMove:i=>{A.visible||(I.current&&clearTimeout(I.current),I.current=setTimeout(()=>{E({visible:!0,x:i.clientX+10,y:i.clientY+10,deviceId:t.id})},200))},onMouseLeave:i=>{Me(null),I.current&&clearTimeout(I.current)},onContextMenu:i=>{i.preventDefault(),I.current&&clearTimeout(I.current),E({visible:!0,x:i.clientX+10,y:i.clientY+10,deviceId:t.id})},className:`group cursor-pointer transition-colors relative ${V===t.id?"bg-primary-50/50 dark:bg-primary-900/10":"hover:bg-primary-50/50 dark:hover:bg-primary-900/10"}`,children:[e.jsx("td",{className:F,children:e.jsx("input",{type:"checkbox",checked:a.includes(t.id),onChange:i=>{i.target.checked?g([...a,t.id]):g(a.filter(f=>f!==t.id))},className:"rounded border-slate-300"})}),e.jsx("td",{className:`${F} font-mono text-primary-600`,children:t.id}),e.jsx("td",{className:F,children:t.type}),e.jsx("td",{className:`${F} font-mono`,children:t.serialNumber}),e.jsx("td",{className:F,children:e.jsxs("div",{className:"leading-tight",children:[e.jsx("div",{className:"font-mono",children:t.terminalId||"-"}),e.jsx("div",{className:"text-slate-500",children:pe(t.vehicleId)})]})}),e.jsx("td",{className:F,children:t.firmwareVersion}),e.jsx("td",{className:F,children:t.status==="ACTIVE"?e.jsxs("button",{onClick:i=>{i.stopPropagation(),se("reboot")},className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-semibold hover:ring-2 hover:ring-primary-500/30 transition-all ${be(t.status)}`,"data-cursor":"refresh",children:[e.jsx("span",{children:t.status}),e.jsx(Ds,{className:"w-3 h-3 opacity-60"})]}):t.status==="OFFLINE"?e.jsx("button",{type:"button",onClick:i=>{i.stopPropagation(),T(t.id)},title:s("devices.openOfflineLogs"),className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold hover:opacity-90 transition-opacity ${be(t.status)}`,children:t.status}):e.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold ${be(t.status)}`,children:t.status})}),e.jsx("td",{className:`${F} text-slate-500`,title:new Date(t.lastActivityAt).toLocaleString(),children:cs(t.lastActivityAt)}),e.jsx("td",{"data-cursor":"gear",className:`${F} text-center`,onClick:i=>{i.stopPropagation(),I.current&&clearTimeout(I.current),E({visible:!0,x:i.clientX+10,y:i.clientY+10,deviceId:t.id})},children:e.jsx("button",{className:"p-2 text-slate-400 hover:text-primary-500 rounded-full hover:bg-slate-100 dark:hover:bg-dark-700 transition-colors",children:e.jsx(Ks,{className:"w-5 h-5"})})})]},t.id))})]})}),e.jsx(Q,{children:A.visible&&A.deviceId&&e.jsxs(j.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:10},transition:{duration:.2,ease:[.16,1,.3,1]},style:{position:"fixed",left:A.x,top:A.y,zIndex:9999},className:"flex items-center px-1.5 py-1.5 bg-[rgba(25,25,30,0.9)] backdrop-blur-md rounded-xl shadow-[0_8px_32px_rgba(0,0,0,0.5)] border border-white/10 origin-top-left",onClick:t=>t.stopPropagation(),children:[e.jsx("div",{className:"absolute left-0 top-2 bottom-2 w-[3px] bg-gradient-to-b from-primary-400 to-accent-500 rounded-r-sm"}),e.jsxs("div",{className:"flex items-center gap-1 pl-1",children:[e.jsxs("button",{onClick:()=>{L(A.deviceId),E(t=>({...t,visible:!1}))},className:`flex flex-col items-center justify-center w-14 py-2 rounded-lg relative group/btn transition-colors ${P==="d"?"bg-blue-500/20":"hover:bg-white/5"}`,title:s("common.details"),children:[e.jsx(Je,{className:`w-5 h-5 mb-1 transition-colors ${P==="d"?"text-blue-400":"text-slate-300 group-hover/btn:text-blue-400"}`}),e.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:"详情"}),e.jsx("kbd",{className:"absolute top-1 right-1 text-[8px] font-mono text-slate-500 bg-black/40 rounded px-1",children:"D"})]}),e.jsxs("button",{onClick:()=>{Fe(A.deviceId),E(t=>({...t,visible:!1}))},className:`flex flex-col items-center justify-center w-14 py-2 rounded-lg relative group/btn transition-colors ${P==="r"?"bg-amber-500/20":"hover:bg-white/5"}`,title:s("devices.remoteControl"),children:[e.jsx(de,{className:`w-5 h-5 mb-1 transition-colors ${P==="r"?"text-amber-400":"text-slate-300 group-hover/btn:text-amber-400"}`}),e.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:"控制"}),e.jsx("kbd",{className:"absolute top-1 right-1 text-[8px] font-mono text-slate-500 bg-black/40 rounded px-1",children:"R"})]}),e.jsxs("button",{onClick:()=>{T(A.deviceId),E(t=>({...t,visible:!1}))},className:`flex flex-col items-center justify-center w-14 py-2 rounded-lg relative group/btn transition-colors ${P==="l"?"bg-emerald-500/20":"hover:bg-white/5"}`,title:s("devices.viewLogs"),children:[e.jsx(Gs,{className:`w-5 h-5 mb-1 transition-colors ${P==="l"?"text-emerald-400":"text-slate-300 group-hover/btn:text-emerald-400"}`}),e.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:"日志"}),e.jsx("kbd",{className:"absolute top-1 right-1 text-[8px] font-mono text-slate-500 bg-black/40 rounded px-1",children:"L"})]}),e.jsx("div",{className:"w-[1px] h-8 mx-1 bg-white/10"}),e.jsxs("button",{onClick:()=>{Pe(A.deviceId),E(t=>({...t,visible:!1}))},disabled:$e.isPending,className:`flex flex-col items-center justify-center w-14 py-2 rounded-lg relative group/btn transition-colors disabled:opacity-50 ${["backspace","delete"].includes(P||"")?"bg-rose-500/20":"hover:bg-rose-500/10"}`,title:s("common.delete"),children:[e.jsx(ls,{className:`w-5 h-5 mb-1 transition-colors ${["backspace","delete"].includes(P||"")?"text-rose-400":"text-slate-300 group-hover/btn:text-rose-500"}`}),e.jsx("span",{className:"text-[10px] text-slate-400 font-medium group-hover/btn:text-rose-400",children:"删除"}),e.jsx("kbd",{className:"absolute top-1 right-1 text-[8px] font-mono text-slate-500 bg-black/40 rounded px-1",children:"⌫"})]})]})]})}),a.length>0&&e.jsxs("div",{className:"flex flex-wrap items-center gap-4 p-4 bg-slate-50 dark:bg-dark-700 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:s("devices.bulkActionsLabel")}),e.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:s("mdm.selectedDevices",{count:a.length})}),e.jsxs("div",{className:"flex gap-2 ml-auto flex-wrap",children:[e.jsxs("button",{className:"btn-secondary text-sm",onClick:()=>se("command"),children:[e.jsx(de,{className:"w-4 h-4 mr-2"}),s("devices.bulkActions.command")]}),e.jsxs("button",{className:"btn-secondary text-sm",onClick:()=>se("upgrade"),children:[e.jsx(ve,{className:"w-4 h-4 mr-2"}),s("devices.bulkActions.upgrade")]}),e.jsxs("button",{className:"btn-secondary text-sm",onClick:()=>se("reboot"),children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),s("devices.bulkActions.reboot")]}),e.jsxs("button",{className:"btn-secondary text-sm",onClick:()=>se("status"),children:[e.jsx(ke,{className:"w-4 h-4 mr-2"}),s("devices.bulkActions.status")]})]})]})]},"devices"),d!=="devices"&&e.jsxs(j.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"text-center py-12 text-slate-500",children:[e.jsx(xe,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:s("common.comingSoon")}),e.jsx("p",{className:"text-sm mt-2",children:s("devices.tabInDevelopment",{tab:d})})]},d)]})})]}),c&&e.jsx(tt,{onClose:()=>m(!1),onSubmit:bs,isSubmitting:Ee.isPending,methods:Oe}),N&&e.jsx(at,{deviceId:N,onClose:()=>L(null)}),u&&e.jsx(lt,{deviceId:u,onClose:()=>T(null)}),e.jsx(Ss,{...r})]})},nt=()=>{var p,v;const{t:s}=S(),{data:d}=qe(),{data:n}=De(!0),{data:c}=Ye(),{data:m}=es(),[a,g]=b.useState({communication:{signal4G:-65+Math.floor(Math.random()*20),wifiLatency:15+Math.floor(Math.random()*30),simTraffic:2.5+Math.random()*2},hardware:{flashWrites:85+Math.floor(Math.random()*10),voltage:11.8+Math.random()*.5,temperature:35+Math.floor(Math.random()*15)},peripherals:{cardReader:Math.random()>.1,display:Math.random()>.05,speaker:Math.random()>.1,printer:Math.random()>.2}});b.useEffect(()=>{const h=setInterval(()=>{g({communication:{signal4G:-65+Math.floor(Math.random()*20),wifiLatency:15+Math.floor(Math.random()*30),simTraffic:2.5+Math.random()*2},hardware:{flashWrites:85+Math.floor(Math.random()*10),voltage:11.8+Math.random()*.5,temperature:35+Math.floor(Math.random()*15)},peripherals:{cardReader:Math.random()>.1,display:Math.random()>.05,speaker:Math.random()>.1,printer:Math.random()>.2}})},5e3);return()=>clearInterval(h)},[]);const o=h=>h>-60?"text-green-500":h>-75?"text-yellow-500":"text-red-500",x=h=>h>12?"text-green-500":h>11.5?"text-yellow-500":"text-red-500";return e.jsxs(j.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-display font-bold text-slate-900 dark:text-slate-100",children:s("devices.health")}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:s("devices.healthSubtitle")})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[{label:s("maintenance.critical"),value:((p=n==null?void 0:n.summary)==null?void 0:p.criticalCount)||0,icon:te,color:"red"},{label:s("maintenance.highPriority"),value:((v=n==null?void 0:n.summary)==null?void 0:v.highCount)||0,icon:As,color:"orange"},{label:s("maintenance.scheduled"),value:(m==null?void 0:m.length)||0,icon:xe,color:"blue"},{label:s("maintenance.anomalies"),value:(c==null?void 0:c.length)||0,icon:Z,color:"amber"}].map((h,r)=>e.jsx(j.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:r*.1},className:"stat-card",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:h.label}),e.jsx("p",{className:"text-2xl font-display font-bold text-slate-900 dark:text-slate-100 mt-2",children:h.value})]}),e.jsx("div",{className:`p-3 rounded-lg bg-${h.color}-500/10`,children:e.jsx(h.icon,{className:`w-6 h-6 text-${h.color}-600 dark:text-${h.color}-400`})})]})},h.label))}),e.jsxs("div",{className:"glass-panel p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(as,{className:"w-5 h-5 text-blue-500"}),s("mdm.health.communication")]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-dark-700 rounded-xl",children:[e.jsx("p",{className:"text-sm text-slate-500 mb-2",children:s("mdm.health.signal4G")}),e.jsxs("p",{className:`text-2xl font-bold ${o(a.communication.signal4G)}`,children:[a.communication.signal4G," dBm"]}),e.jsx("div",{className:"flex gap-1 mt-2",children:[1,2,3,4,5].map(h=>e.jsx("div",{className:`h-${h+1} w-2 rounded ${a.communication.signal4G>-50-h*10?"bg-green-500":"bg-slate-300 dark:bg-dark-600"}`},h))})]}),e.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-dark-700 rounded-xl",children:[e.jsx("p",{className:"text-sm text-slate-500 mb-2",children:s("mdm.health.wifiLatency")}),e.jsxs("p",{className:`text-2xl font-bold ${a.communication.wifiLatency<30?"text-green-500":"text-yellow-500"}`,children:[a.communication.wifiLatency," ms"]})]}),e.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-dark-700 rounded-xl",children:[e.jsx("p",{className:"text-sm text-slate-500 mb-2",children:s("mdm.health.simTraffic")}),e.jsxs("p",{className:"text-2xl font-bold text-blue-500",children:[a.communication.simTraffic.toFixed(1)," GB"]})]})]})]}),e.jsxs("div",{className:"glass-panel p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Ie,{className:"w-5 h-5 text-purple-500"}),s("mdm.health.hardwareLifecycle")]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-dark-700 rounded-xl",children:[e.jsx("p",{className:"text-sm text-slate-500 mb-2",children:s("mdm.health.flashWrites")}),e.jsxs("p",{className:`text-2xl font-bold ${a.hardware.flashWrites>90?"text-red-500":"text-green-500"}`,children:[a.hardware.flashWrites,"%"]}),e.jsx("div",{className:"h-2 bg-slate-200 dark:bg-dark-600 rounded-full mt-2 overflow-hidden",children:e.jsx("div",{className:`h-full ${a.hardware.flashWrites>90?"bg-red-500":"bg-green-500"}`,style:{width:`${a.hardware.flashWrites}%`}})})]}),e.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-dark-700 rounded-xl",children:[e.jsx("p",{className:"text-sm text-slate-500 mb-2",children:s("mdm.health.voltage")}),e.jsxs("p",{className:`text-2xl font-bold ${x(a.hardware.voltage)}`,children:[a.hardware.voltage.toFixed(1)," V"]})]}),e.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-dark-700 rounded-xl",children:[e.jsx("p",{className:"text-sm text-slate-500 mb-2",children:s("mdm.health.temperature")}),e.jsxs("p",{className:`text-2xl font-bold ${a.hardware.temperature>50?"text-red-500":"text-green-500"}`,children:[a.hardware.temperature,"°C"]})]})]})]}),e.jsxs("div",{className:"glass-panel p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Ae,{className:"w-5 h-5 text-cyan-500"}),s("mdm.health.peripherals")]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[{name:s("mdm.health.cardReader"),status:a.peripherals.cardReader,icon:Is},{name:s("mdm.health.display"),status:a.peripherals.display,icon:Ms},{name:s("mdm.health.speaker"),status:a.peripherals.speaker,icon:Qs},{name:s("mdm.health.printer"),status:a.peripherals.printer,icon:qs}].map(h=>e.jsx("div",{className:`p-4 rounded-xl border-2 ${h.status?"border-green-500 bg-green-50 dark:bg-green-950/20":"border-red-500 bg-red-50 dark:bg-red-950/20"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(h.icon,{className:`w-6 h-6 ${h.status?"text-green-500":"text-red-500"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:h.name}),e.jsx("p",{className:`text-sm ${h.status?"text-green-600":"text-red-600"}`,children:h.status?s("common.online"):s("common.offline")})]})]})},h.name))})]}),e.jsxs("div",{className:"glass-panel p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:s("maintenance.fleetHealth")}),d&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:s("maintenance.averageScore")}),e.jsxs("span",{className:"text-2xl font-bold",children:[d.averageScore,"/100"]})]}),e.jsx("div",{className:"h-4 bg-slate-200 dark:bg-dark-600 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary-500",style:{width:`${d.averageScore}%`}})})]})]}),e.jsxs("div",{className:"glass-panel p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Z,{className:"w-5 h-5 text-indigo-500"}),s("mdm.resourceMonitoring.resourceUsage")]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-slate-50 dark:bg-dark-700/50 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-sm font-medium",children:s("mdm.resourceMonitoring.cpu")}),e.jsxs("span",{className:"text-lg font-bold text-indigo-600",children:[a.hardware.temperature,"%"]})]}),e.jsx(Y,{width:"100%",height:100,children:e.jsx(ce,{data:Array.from({length:20},(h,r)=>({time:r,value:30+Math.random()*40})),children:e.jsx(le,{type:"monotone",dataKey:"value",stroke:"#6366f1",fill:"#6366f1",fillOpacity:.2})})})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-dark-700/50 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-sm font-medium",children:s("mdm.resourceMonitoring.memory")}),e.jsx("span",{className:"text-lg font-bold text-emerald-600",children:"62%"})]}),e.jsx(Y,{width:"100%",height:100,children:e.jsx(ce,{data:Array.from({length:20},(h,r)=>({time:r,value:50+Math.random()*30})),children:e.jsx(le,{type:"monotone",dataKey:"value",stroke:"#10b981",fill:"#10b981",fillOpacity:.2})})})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-dark-700/50 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-sm font-medium",children:s("mdm.resourceMonitoring.storage")}),e.jsxs("span",{className:"text-lg font-bold text-amber-600",children:[a.hardware.flashWrites,"%"]})]}),e.jsx(Y,{width:"100%",height:100,children:e.jsx(ce,{data:Array.from({length:20},(h,r)=>({time:r,value:40+Math.random()*20})),children:e.jsx(le,{type:"monotone",dataKey:"value",stroke:"#f59e0b",fill:"#f59e0b",fillOpacity:.2})})})]})]})]}),e.jsxs("div",{className:"glass-panel p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Ce,{className:"w-5 h-5 text-yellow-500"}),s("mdm.resourceMonitoring.environment")]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-dark-700/50 rounded-xl text-center",children:[e.jsx("p",{className:"text-sm text-slate-500 mb-1",children:s("mdm.health.temperature")}),e.jsxs("p",{className:`text-2xl font-bold ${a.hardware.temperature>70?"text-red-500":"text-green-500"}`,children:[a.hardware.temperature,"°C"]})]}),e.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-dark-700/50 rounded-xl text-center",children:[e.jsx("p",{className:"text-sm text-slate-500 mb-1",children:s("mdm.health.voltage")}),e.jsxs("p",{className:`text-2xl font-bold ${a.hardware.voltage<4.5?"text-amber-500":"text-green-500"}`,children:[a.hardware.voltage,"V"]})]}),e.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-dark-700/50 rounded-xl text-center",children:[e.jsx("p",{className:"text-sm text-slate-500 mb-1",children:s("mdm.resourceMonitoring.humidity")}),e.jsx("p",{className:"text-2xl font-bold text-blue-500",children:"45%"})]}),e.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-dark-700/50 rounded-xl text-center",children:[e.jsx("p",{className:"text-sm text-slate-500 mb-1",children:s("mdm.resourceMonitoring.uptime")}),e.jsx("p",{className:"text-2xl font-bold text-purple-500",children:"72h"})]})]})]})]})},ct=()=>{const{t:s}=S(),{data:d,isLoading:n}=Ls(),{data:c}=Xe(),m=Array.isArray(c)?c:[],[a,g]=b.useState(!1),[o,x]=b.useState(null),[p,v]=b.useState({targetPercentage:5,routeFilter:"",deviceIds:"",silentUpgrade:!0,upgradeWindow:"02:00-04:00",autoRollback:!0});if(n)return e.jsx("div",{className:"flex justify-center p-12",children:e.jsx(J,{className:"animate-spin"})});const h=()=>{g(!1)};return e.jsxs(j.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-display font-bold text-slate-900 dark:text-slate-100",children:s("devices.firmware")}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:s("devices.firmwareSubtitle")})]}),e.jsxs("button",{className:"btn-primary flex items-center gap-2",children:[e.jsx(Se,{className:"w-4 h-4"}),s("mdm.addVersion")]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"glass-panel p-4",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 bg-blue-500/10 rounded-lg",children:e.jsx(re,{className:"w-5 h-5 text-blue-500"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:s("mdm.firmware.canaryRelease")}),e.jsx("p",{className:"text-xs text-slate-500",children:s("mdm.firmware.canaryDesc")})]})]})}),e.jsx("div",{className:"glass-panel p-4",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 bg-purple-500/10 rounded-lg",children:e.jsx(xe,{className:"w-5 h-5 text-purple-500"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:s("mdm.firmware.silentUpgrade")}),e.jsx("p",{className:"text-xs text-slate-500",children:s("mdm.firmware.silentDesc")})]})]})}),e.jsx("div",{className:"glass-panel p-4",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 bg-green-500/10 rounded-lg",children:e.jsx(oe,{className:"w-5 h-5 text-green-500"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:s("mdm.firmware.autoRollback")}),e.jsx("p",{className:"text-xs text-slate-500",children:s("mdm.firmware.rollbackDesc")})]})]})})]}),m.length>0&&e.jsxs("div",{className:"glass-panel p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Z,{className:"w-5 h-5 text-blue-500"}),s("mdm.firmware.activeCanary")]}),e.jsx("div",{className:"space-y-3",children:m.map(r=>e.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-dark-700 rounded-xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium",children:r.firmwareVersion}),e.jsx("span",{className:`badge ${r.status==="IN_PROGRESS"?"badge-success":"badge-warning"}`,children:r.status})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-slate-500",children:[e.jsxs("span",{children:[r.currentPercentage,"% ",s("mdm.firmware.deployed")]}),e.jsxs("span",{children:[s("mdm.firmware.healthScore"),": ",r.healthCriteria.minHealthScore,"/100"]})]}),e.jsx("div",{className:"h-2 bg-slate-200 dark:bg-dark-600 rounded-full mt-2 overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500",style:{width:`${r.currentPercentage}%`}})})]},r.deploymentId))})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.isArray(d)&&d.map(r=>{var N;return e.jsxs("div",{className:"glass-panel p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-500/10 rounded-lg text-blue-500",children:e.jsx(Ae,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-slate-900 dark:text-slate-100",children:r.version}),e.jsx("p",{className:"text-xs text-slate-500",children:r.releaseDate})]})]}),e.jsx("span",{className:`badge ${r.type==="STABLE"?"badge-success":"badge-warning"}`,children:r.type})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-500",children:s("mdm.fileSize")}),e.jsx("span",{className:"font-medium",children:r.size})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-500",children:s("mdm.checksum")}),e.jsxs("span",{className:"font-mono text-xs",children:[(N=r.checksum)==null?void 0:N.slice(0,12),"..."]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"flex-1 btn-secondary text-sm py-1.5",children:s("common.details")}),e.jsxs("button",{className:"flex-1 btn-primary text-sm py-1.5 flex items-center justify-center gap-2",onClick:()=>{x(r),g(!0)},children:[e.jsx(re,{className:"w-3.5 h-3.5"}),s("mdm.firmware.startCanary")]})]})]},r.version)})}),e.jsx(Q,{children:a&&e.jsxs(e.Fragment,{children:[e.jsx(j.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 z-40",onClick:()=>g(!1)}),e.jsx(j.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"fixed inset-0 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-dark-800 rounded-2xl p-6 max-w-lg w-full shadow-2xl",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[e.jsx(re,{className:"w-5 h-5 text-blue-500"}),s("mdm.firmware.canaryConfig")]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:s("mdm.firmware.targetVersion")}),e.jsx("input",{type:"text",value:(o==null?void 0:o.version)||"",disabled:!0,className:"input-field mt-1 bg-slate-100 dark:bg-dark-700"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:s("mdm.firmware.canaryPercentage")}),e.jsx("input",{type:"range",min:"1",max:"100",value:p.targetPercentage,onChange:r=>v({...p,targetPercentage:+r.target.value}),className:"w-full mt-1"}),e.jsxs("p",{className:"text-sm text-slate-500",children:[p.targetPercentage,"% ",s("mdm.firmware.ofDevices")]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:s("mdm.firmware.upgradeWindow")}),e.jsx("input",{type:"text",value:p.upgradeWindow,onChange:r=>v({...p,upgradeWindow:r.target.value}),className:"input-field mt-1",placeholder:"02:00-04:00"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:p.silentUpgrade,onChange:r=>v({...p,silentUpgrade:r.target.checked})}),e.jsx("span",{className:"text-sm",children:s("mdm.firmware.silentUpgrade")})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:p.autoRollback,onChange:r=>v({...p,autoRollback:r.target.checked})}),e.jsx("span",{className:"text-sm",children:s("mdm.firmware.autoRollback")})]})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{className:"flex-1 btn-secondary",onClick:()=>g(!1),children:s("common.cancel")}),e.jsx("button",{className:"flex-1 btn-primary",onClick:h,children:s("mdm.firmware.startDeployment")})]})]})})]})})]})},dt=()=>{const{t:s}=S(),[d]=Fs(),n=d.get("id")||"",c=Ts(),[m,a]=b.useState(n),[g,o]=b.useState(!1);b.useEffect(()=>{const r=d.get("id");r&&a(r)},[d]);const[x,p]=b.useState({heartbeatInterval:30,logLevel:"INFO",blacklistSyncInterval:60}),v=async r=>{if(m)try{await c.mutateAsync({id:m,command:r})}catch(N){console.error(N)}},h=()=>{o(!1)};return e.jsxs(j.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-display font-bold text-slate-900 dark:text-slate-100",children:s("devices.remote")}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:s("devices.remoteSubtitle")})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 glass-panel p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-6 flex items-center gap-2",children:[e.jsx(de,{className:"w-5 h-5 text-primary-500"}),s("mdm.sendCommand")]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:s("mdm.deviceId")}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(Ze,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx("input",{type:"text",value:m,onChange:r=>a(r.target.value),placeholder:s("devices.enterDeviceIdHint")||"请输入设备 ID，例如：TERM-1001",className:`input-field pl-10 w-full ${m?"":"ring-2 ring-amber-500/20 border-amber-500"}`})]})}),!m&&e.jsxs("p",{className:"mt-2 text-sm text-amber-600 flex items-center gap-1 animate-pulse",children:[e.jsx(H,{className:"w-4 h-4"}),s("devices.selectDeviceFirst")||"请先从设备列表中选择一个设备或手动输入 ID建议进行调整。"]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[{cmd:"REBOOT",label:s("mdm.cmdRestart"),icon:oe,color:"red"},{cmd:"LOG_TRANSFER",label:s("mdm.cmdCheckHealth"),icon:Ie,color:"blue"},{cmd:"WAKE_UP",label:s("mdm.cmdSyncTime"),icon:Ce,color:"amber"},{cmd:"CLEAR_CACHE",label:s("mdm.cmdClearCache"),icon:ls,color:"purple"},{cmd:"SCREENSHOT",label:s("mdm.cmdScreenshot"),icon:Je,color:"cyan"},{cmd:"LOCK_DEVICE",label:s("mdm.cmdLockDevice"),icon:Rs,color:"slate"}].map(r=>e.jsxs("button",{disabled:!m||c.isPending,onClick:()=>v(r.cmd),className:"p-4 rounded-xl border border-slate-200 dark:border-dark-600 hover:border-primary-500 dark:hover:border-primary-500 transition-all text-center group disabled:opacity-50",children:[e.jsx("div",{className:`w-10 h-10 mx-auto rounded-lg bg-${r.color}-500/10 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform`,children:e.jsx(r.icon,{className:`w-5 h-5 text-${r.color}-500`})}),e.jsx("span",{className:"font-medium text-sm text-slate-900 dark:text-slate-100",children:r.label})]},r.cmd))}),c.isSuccess&&e.jsx("div",{className:"p-3 bg-green-500/10 border border-green-500/20 rounded-lg text-green-600 text-sm",children:s("common.saveSuccess")})]})]}),e.jsxs("div",{className:"glass-panel p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(ke,{className:"w-5 h-5 text-purple-500"}),s("mdm.remote.hotConfig")]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:s("mdm.remote.heartbeatInterval")}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("input",{type:"number",value:x.heartbeatInterval,onChange:r=>p({...x,heartbeatInterval:+r.target.value}),className:"input-field w-20"}),e.jsx("span",{className:"text-sm text-slate-500",children:s("time.second")})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:s("mdm.remote.logLevel")}),e.jsxs("select",{value:x.logLevel,onChange:r=>p({...x,logLevel:r.target.value}),className:"input-field mt-1",children:[e.jsx("option",{value:"DEBUG",children:"DEBUG"}),e.jsx("option",{value:"INFO",children:"INFO"}),e.jsx("option",{value:"WARN",children:"WARN"}),e.jsx("option",{value:"ERROR",children:"ERROR"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:s("mdm.remote.blacklistSync")}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("input",{type:"number",value:x.blacklistSyncInterval,onChange:r=>p({...x,blacklistSyncInterval:+r.target.value}),className:"input-field w-20"}),e.jsx("span",{className:"text-sm text-slate-500",children:s("time.second")})]})]}),e.jsx("button",{className:"w-full btn-primary mt-4",disabled:!m,onClick:h,children:s("mdm.remote.applyConfig")})]})]})]}),e.jsxs("div",{className:"glass-panel p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(xe,{className:"w-5 h-5 text-slate-500"}),s("mdm.commandHistory")]}),e.jsx("div",{className:"text-center py-8 text-slate-500",children:e.jsx("p",{className:"text-sm",children:s("common.comingSoon")})})]})]})},ot=()=>{var m;const{t:s}=S(),{data:d,isLoading:n}=De(!0),{data:c}=es();return n?e.jsx("div",{className:"flex justify-center p-12",children:e.jsx(J,{className:"animate-spin"})}):e.jsxs(j.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-display font-bold text-slate-900 dark:text-slate-100",children:s("devices.maintenance")}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:s("devices.maintenanceSubtitle")})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"glass-panel p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-red-500/10 rounded-lg",children:e.jsx(te,{className:"w-5 h-5 text-red-500"})}),e.jsx("h3",{className:"text-lg font-semibold",children:s("mdm.dashboard.aiPredictions")})]}),e.jsx("div",{className:"space-y-4",children:(m=d==null?void 0:d.atRiskDevices)==null?void 0:m.map(a=>e.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-dark-700/50 rounded-xl border border-slate-200 dark:border-dark-600",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("span",{className:"font-mono text-sm font-bold text-primary-600",children:a.deviceId}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-bold ${a.priority==="CRITICAL"?"bg-red-500 text-white":"bg-orange-500 text-white"}`,children:a.priority})]}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-3",children:a.description}),e.jsxs("div",{className:"flex justify-between items-center text-xs",children:[e.jsxs("span",{className:"text-slate-500",children:[s("mdm.dashboard.confidence"),": ",a.confidence,"%"]}),e.jsxs("span",{className:"font-medium text-red-500",children:[s("mdm.stats.anomalies"),": ",a.estimatedTimeToFailure,"d ",s("time.day")]})]})]},a.predictionId))})]}),e.jsxs("div",{className:"glass-panel p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-amber-500/10 rounded-lg",children:e.jsx(ae,{className:"w-5 h-5 text-amber-500"})}),e.jsx("h3",{className:"text-lg font-semibold",children:s("mdm.dashboard.maintenance")})]}),e.jsx("div",{className:"space-y-4",children:c==null?void 0:c.map(a=>e.jsxs("div",{className:"flex gap-4 p-4 hover:bg-slate-50 dark:hover:bg-dark-700/30 transition-colors rounded-xl",children:[e.jsxs("div",{className:"flex-shrink-0 w-12 text-center",children:[e.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase",children:new Date(a.scheduledDate).toLocaleString("default",{month:"short"})}),e.jsx("p",{className:"text-xl font-bold",children:new Date(a.scheduledDate).getDate()})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold text-sm",children:a.deviceId}),e.jsx("p",{className:"text-xs text-slate-500",children:s(`mdm.maintenanceTypes.${a.maintenanceType}`)}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs",children:[e.jsxs("span",{className:"bg-blue-100 text-blue-700 px-2 py-0.5 rounded",children:["$",a.estimatedCost]}),e.jsx("span",{className:"text-slate-400",children:a.assignedTo||"-"})]})]})]},a.scheduleId))})]})]})]})},mt=()=>{var L;const{t:s}=S(),{data:d,isLoading:n}=ss({}),[c,m]=b.useState("ALL"),[a,g]=b.useState(""),[o,x]=b.useState(!1),[p,v]=b.useState({startTime:"",endTime:"",levels:["ERROR","WARN","INFO"],maxLines:1e3}),h=["ALL","ERROR","WARN","INFO","DEBUG"],r=((L=d==null?void 0:d.data)==null?void 0:L.filter(u=>c==="ALL"||u.level===c))||[],N=()=>{x(!1)};return n?e.jsx("div",{className:"flex justify-center p-12",children:e.jsx(J,{className:"animate-spin"})}):e.jsxs(j.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-display font-bold text-slate-900 dark:text-slate-100",children:s("devices.logs")}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:s("devices.logsSubtitle")})]}),e.jsxs("button",{className:"btn-primary flex items-center gap-2",onClick:()=>x(!0),children:[e.jsx(Ne,{className:"w-4 h-4"}),s("mdm.logManagement.onDemandFetch")]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:h.map(u=>{var _,R;const T=u==="ALL"?((_=d==null?void 0:d.data)==null?void 0:_.length)||0:((R=d==null?void 0:d.data)==null?void 0:R.filter(B=>B.level===u).length)||0,$={ALL:"bg-blue-500/10 text-blue-600",ERROR:"bg-red-500/10 text-red-600",WARN:"bg-amber-500/10 text-amber-600",INFO:"bg-green-500/10 text-green-600",DEBUG:"bg-slate-500/10 text-slate-600"};return e.jsxs("button",{onClick:()=>m(u),className:`p-4 rounded-xl border-2 transition-all ${c===u?"border-primary-500 bg-primary-50 dark:bg-primary-950/20":"border-transparent bg-white dark:bg-dark-800"}`,children:[e.jsx("div",{className:`text-2xl font-bold ${$[u]}`,children:T}),e.jsx("div",{className:"text-sm text-slate-500",children:u})]},u)})}),e.jsx("div",{className:"glass-panel overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-dark-700/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase",children:s("common.time")}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase",children:s("mdm.deviceId")}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase",children:s("mdm.logManagement.level")}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase",children:s("mdm.logManagement.message")})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-dark-700",children:r.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-4 py-12 text-center",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-16 h-16 bg-slate-100 dark:bg-dark-700 rounded-full flex items-center justify-center mb-4",children:e.jsx(H,{className:"w-8 h-8 text-slate-400"})}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:s("mdm.noLogs")||"暂无日志记录"}),e.jsx("p",{className:"text-sm text-slate-400 dark:text-slate-500 mt-1",children:"请尝试调整筛选条件或时间范围"})]})})}):r.slice(0,50).map((u,T)=>e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-dark-700/30",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-mono text-slate-500",children:new Date(u.timestamp).toLocaleString()}),e.jsx("td",{className:"px-4 py-3 text-sm font-mono text-primary-600",children:u.deviceId}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold ${u.level==="ERROR"?"bg-red-500 text-white":u.level==="WARN"?"bg-amber-500 text-white":u.level==="INFO"?"bg-green-500 text-white":"bg-slate-500 text-white"}`,children:u.level})}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 dark:text-slate-400 max-w-md truncate",children:u.message})]},T))})]})})}),e.jsx(Q,{children:o&&e.jsxs(e.Fragment,{children:[e.jsx(j.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 z-40",onClick:()=>x(!1)}),e.jsx(j.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"fixed inset-0 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-dark-800 rounded-2xl p-6 max-w-lg w-full shadow-2xl",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[e.jsx(Ne,{className:"w-5 h-5 text-blue-500"}),s("mdm.logManagement.onDemandFetch")]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:s("mdm.deviceId")}),e.jsx("input",{type:"text",value:a,onChange:u=>g(u.target.value),className:"input-field mt-1",placeholder:"TERM-1001"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:s("mdm.logManagement.startTime")}),e.jsx("input",{type:"datetime-local",value:p.startTime,onChange:u=>v({...p,startTime:u.target.value}),className:"input-field mt-1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:s("mdm.logManagement.endTime")}),e.jsx("input",{type:"datetime-local",value:p.endTime,onChange:u=>v({...p,endTime:u.target.value}),className:"input-field mt-1"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:s("mdm.logManagement.maxLines")}),e.jsx("input",{type:"number",value:p.maxLines,onChange:u=>v({...p,maxLines:+u.target.value}),className:"input-field mt-1"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{className:"flex-1 btn-secondary",onClick:()=>x(!1),children:s("common.cancel")}),e.jsx("button",{className:"flex-1 btn-primary",onClick:N,children:s("mdm.logManagement.fetch")})]})]})})]})})]})},fe=[{path:"/devices",labelKey:"devices.dashboard",icon:gs},{path:"/devices/list",labelKey:"devices.deviceList",icon:we},{path:"/devices/health",labelKey:"devices.health",icon:Z},{path:"/devices/firmware",labelKey:"devices.firmware",icon:Ae},{path:"/devices/remote",labelKey:"devices.remote",icon:Ce},{path:"/devices/logs",labelKey:"devices.logs",icon:de},{path:"/devices/maintenance",labelKey:"devices.maintenance",icon:ae}];function Mt(){const{t:s}=S(),d=$s(),n=Ge(),c=a=>{switch(a){case"add":n("/devices/list?action=add_device");break;case"reboot_all":n("/devices/list?action=reboot_all");break;case"sync":break;case"activity":n("/devices/health");break;case"radar":n("/devices");break;case"settings":n("/devices/remote");break}},m=fe.find(a=>a.path==="."?d.pathname.endsWith("/devices")||d.pathname.endsWith("/devices/"):d.pathname.includes(`/devices/${a.path}`))||fe[0];return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"flex-shrink-0 mx-6 mt-6",children:[e.jsxs("div",{className:"mb-3 flex items-center gap-2 text-sm text-slate-500 dark:text-slate-400",children:[e.jsx("span",{children:s("common.deviceManagement")}),e.jsx(js,{className:"w-4 h-4"}),e.jsx("span",{className:"text-slate-900 dark:text-slate-100 font-medium",children:s(m.labelKey)})]}),e.jsx("div",{className:"flex items-center gap-1 overflow-x-auto border-b border-slate-200 dark:border-dark-600",children:fe.map(a=>e.jsxs(fs,{to:a.path,end:a.path==="/devices",className:({isActive:g})=>`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors text-sm font-medium whitespace-nowrap ${g?"border-primary-500 text-primary-600 dark:text-primary-400":"border-transparent text-slate-500 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-200"}`,children:[e.jsx(a.icon,{className:"w-4 h-4"}),e.jsx("span",{children:s(a.labelKey)})]},a.path))})]}),e.jsx(et,{onAction:c}),e.jsx("main",{className:"flex-1 overflow-auto px-6 pb-6 pt-4",children:e.jsxs(Os,{children:[e.jsx(U,{index:!0,element:e.jsx(rt,{})}),e.jsx(U,{path:"list",element:e.jsx(it,{})}),e.jsx(U,{path:"health",element:e.jsx(nt,{})}),e.jsx(U,{path:"firmware",element:e.jsx(ct,{})}),e.jsx(U,{path:"remote",element:e.jsx(dt,{})}),e.jsx(U,{path:"logs",element:e.jsx(mt,{})}),e.jsx(U,{path:"maintenance",element:e.jsx(ot,{})})]})})]})}export{Mt as default};
