import{c as Ae,j as e,X as M,S as fe,A as Y,m as f,L,C as Ve,E as Fe,a as se,R as P,b as ge,d as te,e as je,u as Ke,f as He,g as Ye,h as ze,i as We,k as Ge,l as Qe,n as H,o as Ne,p as Xe,q as qe}from"./index-DDsxxg9X.js";import{r as l,a as $}from"./vendor-wU5nTCpQ.js";import{u as Je,a as Ze,o as es,s as ss,n as ye,_ as ts}from"./schemas-BY4MnzfF.js";import{u as as}from"./useTransit-D1t4mbtl.js";import{u as z}from"./i18n-DUSRnG8c.js";import{U as ke}from"./upload-CZtO90B1.js";import{F as rs}from"./file-text-CnC33V-G.js";import{A as ae,B as re,L as ls,a as is,U as ve,H as ns}from"./unlock-Dh9oFfnz.js";import{M as cs}from"./more-horizontal-B12Wiafs.js";import{D as ds}from"./download-DWdn8jQ_.js";import{P as Z}from"./plus-v5ClPPLe.js";import{F as os}from"./filter-BlZzSLE3.js";import{W as xs,C as ms}from"./wifi-DBhw-TIT.js";import{Q as we}from"./qr-code-Dkyfl0AJ.js";import{S as ps}from"./smartphone-7AwpEwGx.js";import"./ui--kwEMLq0.js";import"./charts-BXxqj8Ps.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const us=Ae("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=Ae("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);function bs(){const[s,p]=l.useState(null);return{confirm:c=>new Promise(k=>{p({...c,isOpen:!0,onConfirm:()=>{k(!0),p(null)},onCancel:()=>{k(!1),p(null)}})}),dialogProps:s}}function fs({onClose:s,onSuccess:p}){const{t:d}=z(),[c,k]=l.useState("UPLOAD"),b=as(),h=async()=>{const i={UPLOAD:"OCR",OCR:"FACE_MATCH",FACE_MATCH:"VERIFY",VERIFY:"SUCCESS",SUCCESS:"SUCCESS"};try{if(c!=="SUCCESS"){await b.mutateAsync(c);const x=i[c];k(x),x==="SUCCESS"&&setTimeout(p,2e3)}}catch(x){console.error("KYC Error:",x)}},T=[{id:"UPLOAD",icon:ke,label:d("kyc.steps.upload")},{id:"OCR",icon:rs,label:d("kyc.steps.ocr")},{id:"FACE_MATCH",icon:us,label:d("kyc.steps.faceMatch")},{id:"VERIFY",icon:hs,label:d("kyc.steps.verify")}];return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsx("h2",{className:"text-xl font-display font-bold text-slate-900 dark:text-slate-100",children:d("kyc.title")}),e.jsx("button",{onClick:s,className:"p-2 hover:bg-slate-100 dark:hover:bg-dark-700 rounded-lg",children:e.jsx(M,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex justify-between mb-8 relative",children:[e.jsx("div",{className:"absolute top-1/2 left-0 w-full h-0.5 bg-slate-100 dark:bg-dark-800 -translate-y-1/2 -z-10"}),T.map((i,x)=>{const j=i.icon,a=c===i.id,n=T.findIndex(E=>E.id===c)>x||c==="SUCCESS";return e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center transition-all duration-500 ${a?"bg-primary-500 text-white ring-4 ring-primary-500/20":n?"bg-success text-white":"bg-white dark:bg-dark-800 text-slate-400 border border-slate-200 dark:border-dark-700"}`,children:n?e.jsx(fe,{className:"w-5 h-5"}):e.jsx(j,{className:"w-5 h-5"})}),e.jsx("span",{className:`text-[10px] font-medium uppercase tracking-wider ${a?"text-primary-600":"text-slate-500"}`,children:i.label})]},i.id)})]}),e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-6 bg-slate-50 dark:bg-dark-900/50 rounded-2xl border border-dashed border-slate-200 dark:border-dark-700",children:[e.jsxs(Y,{mode:"wait",children:[c==="UPLOAD"&&e.jsxs(f.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-primary-500/10 text-primary-600 rounded-2xl flex items-center justify-center mx-auto mb-4",children:e.jsx(ke,{className:"w-10 h-10"})}),e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-slate-100 mb-2",children:d("kyc.upload.title")}),e.jsx("p",{className:"text-sm text-slate-500 mb-6",children:d("kyc.upload.hint")}),e.jsx("button",{onClick:h,className:"btn-primary w-full max-w-xs",children:d("kyc.upload.selectFile")})]},"upload"),b.isPending&&e.jsxs(f.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center",children:[e.jsx(L,{className:"w-12 h-12 animate-spin text-primary-600 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400 font-medium",children:d(c==="OCR"?"kyc.loading.ocr":c==="FACE_MATCH"?"kyc.loading.faceMatch":"kyc.loading.verify")})]},"loading"),c==="SUCCESS"&&e.jsxs(f.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:"text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-success/10 text-success rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(fe,{className:"w-12 h-12"})}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-slate-100 mb-2",children:d("kyc.success.title")}),e.jsx("p",{className:"text-sm text-slate-500",children:d("kyc.success.description")})]},"success")]}),c!=="UPLOAD"&&c!=="SUCCESS"&&!b.isPending&&e.jsxs("button",{onClick:h,className:"btn-primary flex items-center gap-2 px-8 mt-6",children:[d("kyc.actions.continue")," ",e.jsx(Ve,{className:"w-4 h-4"})]})]})]})}function Ce({card:s,onTopUp:p,onSuspend:d,onActivate:c,onBlacklist:k,onReplace:b,onView:h,disabled:T=!1}){const{t:i}=z(),[x,j]=l.useState(!1),a=l.useRef(null);l.useEffect(()=>{const u=y=>{a.current&&!a.current.contains(y.target)&&j(!1)};return x&&document.addEventListener("mousedown",u),()=>{document.removeEventListener("mousedown",u)}},[x]);const n=u=>{u(),j(!1)},N=[{label:i("common.details"),icon:Fe,onClick:()=>n(h),show:!0,className:"text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-dark-700"},{label:i("cards.topUp"),icon:ae,onClick:()=>n(p),show:s.status==="ACTIVE",className:"text-success hover:bg-success/10"},{label:i("cards.suspend"),icon:se,onClick:()=>n(d),show:s.status==="ACTIVE",className:"text-warning hover:bg-warning/10"},{label:i("cards.activate"),icon:P,onClick:()=>n(c),show:s.status==="SUSPENDED",className:"text-success hover:bg-success/10"},{label:i("cards.actions.replace"),icon:P,onClick:()=>n(b),show:s.status!=="BLACKLISTED",className:"text-primary-600 dark:text-primary-400 hover:bg-primary-500/10"},{label:i("cards.blacklist"),icon:re,onClick:()=>n(k),show:s.status!=="BLACKLISTED",className:"text-error hover:bg-error/10"}].filter(u=>u.show);return e.jsxs("div",{className:"relative",ref:a,children:[e.jsx("button",{onClick:u=>{u.stopPropagation(),j(!x)},disabled:T,className:"p-2 hover:bg-slate-100 dark:hover:bg-dark-700 rounded-lg transition-colors text-slate-500 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-200 disabled:opacity-50","aria-label":i("cards.quickActions.title"),children:e.jsx(cs,{className:"w-4 h-4"})}),e.jsx(Y,{children:x&&e.jsx(f.div,{initial:{opacity:0,scale:.95,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-10},transition:{duration:.15},className:"absolute right-0 top-full mt-1 w-48 bg-white dark:bg-dark-800 rounded-xl shadow-xl border border-slate-200 dark:border-dark-600 z-50 overflow-hidden",onClick:u=>u.stopPropagation(),children:e.jsxs("div",{className:"p-1",children:[e.jsxs("div",{className:"px-3 py-2 text-xs font-medium text-slate-400 dark:text-slate-500 uppercase tracking-wider flex items-center justify-between",children:[i("cards.quickActions.title"),e.jsx("button",{onClick:()=>j(!1),className:"p-1 hover:bg-slate-100 dark:hover:bg-dark-700 rounded",children:e.jsx(M,{className:"w-3 h-3"})})]}),N.map((u,y)=>e.jsxs("button",{onClick:u.onClick,className:`w-full flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-lg transition-colors ${u.className}`,children:[e.jsx(u.icon,{className:"w-4 h-4"}),u.label]},y))]})})})]})}function gs({query:s,cards:p,isLoading:d=!1,onSelect:c,onClose:k,onQueryChange:b}){const{t:h}=z(),[T,i]=l.useState(!1),[x,j]=l.useState([]),a=l.useRef(null),n=l.useRef(null);l.useEffect(()=>{const r=localStorage.getItem("cardSearchHistory");r&&j(JSON.parse(r).slice(0,5))},[]),l.useEffect(()=>{const r=g=>{n.current&&!n.current.contains(g.target)&&i(!1)};return document.addEventListener("mousedown",r),()=>document.removeEventListener("mousedown",r)},[]);const E=l.useCallback(r=>{if(!r.trim())return;const g=[r,...x.filter(W=>W!==r)].slice(0,5);j(g),localStorage.setItem("cardSearchHistory",JSON.stringify(g))},[x]),N=r=>{E(s),c(r),i(!1)},u=r=>{var g;b(r),(g=a.current)==null||g.focus()},y=()=>{j([]),localStorage.removeItem("cardSearchHistory")},v=T&&(s.length>0||x.length>0),D=r=>{switch(r){case"ACTIVE":return"bg-success text-success-foreground";case"SUSPENDED":return"bg-warning text-warning-foreground";case"BLACKLISTED":return"bg-error text-white";case"EXPIRED":return"bg-slate-400 text-white";default:return"bg-slate-200 text-slate-700"}};return e.jsxs("div",{className:"relative flex-1 min-w-[300px]",ref:n,children:[e.jsx(ge,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400 dark:text-slate-500 pointer-events-none"}),e.jsx("input",{ref:a,type:"text",placeholder:h("cards.search.placeholder"),value:s,onChange:r=>b(r.target.value),onFocus:()=>i(!0),className:"w-full pl-10 pr-10 py-2 bg-slate-50 dark:bg-dark-900 border border-slate-200 dark:border-dark-600 rounded-lg text-slate-900 dark:text-slate-200 placeholder-slate-400 dark:placeholder-slate-500 focus:outline-none focus:border-primary-500/50 focus:ring-2 focus:ring-primary-500/20 transition-all"}),s&&e.jsx("button",{onClick:()=>{var r;b(""),(r=a.current)==null||r.focus()},className:"absolute right-3 top-1/2 -translate-y-1/2 p-1 hover:bg-slate-200 dark:hover:bg-dark-700 rounded transition-colors",children:e.jsx(M,{className:"w-4 h-4 text-slate-400"})}),e.jsx(Y,{children:v&&e.jsxs(f.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.15},className:"absolute left-0 right-0 top-full mt-2 bg-white dark:bg-dark-800 rounded-xl shadow-xl border border-slate-200 dark:border-dark-600 z-50 overflow-hidden max-h-80 overflow-y-auto",children:[s.length>0&&e.jsx("div",{className:"p-2",children:d?e.jsxs("div",{className:"flex items-center justify-center py-4 text-slate-500",children:[e.jsx(L,{className:"w-5 h-5 animate-spin mr-2"}),h("common.loading")]}):p.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-2 py-1 text-xs font-medium text-slate-400 uppercase tracking-wider",children:h("cards.search.results",{count:p.length})}),p.slice(0,8).map(r=>e.jsxs("button",{onClick:()=>N(r),className:"w-full flex items-center gap-3 px-3 py-2 hover:bg-slate-50 dark:hover:bg-dark-700 rounded-lg transition-colors text-left",children:[e.jsx("div",{className:"p-2 bg-slate-100 dark:bg-dark-600 rounded-lg",children:e.jsx(te,{className:"w-4 h-4 text-slate-500"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-mono text-sm text-slate-900 dark:text-slate-200 truncate",children:r.number}),e.jsxs("p",{className:"text-xs text-slate-500 truncate",children:[h(`cards.types.${r.type}`)," â€¢ Â¥",r.balance.toLocaleString()]})]}),e.jsx("span",{className:`px-2 py-0.5 rounded-full text-[10px] font-bold uppercase ${D(r.status)}`,children:h(`cards.status.${r.status}`)})]},r.id))]}):e.jsxs("div",{className:"flex flex-col items-center py-6 text-slate-500",children:[e.jsx(ge,{className:"w-8 h-8 mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:h("cards.search.noResults")})]})}),s.length===0&&x.length>0&&e.jsxs("div",{className:"p-2",children:[e.jsxs("div",{className:"flex items-center justify-between px-2 py-1",children:[e.jsxs("span",{className:"text-xs font-medium text-slate-400 uppercase tracking-wider flex items-center gap-1",children:[e.jsx(je,{className:"w-3 h-3"}),h("cards.search.recentSearches")]}),e.jsx("button",{onClick:y,className:"text-xs text-slate-400 hover:text-slate-600 transition-colors",children:h("common.clear")})]}),x.map((r,g)=>e.jsxs("button",{onClick:()=>u(r),className:"w-full flex items-center gap-3 px-3 py-2 hover:bg-slate-50 dark:hover:bg-dark-700 rounded-lg transition-colors text-left",children:[e.jsx(je,{className:"w-4 h-4 text-slate-400"}),e.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-300",children:r})]},g))]})]})})]})}const Se=s=>{switch(s){case"ACTIVE":return"bg-success/15 text-success border-success/30";case"SUSPENDED":return"bg-warning/15 text-warning border-warning/30";case"BLACKLISTED":return"bg-error/15 text-error border-error/30";case"EXPIRED":return"bg-slate-200 dark:bg-slate-700 text-slate-500 dark:text-slate-400 border-slate-300 dark:border-slate-600";default:return"bg-slate-100 text-slate-600 border-slate-200"}},Ee=(s,p)=>{if(!(s!=null&&s.type)||!s.type.startsWith("TOURIST_"))return null;const d=new Date(s.expiresAt),c=new Date,k=d.getTime()-c.getTime();if(k<=0)return{text:p("cards.countdown.expired"),isExpired:!0};const b=Math.floor(k/(1e3*60*60)),h=Math.floor(b/24);return h>0?{text:p("cards.countdown.daysLeft",{days:h}),isExpired:!1,progress:b/(parseInt(s.type.replace("TOURIST_","").replace("D",""))*24)}:{text:p("cards.countdown.hoursLeft",{hours:b}),isExpired:!1,progress:b/24}},js=["All Types","STANDARD","STUDENT","SENIOR","STAFF","TOURIST_1D","TOURIST_3D","TOURIST_7D","PERIOD"],Ns=["All Status","ACTIVE","SUSPENDED","BLACKLISTED","EXPIRED"],ee=es({type:ts(["STANDARD","STUDENT","SENIOR","STAFF","TOURIST_1D","TOURIST_3D","TOURIST_7D","PERIOD"]),initialBalance:ye().min(0).max(1e4),validityYears:ye().min(1).max(10),notes:ss().optional()});function Os(){var be;const{t:s}=z(),[p,d]=l.useState("All Types"),[c,k]=l.useState("All Status"),[b,h]=l.useState(""),[T,i]=l.useState(!1),[x,j]=l.useState("list"),[a,n]=l.useState(null),[E,N]=l.useState(null),[u,y]=l.useState(!1),[v,D]=l.useState(0),[r,g]=l.useState("ALIPAY"),[W,le]=l.useState(!1),[Te,G]=l.useState(!1),[De,Ie]=l.useState(!1),[B,ie]=l.useState(!1),[Le,ys]=l.useState("MOCK-QR-"+Math.random().toString(36).substring(7)),[A,ne]=l.useState(null),[O,Re]=l.useState(!1),ce=5,{confirm:_,setLoading:de,dialogProps:Pe}=Ke(),{trackAction:oe}=He();bs(),l.useEffect(()=>{oe({type:"view_page",page:"/cards",timestamp:Date.now()})},[oe]);const{data:w,isLoading:xe,isError:Ue,error:me,refetch:$e}=Ye({type:p==="All Types"?void 0:p,status:c==="All Status"?void 0:c,search:b||void 0}),Q=ze(),C=We(),X=Ge(),{data:q}=Qe((a==null?void 0:a.id)||""),{register:V,handleSubmit:Me,formState:{errors:R,isSubmitting:pe},reset:Be}=Je({resolver:Ze(ee),defaultValues:{type:"STANDARD",initialBalance:0,validityYears:5,notes:""}}),Oe=async t=>{var m,U;if((t.type==="SENIOR"||t.type==="STUDENT"||t.type==="STANDARD")&&!De){G(!0);return}try{const I=await Q.mutateAsync(t);if(I&&I.id){const F=I.id;ne(F),setTimeout(()=>ne(null),1e4)}i(!1),Be()}catch(I){N(((U=(m=I.response)==null?void 0:m.data)==null?void 0:U.message)||s("cards.issueError"))}},S=async(t,o)=>{var U,I,F;const m=(U=w==null?void 0:w.data)==null?void 0:U.find(K=>K.id===t);if(!(o!=="ACTIVE"&&!await _({type:o==="BLACKLISTED"?"danger":"warning",title:s(o==="BLACKLISTED"?"cards.confirmBlacklist":"cards.confirmSuspend"),message:s(o==="BLACKLISTED"?"cards.blacklistWarning":"cards.suspendWarning"),details:m?[{label:s("cards.cardNumber"),value:m.number},{label:s("cards.type"),value:s(`cards.types.${m.type}`)}]:[],confirmText:s("common.confirm"),cancelText:s("common.cancel"),countdown:o==="BLACKLISTED"?5:3}))){N(null),de(!0);try{await C.mutateAsync({id:t,data:{status:o}})}catch(K){N(((F=(I=K.response)==null?void 0:I.data)==null?void 0:F.message)||s("cards.updateError"))}finally{de(!1)}}},_e=async()=>{var t,o;if(!(!a||v<=0)){if(v>1e3){N(s("cards.topUpLimitExceeded"));return}if(a.balance+v>5e3){N(s("cards.balanceLimitExceeded"));return}N(null);try{await X.mutateAsync({id:a.id,data:{amount:v}}),y(!1),D(0),le(!0),setTimeout(()=>le(!1),5e3)}catch(m){N(((o=(t=m.response)==null?void 0:t.data)==null?void 0:o.message)||s("cards.topUpError"))}}};((w==null?void 0:w.data)||[]).reduce((t,o)=>(t[o.status]=(t[o.status]||0)+1,t),{});const ue=((w==null?void 0:w.data)||[]).filter(t=>t.balance<ce).length,J=[...(w==null?void 0:w.data)||[]].filter(t=>!O||t.balance<ce).sort((t,o)=>t.id===A?-1:o.id===A?1:0),he=(q==null?void 0:q.data)||[];return xe?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(L,{className:"w-8 h-8 animate-spin text-primary-600"})}):Ue?e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 gap-4",children:[e.jsx(H,{className:"w-12 h-12 text-error"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:me instanceof Error?me.message:s("common.loadError")}),e.jsxs("button",{onClick:()=>$e(),className:"btn-secondary flex items-center gap-2",children:[e.jsx(P,{className:"w-4 h-4"}),s("common.retry")]})]}):e.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"space-y-6","data-help":"card-grid",children:[E&&e.jsxs("div",{className:"p-4 bg-error/10 border border-error/20 rounded-lg flex items-center gap-3 text-error",children:[e.jsx(H,{className:"w-5 h-5"}),e.jsx("span",{children:E}),e.jsx("button",{onClick:()=>N(null),className:"ml-auto text-sm hover:underline",children:s("common.dismiss")})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-display font-bold text-slate-900 dark:text-slate-100",children:s("cards.title")}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:s("cards.subtitle")})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"flex bg-slate-100 dark:bg-dark-900 rounded-lg p-1 border border-slate-200 dark:border-dark-600",children:[e.jsx("button",{onClick:()=>j("grid"),className:`p-2 rounded-md transition-colors ${x==="grid"?"bg-white dark:bg-dark-700 text-slate-900 dark:text-slate-200 shadow-sm":"text-slate-500 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-200"}`,children:e.jsx(ls,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>j("list"),className:`p-2 rounded-md transition-colors ${x==="list"?"bg-white dark:bg-dark-700 text-slate-900 dark:text-slate-200 shadow-sm":"text-slate-500 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-200"}`,children:e.jsx(is,{className:"w-4 h-4"})})]}),e.jsxs("button",{className:"btn-secondary flex items-center gap-2",children:[e.jsx(ds,{className:"w-4 h-4"}),s("common.export")]}),e.jsxs("button",{onClick:()=>i(!0),className:"btn-primary flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4"}),s("cards.issueCard")]})]})]}),e.jsx("div",{className:"flex flex-col gap-6","data-help":"search-filter",children:e.jsx("div",{className:"glass-panel p-4",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsx(gs,{query:b,cards:J,isLoading:xe,onSelect:t=>n(t),onClose:()=>{},onQueryChange:h}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(os,{className:"w-5 h-5 text-slate-400"}),e.jsx("select",{value:p,onChange:t=>d(t.target.value),className:"px-4 py-2 bg-slate-50 dark:bg-dark-900 border border-slate-200 dark:border-dark-600 rounded-lg text-slate-900 dark:text-slate-200 focus:outline-none focus:border-primary-500/50",children:js.map(t=>e.jsx("option",{value:t,children:s(t==="All Types"?"common.allTypes":`cards.types.${t}`)},t))}),e.jsx("select",{value:c,onChange:t=>k(t.target.value),className:"px-4 py-2 bg-slate-50 dark:bg-dark-900 border border-slate-200 dark:border-dark-600 rounded-lg text-slate-900 dark:text-slate-200 focus:outline-none focus:border-primary-500/50",children:Ns.map(t=>e.jsx("option",{value:t,children:s(t==="All Status"?"common.allStatus":`cards.status.${t}`)},t))}),e.jsxs("button",{onClick:()=>Re(!O),className:`px-3 py-2 rounded-lg font-medium text-sm transition-all flex items-center gap-2 ${O?"bg-warning/15 text-warning border border-warning/30":"bg-slate-100 dark:bg-dark-700 text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-dark-600"}`,children:[e.jsx(H,{className:"w-4 h-4"}),s("cards.lowBalance"),ue>0&&e.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-[10px] font-bold ${O?"bg-warning text-white":"bg-warning/20 text-warning"}`,children:ue})]})]})]})})}),x==="grid"?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:J.map((t,o)=>e.jsxs(f.div,{layout:!0,onClick:()=>n(t),initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1,boxShadow:t.id===A?["0 0 0 0px rgba(6, 182, 212, 0)","0 0 20px 2px rgba(6, 182, 212, 0.4)","0 0 0 0px rgba(6, 182, 212, 0)"]:"none"},transition:{delay:o*.05,boxShadow:{duration:2,repeat:1/0,ease:"easeInOut"}},className:`glass-panel p-6 cursor-pointer hover:border-primary-500/50 transition-all duration-300 relative group overflow-hidden ${t.id===A?"border-primary-500 ring-1 ring-primary-500/20 shadow-lg shadow-primary-500/10":""}`,children:[t.id===A&&e.jsx("div",{className:"absolute top-0 right-0 p-1 px-2 bg-primary-500 text-[8px] font-bold text-white uppercase tracking-tighter rounded-bl-lg animate-pulse z-10",children:"New"}),e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("div",{className:`p-3 rounded-xl ${t.status==="ACTIVE"?"bg-success/10":t.status==="SUSPENDED"?"bg-warning/10":"bg-error/10"}`,children:e.jsx(te,{className:`w-6 h-6 ${t.status==="ACTIVE"?"text-success":t.status==="SUSPENDED"?"text-warning":"text-error"}`})}),e.jsx("div",{onClick:m=>m.stopPropagation(),children:e.jsx(Ce,{card:t,onView:()=>n(t),onTopUp:()=>{n(t),y(!0)},onSuspend:()=>S(t.id,"SUSPENDED"),onActivate:()=>S(t.id,"ACTIVE"),onBlacklist:()=>S(t.id,"BLACKLISTED"),onReplace:()=>n(t),disabled:C.isPending})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:s("cards.cardNumber")}),e.jsx("p",{className:"font-mono text-lg text-slate-900 dark:text-slate-200 tracking-wider",children:t.number})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:s("cards.type")}),e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-slate-100 dark:bg-dark-700 text-slate-600 dark:text-slate-300",children:s(`cards.types.${t.type}`)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:s("common.status")}),e.jsxs("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold border ${Se(t.status)}`,children:[e.jsx("span",{className:`w-1.5 h-1.5 rounded-full mr-1.5 ${t.status==="ACTIVE"?"bg-success":t.status==="SUSPENDED"?"bg-warning":t.status==="BLACKLISTED"?"bg-error":"bg-slate-400"}`}),s(`cards.status.${t.status}`)]}),(()=>{const m=Ee(t,s);return m?e.jsx("div",{className:`mt-1 text-[10px] font-medium ${m.isExpired?"text-error":"text-primary-600 dark:text-primary-400"}`,children:m.text}):null})()]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:s("cards.balance")}),e.jsxs("p",{className:"text-2xl font-display font-bold text-slate-900 dark:text-slate-100",children:["Â¥",t.balance.toLocaleString()]})]}),e.jsx("div",{className:"pt-4 border-t border-slate-200 dark:border-dark-600",children:e.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500",children:[e.jsxs("span",{children:[s("cards.issued"),": ",t.issuedAt]}),e.jsxs("span",{children:[s("cards.expires"),": ",t.expiresAt]})]})}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[t.status==="ACTIVE"?e.jsxs("button",{onClick:m=>{m.stopPropagation(),S(t.id,"SUSPENDED")},disabled:C.isPending,className:"flex-1 py-2 text-xs font-medium text-warning bg-warning/10 hover:bg-warning/20 rounded-lg transition-colors flex items-center justify-center gap-1 disabled:opacity-50",children:[e.jsx(se,{className:"w-3 h-3"}),s("cards.suspend")]}):e.jsxs("button",{onClick:m=>{m.stopPropagation(),S(t.id,"ACTIVE")},disabled:C.isPending,className:"flex-1 py-2 text-xs font-medium text-success bg-success/10 hover:bg-success/20 rounded-lg transition-colors flex items-center justify-center gap-1 disabled:opacity-50",children:[e.jsx(ve,{className:"w-3 h-3"}),s("cards.activate")]}),e.jsxs("button",{onClick:m=>{m.stopPropagation(),S(t.id,"BLACKLISTED")},disabled:C.isPending,className:"flex-1 py-2 text-xs font-medium text-error bg-error/10 hover:bg-error/20 rounded-lg transition-colors flex items-center justify-center gap-1 disabled:opacity-50",children:[e.jsx(re,{className:"w-3 h-3"}),s("cards.blacklist")]})]})]},t.id))}):e.jsx("div",{className:"glass-panel overflow-hidden",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-slate-50/50 dark:bg-dark-900/50 text-xs uppercase text-slate-500 dark:text-slate-400",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 font-medium",children:s("cards.cardNumber")}),e.jsx("th",{className:"px-6 py-4 font-medium",children:s("cards.type")}),e.jsx("th",{className:"px-6 py-4 font-medium",children:s("common.status")}),e.jsx("th",{className:"px-6 py-4 font-medium text-right",children:s("cards.balance")}),e.jsx("th",{className:"px-6 py-4 font-medium",children:s("cards.issued")}),e.jsx("th",{className:"px-6 py-4 font-medium",children:s("cards.lastUsed")}),e.jsx("th",{className:"px-6 py-4 font-medium"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 dark:divide-dark-600",children:J.map(t=>e.jsxs(f.tr,{layout:!0,onClick:()=>n(t),animate:{backgroundColor:t.id===A?["rgba(6,182,212,0.05)","rgba(6,182,212,0.15)","rgba(6,182,212,0.05)"]:"rgba(0,0,0,0)"},transition:t.id===A?{duration:2,repeat:1/0}:{duration:.2},className:`group hover:bg-slate-50 dark:hover:bg-dark-900/50 cursor-pointer transition-colors ${t.id===A?"ring-1 ring-inset ring-primary-500/30":""}`,children:[e.jsx("td",{className:"px-6 py-4 font-mono text-slate-900 dark:text-slate-200",children:e.jsxs("div",{className:"flex items-center gap-2",children:[t.number,t.id===A&&e.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-[8px] font-bold bg-primary-500 text-white uppercase tracking-tighter",children:"New"})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-slate-100 dark:bg-dark-700 text-slate-600 dark:text-slate-300",children:s(`cards.types.${t.type}`)})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsxs("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold border ${Se(t.status)}`,children:[e.jsx("span",{className:`w-1.5 h-1.5 rounded-full mr-1.5 ${t.status==="ACTIVE"?"bg-success":t.status==="SUSPENDED"?"bg-warning":t.status==="BLACKLISTED"?"bg-error":"bg-slate-400"}`}),s(`cards.status.${t.status}`)]}),(()=>{const o=Ee(t,s);return o?e.jsx("div",{className:`mt-1 text-[10px] font-medium ${o.isExpired?"text-error":"text-primary-600 dark:text-primary-400"}`,children:o.text}):null})()]}),e.jsxs("td",{className:"px-6 py-4 text-right font-mono text-slate-900 dark:text-slate-200",children:["Â¥",t.balance.toLocaleString()]}),e.jsx("td",{className:"px-6 py-4 text-slate-500 dark:text-slate-400 text-sm",children:t.issuedAt}),e.jsx("td",{className:"px-6 py-4 text-slate-500 dark:text-slate-400 text-sm",children:t.lastUsed}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"flex gap-1 justify-end",onClick:o=>o.stopPropagation(),children:e.jsx(Ce,{card:t,onView:()=>n(t),onTopUp:()=>{n(t),y(!0)},onSuspend:()=>S(t.id,"SUSPENDED"),onActivate:()=>S(t.id,"ACTIVE"),onBlacklist:()=>S(t.id,"BLACKLISTED"),onReplace:()=>n(t),disabled:C.isPending})})})]},t.id))})]})}),T&&$.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[100] flex items-center justify-center p-4",onClick:t=>{t.target===t.currentTarget&&i(!1)},children:e.jsxs(f.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"glass-panel w-full max-w-2xl p-6 bg-white dark:bg-dark-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-display font-bold text-slate-900 dark:text-slate-100",children:s("cards.issueNewCard")}),e.jsx("button",{onClick:()=>i(!1),className:"text-slate-400 hover:text-slate-500 dark:hover:text-slate-300 transition-colors",children:e.jsx(M,{className:"w-5 h-5"})})]}),E&&e.jsxs("div",{className:"mb-4 p-3 bg-error/10 border border-error/20 rounded-lg flex items-center gap-2 text-error text-sm",children:[e.jsx(H,{className:"w-4 h-4"}),e.jsx("span",{children:E})]}),e.jsxs("form",{onSubmit:Me(Oe),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"grid grid-cols-2 gap-3",children:["STANDARD","STUDENT","SENIOR","TOURIST_1D","TOURIST_3D","TOURIST_7D","PERIOD"].map(t=>e.jsxs("label",{className:`relative flex items-center p-4 border rounded-xl cursor-pointer transition-all hover:bg-slate-50 dark:hover:bg-dark-900 ${ee.shape.type.parse(t)===ee.shape.type.parse(t),""} border-slate-200 dark:border-dark-700 has-[:checked]:border-primary-500 has-[:checked]:bg-primary-500/5 has-[:checked]:ring-1 has-[:checked]:ring-primary-500`,children:[e.jsx("input",{type:"radio",...V("type"),value:t,className:"sr-only"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"font-bold text-slate-900 dark:text-slate-100",children:s(`cards.types.${t}`)}),e.jsx("span",{className:"text-sm font-mono font-bold text-primary-600",children:s(`cards.prices.${t}`)})]}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:s(`cards.perks.${t}`)})]}),e.jsx("div",{className:"ml-3 w-5 h-5 rounded-full border-2 border-slate-300 dark:border-dark-600 flex items-center justify-center peer-checked:border-primary-500",children:e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-primary-500 scale-0 transition-transform has-[:checked]:scale-100"})})]},t))}),R.type&&e.jsx("p",{className:"mt-1 text-sm text-error",children:R.type.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-slate-500 dark:text-slate-400 mb-2",children:[s("cards.initialBalance")," (Â¥)"]}),e.jsx("input",{type:"number",...V("initialBalance",{valueAsNumber:!0}),className:"input-field",placeholder:"0"}),R.initialBalance&&e.jsx("p",{className:"mt-1 text-sm text-error",children:R.initialBalance.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-slate-500 dark:text-slate-400 mb-2",children:[s("cards.validityPeriod")," (",s("common.years"),")"]}),e.jsx("input",{type:"number",...V("validityYears",{valueAsNumber:!0}),className:"input-field"}),R.validityYears&&e.jsx("p",{className:"mt-1 text-sm text-error",children:R.validityYears.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-500 dark:text-slate-400 mb-2",children:s("cards.notes")}),e.jsx("textarea",{...V("notes"),className:"input-field h-24 resize-none",placeholder:s("cards.notesPlaceholder")})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>i(!1),className:"flex-1 btn-secondary",children:s("common.cancel")}),e.jsxs("button",{type:"submit",disabled:pe||Q.isPending,className:"flex-1 btn-primary flex items-center justify-center gap-2 disabled:opacity-50",children:[(pe||Q.isPending)&&e.jsx(L,{className:"w-4 h-4 animate-spin"}),s("cards.issueCard")]})]})]})]})}),document.body),a&&$.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[100] flex justify-end",onClick:()=>n(null),children:e.jsx(f.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:25,stiffness:200},className:"w-full max-w-2xl bg-white dark:bg-dark-800 h-full border-l border-slate-200 dark:border-dark-600 shadow-2xl overflow-y-auto",onClick:t=>t.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-display font-bold text-slate-900 dark:text-slate-100",children:s("cards.details")}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 font-mono mt-1",children:a.number})]}),e.jsx("button",{onClick:()=>n(null),className:"p-2 hover:bg-slate-100 dark:hover:bg-dark-700 rounded-lg transition-colors text-slate-500 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-200"})]}),e.jsxs("div",{className:"mb-8 overflow-hidden rounded-2xl bg-gradient-to-br from-slate-900 to-slate-800 p-6 text-white shadow-xl relative preserve-3d",children:[e.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10",children:e.jsx(te,{className:"w-24 h-24"})}),e.jsxs("div",{className:"flex flex-col h-full justify-between",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-10 h-7 bg-amber-400 rounded-md opacity-80"}),e.jsx(xs,{className:"w-5 h-5 rotate-90"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-[10px] uppercase tracking-widest opacity-60",children:"Transit Card"}),e.jsx("p",{className:"text-sm font-bold tracking-wider",children:s(`cards.types.${a.type}`)})]})]}),e.jsx("div",{className:"mt-8",children:e.jsx("p",{className:"text-xl font-mono tracking-[0.3em] font-medium drop-shadow-md",children:a.number.replace(/(.{4})/g,"$1 ")})}),e.jsxs("div",{className:"mt-6 flex justify-between items-end",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[8px] uppercase tracking-widest opacity-50 mb-1",children:"Card Holder"}),e.jsx("p",{className:"text-xs font-medium uppercase",children:"DE CARD GUEST"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-[8px] uppercase tracking-widest opacity-50 mb-1",children:"Expires End"}),e.jsx("p",{className:"text-xs font-mono",children:a.expiresAt.split(" ")[0]})]})]})]})]}),a.membershipLevel&&e.jsxs("div",{className:"mb-6 p-4 rounded-xl bg-gradient-to-r from-primary-500/10 to-transparent border border-primary-500/20 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-white dark:bg-dark-700 shadow-sm",children:e.jsx("span",{className:"text-xl",children:a.membershipLevel==="GOLD"?"ðŸ¥‡":a.membershipLevel==="SILVER"?"ðŸ¥ˆ":"ðŸ¥‰"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-primary-600 dark:text-primary-400 font-medium uppercase tracking-wider",children:s("cards.membership.level")}),e.jsx("p",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:a.membershipLevel})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:s("cards.membership.ecoPoints")}),e.jsx("p",{className:"text-lg font-mono font-bold text-primary-600 dark:text-primary-400",children:(be=a.ecoPoints)==null?void 0:be.toLocaleString()})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-8",children:[e.jsxs("div",{className:"p-4 bg-slate-50/50 dark:bg-dark-900/50 rounded-xl border border-slate-200 dark:border-dark-700",children:[e.jsx("p",{className:"text-sm text-slate-500 mb-1",children:s("cards.balance")}),e.jsxs("p",{className:"text-2xl font-display font-bold text-slate-900 dark:text-slate-100",children:["Â¥",a.balance.toLocaleString()]})]}),e.jsxs("div",{className:"p-4 bg-slate-50/50 dark:bg-dark-900/50 rounded-xl border border-slate-200 dark:border-dark-700",children:[e.jsx("p",{className:"text-sm text-slate-500 mb-1",children:s("common.status")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${a.status==="ACTIVE"?"bg-success":a.status==="SUSPENDED"?"bg-warning":"bg-error"}`}),e.jsx("span",{className:"text-lg font-medium text-slate-900 dark:text-slate-200",children:s(`cards.status.${a.status}`)})]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"relative flex gap-1 p-1 bg-slate-100 dark:bg-dark-900 rounded-xl mb-4",children:[e.jsx(f.div,{layoutId:"detailTab",className:"absolute inset-y-1 w-[calc(50%-2px)] bg-white dark:bg-dark-700 rounded-lg shadow-sm",initial:!1,animate:{x:B?"calc(100% + 4px)":"4px"},transition:{type:"spring",stiffness:400,damping:30}}),e.jsxs("button",{onClick:()=>ie(!1),className:`relative flex-1 flex items-center justify-center gap-2 py-2.5 rounded-lg text-sm font-medium transition-colors z-10 ${B?"text-slate-500 hover:text-slate-700":"text-primary-600 dark:text-primary-400"}`,children:[e.jsx(we,{className:"w-4 h-4"})," QR Token"]}),e.jsxs("button",{onClick:()=>ie(!0),className:`relative flex-1 flex items-center justify-center gap-2 py-2.5 rounded-lg text-sm font-medium transition-colors z-10 ${B?"text-primary-600 dark:text-primary-400":"text-slate-500 hover:text-slate-700"}`,children:[e.jsx(ms,{className:"w-4 h-4"})," Chip Data"]})]}),e.jsx(Y,{mode:"wait",children:B?e.jsxs(f.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"p-6 bg-slate-900 border border-slate-700 rounded-2xl text-success font-mono text-xs overflow-hidden h-56",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4 text-success/60 border-b border-success/20 pb-2",children:[e.jsx(Ne,{className:"w-4 h-4"})," NFC Chip Data (AES-256 Mocked)"]}),e.jsxs("div",{className:"space-y-1 opacity-80 overflow-y-auto",children:[e.jsx("p",{children:"0000: 44 45 20 43 41 52 44 20 4e 46 43 20 54 4f 4b 45"}),e.jsx("p",{children:"0010: 4e 20 56 32 2e 30 20 53 45 43 55 52 45 20 44 41"}),e.jsx("p",{children:"0020: 54 41 20 53 54 52 45 41 4d 20 58 58 58 58 58 58"}),e.jsx("p",{children:"0030: 4c 4f 43 4b 45 44 20 53 45 43 54 4f 52 20 30 37"}),e.jsxs("p",{className:"animate-pulse",children:[">"," DECRYPTING KEYS..."]}),e.jsxs("p",{className:"text-amber-500",children:[">"," [WARN] ACCESSING PROTECTED MEMORY"]}),e.jsxs("p",{children:["0040: ",Math.random().toString(16).substring(2,10).toUpperCase()," 00 00 FF ",Math.random().toString(16).substring(2,10).toUpperCase()]})]})]},"chip"):e.jsxs(f.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"flex flex-col items-center p-6 bg-white dark:bg-dark-800 rounded-2xl border border-slate-200 dark:border-dark-700",children:[e.jsx("div",{className:"p-4 bg-white rounded-xl shadow-inner border-2 border-slate-100",children:e.jsxs("div",{className:"w-40 h-40 bg-slate-100 flex items-center justify-center relative rounded-md overflow-hidden",children:[e.jsx(we,{className:"w-32 h-32 text-slate-800"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-white/10 to-transparent"}),e.jsx(f.div,{animate:{y:[0,160,0]},transition:{duration:3,repeat:1/0,ease:"linear"},className:"absolute top-0 left-0 w-full h-1 bg-primary-500 shadow-[0_0_15px_rgba(6,182,212,0.8)]"})]})}),e.jsx("p",{className:"mt-4 text-[10px] font-mono text-slate-400 uppercase tracking-widest",children:"Dynamic Token Refreshed"}),e.jsx("p",{className:"text-xs font-mono text-primary-600 font-bold mt-1",children:Le})]},"qr")})]}),a.carbonReduced&&e.jsxs("div",{className:"mb-8 p-4 bg-success/5 border border-success/20 rounded-xl flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-success/10 flex items-center justify-center text-success",children:e.jsx(P,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-success-600 font-medium",children:s("cards.membership.carbonReduced")}),e.jsxs("p",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:[a.carbonReduced," kg"]})]})]}),e.jsx("div",{className:"text-success text-sm font-medium",children:"+1.2kg this month"})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 mb-8",children:[a.status==="ACTIVE"&&e.jsxs("button",{onClick:()=>y(!0),className:"btn-primary flex items-center gap-2",children:[e.jsx(ae,{className:"w-4 h-4"}),s("cards.topUp")]}),a.status==="EXPIRED"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>{},className:"btn-primary flex items-center gap-2",children:[e.jsx(P,{className:"w-4 h-4"}),s("cards.actions.renew")]}),e.jsxs("button",{onClick:()=>{},className:"btn-secondary flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4"}),s("cards.actions.replace")]})]}),a.status==="ACTIVE"&&e.jsxs("button",{onClick:async()=>{await _({type:"warning",title:s("cards.suspend"),message:s("cards.actions.suspendConfirm"),details:[{label:s("cards.cardNumber"),value:a.number},{label:s("cards.balance"),value:`Â¥${a.balance.toFixed(2)}`}]})&&S(a.id,"SUSPENDED")},disabled:C.isPending,className:"btn-secondary flex items-center gap-2",children:[C.isPending?e.jsx(L,{className:"w-4 h-4 animate-spin"}):e.jsx(se,{className:"w-4 h-4"}),s("cards.suspend")]}),a.status==="SUSPENDED"&&e.jsxs("button",{onClick:async()=>{await _({type:"info",title:s("cards.activate"),message:s("cards.actions.activateConfirm"),details:[{label:s("cards.cardNumber"),value:a.number}]})&&S(a.id,"ACTIVE")},disabled:C.isPending,className:"btn-secondary flex items-center gap-2",children:[C.isPending?e.jsx(L,{className:"w-4 h-4 animate-spin"}):e.jsx(ve,{className:"w-4 h-4"}),s("cards.activate")]}),a.status!=="BLACKLISTED"&&e.jsxs("button",{onClick:async()=>{await _({type:"danger",title:s("cards.blacklist"),message:s("cards.actions.blacklistConfirm"),details:[{label:s("cards.cardNumber"),value:a.number},{label:s("cards.balance"),value:`Â¥${a.balance.toFixed(2)}`}],riskWarning:s("cards.actions.blacklistWarning"),countdown:3})&&S(a.id,"BLACKLISTED")},disabled:C.isPending,className:"btn-secondary flex items-center gap-2 text-error border-error/30 hover:bg-error/10",children:[C.isPending?e.jsx(L,{className:"w-4 h-4 animate-spin"}):e.jsx(re,{className:"w-4 h-4"}),s("cards.blacklist")]})]}),e.jsxs("div",{className:"mb-8 p-4 bg-slate-50 dark:bg-dark-900/50 rounded-xl border border-dashed border-slate-300 dark:border-dark-700",children:[e.jsxs("h4",{className:"text-sm font-bold text-slate-700 dark:text-slate-300 mb-2 flex items-center gap-2",children:[e.jsx(Ne,{className:"w-4 h-4 text-primary-500"}),s("cards.lifecycle.title")]}),e.jsxs("div",{className:"text-xs text-slate-500 space-y-1",children:[e.jsxs("p",{children:["â€¢ ",s("cards.issued"),": ",a.issuedAt," (",s("cards.lifecycle.issued"),")"]}),a.status==="SUSPENDED"&&e.jsxs("p",{className:"text-warning",children:["â€¢ ",s("cards.lifecycle.suspended")]}),a.status==="BLACKLISTED"&&e.jsxs("p",{className:"text-error",children:["â€¢ ",s("cards.lifecycle.blacklisted")]}),a.status==="EXPIRED"&&e.jsxs("p",{className:"text-error",children:["â€¢ ",s("cards.lifecycle.expired")]}),e.jsxs("p",{children:["â€¢ ",s("cards.lastUsed"),": ",a.lastUsed]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-200 mb-4 flex items-center gap-2",children:[e.jsx(ns,{className:"w-5 h-5 text-primary-600 dark:text-primary-400"}),s("cards.history")]}),e.jsx("div",{className:"space-y-4",children:he.length===0?e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-center py-8",children:s("cards.noTransactions")}):he.map(t=>e.jsxs("div",{className:"p-4 bg-slate-50/30 dark:bg-dark-900/30 rounded-xl border border-slate-200 dark:border-dark-700 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-2 rounded-lg ${t.type==="CREDIT"?"bg-success/10 text-success":"bg-primary-500/10 text-primary-600 dark:text-primary-400"}`,children:t.type==="CREDIT"?e.jsx(ae,{className:"w-5 h-5"}):e.jsx(Xe,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-900 dark:text-slate-200",children:t.type==="CREDIT"?s("cards.topUp"):s("cards.payment")}),e.jsxs("p",{className:"text-xs text-slate-500",children:[t.terminal," â€¢ ",t.timestamp]})]})]}),e.jsxs("span",{className:`font-mono font-medium ${t.type==="CREDIT"?"text-success":"text-slate-900 dark:text-slate-200"}`,children:[t.type==="CREDIT"?"+":"-","Â¥",t.amount.toLocaleString()]})]},t.id))})]})]})})}),document.body),u&&a&&$.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[110] flex items-center justify-center p-4",onClick:t=>{t.target===t.currentTarget&&(y(!1),D(0))},children:e.jsxs(f.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"glass-panel w-full max-w-md p-6 bg-white dark:bg-dark-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-display font-bold text-slate-900 dark:text-slate-100",children:s("cards.topUpTitle")}),e.jsx("button",{onClick:()=>{y(!1),D(0)},className:"text-slate-400 hover:text-slate-500 dark:hover:text-slate-300 transition-colors",children:e.jsx(M,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-dark-900 rounded-xl",children:[e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:s("cards.cardNumber")}),e.jsx("p",{className:"font-mono font-medium text-slate-900 dark:text-slate-200",children:a.number})]}),e.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-dark-900 rounded-xl",children:[e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:s("cards.currentBalance")}),e.jsxs("p",{className:"text-xl font-bold text-slate-900 dark:text-slate-200",children:["Â¥",a.balance.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-500 dark:text-slate-400 mb-2",children:s("cards.topUpAmount")}),e.jsx("div",{className:"grid grid-cols-4 gap-2 mb-3",children:[50,100,200,500].map(t=>e.jsxs("button",{onClick:()=>D(t),className:`py-2 text-sm font-medium rounded-lg border transition-all ${v===t?"bg-primary-500/10 border-primary-500 text-primary-600":"border-slate-200 dark:border-dark-600 text-slate-600 dark:text-slate-400 hover:border-primary-500/50"}`,children:["Â¥",t]},t))}),e.jsx("input",{type:"number",min:"1",max:"1000",value:v||"",onChange:t=>D(Number(t.target.value)),placeholder:"Custom Amount (1 - 1000)",className:"w-full px-4 py-3 bg-slate-50 dark:bg-dark-900 border border-slate-200 dark:border-dark-600 rounded-lg text-slate-900 dark:text-slate-200 focus:outline-none focus:border-primary-500/50"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:s("cards.topUpHint")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-500 dark:text-slate-400 mb-2",children:s("cards.paymentMethods.ALIPAY_INSTALLMENT")}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("button",{onClick:()=>g("ALIPAY"),className:`p-3 rounded-xl border flex items-center justify-between transition-all ${r==="ALIPAY"?"border-primary-500 bg-primary-500/5 ring-1 ring-primary-500":"border-slate-200 dark:border-dark-600"}`,children:e.jsxs("span",{className:"flex items-center gap-2 text-sm font-medium",children:[e.jsx("span",{className:"text-xl",children:"ðŸŸ¡"})," ",s("cards.paymentMethods.ALIPAY")]})}),e.jsx("button",{onClick:()=>g("WECHAT"),className:`p-3 rounded-xl border flex items-center justify-between transition-all ${r==="WECHAT"?"border-primary-500 bg-primary-500/5 ring-1 ring-primary-500":"border-slate-200 dark:border-dark-600"}`,children:e.jsxs("span",{className:"flex items-center gap-2 text-sm font-medium",children:[e.jsx("span",{className:"text-xl",children:"ðŸŸ¢"})," ",s("cards.paymentMethods.WECHAT")]})}),e.jsx("button",{onClick:()=>g("DIGITAL_RMB"),className:`p-3 rounded-xl border flex items-center justify-between transition-all ${r==="DIGITAL_RMB"?"border-primary-500 bg-primary-500/5 ring-1 ring-primary-500":"border-slate-200 dark:border-dark-600"}`,children:e.jsxs("span",{className:"flex items-center gap-2 text-sm font-medium",children:[e.jsx("span",{className:"text-xl",children:"ðŸ“±"})," ",s("cards.paymentMethods.DIGITAL_RMB")]})}),e.jsx("button",{onClick:()=>g("BANK_CARD"),className:`p-3 rounded-xl border flex items-center justify-between transition-all ${r==="BANK_CARD"?"border-primary-500 bg-primary-500/5 ring-1 ring-primary-500":"border-slate-200 dark:border-dark-600"}`,children:e.jsxs("span",{className:"flex items-center gap-2 text-sm font-medium",children:[e.jsx("span",{className:"text-xl",children:"ðŸ¦"})," ",s("cards.paymentMethods.BANK_CARD")]})})]})]}),r==="DIGITAL_RMB"&&e.jsxs("div",{className:"p-4 bg-primary-500/5 border border-primary-500/20 rounded-xl flex items-start gap-3 animate-in fade-in slide-in-from-top-2",children:[e.jsx(ps,{className:"w-5 h-5 text-primary-600 mt-1"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-primary-600 uppercase tracking-tighter",children:"Digital RMB (DC/EP)"}),e.jsx("p",{className:"text-[10px] text-slate-500 mt-1 leading-relaxed",children:"Dual-offline payment enabled. You can complete this transaction without internet connection. Wallet balance will sync on next sync."})]})]}),r==="ALIPAY"&&v>=100&&e.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-dark-900 rounded-xl border border-slate-200 dark:border-dark-700 animate-in fade-in slide-in-from-top-2",children:[e.jsx("p",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-3",children:s("cards.paymentMethods.ALIPAY_INSTALLMENT")}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:["3","6","12"].map(t=>e.jsxs("button",{className:"py-2 px-1 text-xs border border-primary-500/30 text-primary-600 rounded flex flex-col items-center hover:bg-primary-50",children:[e.jsx("span",{className:"font-bold",children:s(`cards.installments.${t}months`)}),e.jsxs("span",{className:"scale-75 text-[10px] text-slate-500",children:["Â¥",(v/Number(t)).toFixed(1),"/m"]})]},t))})]}),E&&e.jsx("div",{className:"p-3 bg-error/10 border border-error/20 rounded-lg text-error text-sm",children:E}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{y(!1),D(0),N(null)},className:"flex-1 btn-secondary",children:s("common.cancel")}),e.jsxs("button",{onClick:_e,disabled:!v||v<=0||X.isPending,className:"flex-1 btn-primary flex items-center justify-center gap-2 disabled:opacity-50",children:[X.isPending&&e.jsx(L,{className:"w-4 h-4 animate-spin"}),s("common.confirm")]})]})]})]})}),document.body),W&&$.createPortal(e.jsx("div",{className:"fixed top-24 right-4 z-[200] max-w-sm w-full animate-in slide-in-from-right duration-500",children:e.jsxs("div",{className:"glass-panel p-4 bg-success/10 border-success/20 overflow-hidden relative",children:[e.jsx("div",{className:"absolute top-0 right-0 p-2 text-success opacity-20",children:e.jsx(P,{className:"w-12 h-12"})}),e.jsxs("h4",{className:"text-lg font-bold text-success flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-2xl",children:"ðŸŽ‰"}),s("cards.rewards.title")]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-success-800 dark:text-success-200",children:[e.jsx("span",{className:"text-lg",children:"ðŸŒ¿"}),s("cards.rewards.antForest")]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-success-800 dark:text-success-200",children:[e.jsx("span",{className:"text-lg",children:"ðŸ§§"}),s("cards.rewards.wechatCoupon")]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-success-800 dark:text-success-200 font-bold",children:[e.jsx(Z,{className:"w-3 h-3"})," 20 ",s("cards.rewards.pointsEarned")]})]}),e.jsx("div",{className:"mt-3 bg-success/20 h-1.5 rounded-full overflow-hidden",children:e.jsx(f.div,{initial:{width:0},animate:{width:"100%"},transition:{duration:5},className:"bg-success h-full"})})]})}),document.body),Te&&$.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[200] flex items-center justify-center p-4",children:e.jsx(f.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"glass-panel w-full max-w-2xl min-h-[500px] p-8 bg-white dark:bg-dark-800",children:e.jsx(fs,{onClose:()=>G(!1),onSuccess:()=>{Ie(!0),G(!1)}})})}),document.body),e.jsx(qe,{...Pe})]})}export{Os as default};
//# sourceMappingURL=Cards-BJPj9H5e.js.map
